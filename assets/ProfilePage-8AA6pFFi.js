import{c as K,a as C,h as A,s as x,i as O,j as e,b as ts,k as as,r as y,B as _,g as B,u as rs,l as ns,d as is,n as ls,L as os,m as b,X as cs,P as ds,f as M}from"./index-Dd2rIlyv.js";import{C as ms}from"./ChordBadge-xItg397v.js";import{S as De,Q as us}from"./QuickStreamButtons-_5fX0HMn.js";import{P as qe}from"./PageLayout-BNXjs83-.js";import{E as xs,f as w}from"./animations-_zqxABPi.js";import{a as hs,b as ps,c as fs,d as gs,u as ys,e as js,f as vs,R as Ns,g as me}from"./useSpotifyUser-DdnNOCC7.js";import{I as he}from"./input-BiA0strX.js";import{n as bs}from"./navigation-PB9wrqL7.js";import{u as Q}from"./useMutation-7uUZ3mB-.js";import{u as ws,a as _s}from"./useSpotifyConnect-CcfeGt7T.js";import{u as ks}from"./useTasteDNA-BIIPPcui.js";import{P as I}from"./providers-CHelMshW.js";import{D as Ue,a as Be,b as Ke,c as Oe,d as Cs,e as Ss}from"./dialog-hYGwYMcb.js";import{T as Qe,a as He,b as E,c as L}from"./tabs-C8trX2jw.js";import{A as Ps,a as Fs,b as Ls}from"./avatar-BbrJaQTE.js";import{L as $}from"./label-BPWjfQts.js";import{S as se,a as te,b as ae,c as re,d as ne}from"./select-CDm00dpH.js";import{T as As}from"./textarea-BMBhHIDR.js";import{S as Ds}from"./switch-DAVGoKZW.js";import{S as qs}from"./scroll-area-CwTvKmdI.js";import{U as ue}from"./BottomNav-3dyL0Vl5.js";import{S as Te}from"./shield-ChH5Tqwr.js";import{Z as Ts}from"./zap-Dyhy7yS-.js";import{C as Ms}from"./chart-column-DxgKwO4G.js";import{S as Me}from"./sparkles-DbqwZ06P.js";import{M as W}from"./music-rEZJDJ1O.js";import{L as Is}from"./link-pDC8njkc.js";import{C as xe}from"./check-0Uvfv6EW.js";import{C as Ie}from"./chevron-right-xv08C_02.js";import{R as Ee}from"./radio-XBzqt8kf.js";import{T as Es}from"./trending-up-DbXw-0qM.js";import{D as zs}from"./disc-3-DassnGqa.js";import{C as Rs}from"./clock-B9SuAwWE.js";import{H as $s}from"./heart-gI87XFQe.js";import{B as Us}from"./bookmark-p5gwUBa3.js";import{f as ze}from"./formatDistanceToNow-3UBXKcFR.js";import"./CladeIcon-C1_7t6h2.js";import"./index-D7mrrV0m.js";import"./index-DIJ6oIYa.js";import"./index-BLHP4b0R.js";import"./index-BdQq_4o_.js";import"./Combination-BeiCrvDQ.js";import"./index-BXMWfozj.js";import"./search-CInHvpnX.js";import"./en-US-wfBU2YNu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=K("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=K("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=K("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=K("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=K("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=K("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);function Vs(t={}){const{user:a}=C(),{limit:r=20}=t;return A({queryKey:["play-history",a==null?void 0:a.id,r],queryFn:async()=>{if(!a)return[];const{data:n,error:l}=await x.from("user_interactions").select(`
          id,
          user_id,
          track_id,
          interaction_type,
          created_at
        `).eq("user_id",a.id).like("interaction_type","play_%").order("created_at",{ascending:!1}).limit(r);return l?(console.warn("Failed to fetch play history:",l),[]):(n||[]).map(o=>({id:o.id,user_id:o.user_id,track_id:o.track_id,provider:"spotify",action:o.interaction_type.replace("play_",""),played_at:o.created_at}))},enabled:!!a})}function Ws(){const{user:t}=C();return A({queryKey:["play-stats",t==null?void 0:t.id],queryFn:async()=>{if(!t)return null;const{count:a}=await x.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t.id).like("interaction_type","play_%");return{totalPlays:a||0,providerCounts:{},recentPlays:0}},enabled:!!t})}function Ys(){const{user:t}=C();return A({queryKey:["profile",t==null?void 0:t.id],queryFn:async()=>{if(!t)return null;const{data:a,error:r}=await x.from("profiles").select("*").eq("id",t.id).single();if(r)throw r;return a},enabled:!!t})}function Gs(){const{user:t}=C();return A({queryKey:["user-providers",t==null?void 0:t.id],queryFn:async()=>{if(!t)return[];const{data:a,error:r}=await x.from("user_providers").select("*").eq("user_id",t.id).order("connected_at",{ascending:!1});if(r)throw r;return a},enabled:!!t})}function Zs(){const{user:t}=C(),a=O();return Q({mutationFn:async r=>{if(!t)throw new Error("Not authenticated");const{data:n,error:l}=await x.from("profiles").update({preferred_provider:r}).eq("id",t.id).select().single();if(l)throw l;return n},onSuccess:()=>{a.invalidateQueries({queryKey:["profile"]})}})}function Xs(t){return A({queryKey:["user-interaction-stats",t],queryFn:async()=>{if(!t)return{likes:0,saves:0,shares:0};const[a,r,n]=await Promise.all([x.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("interaction_type","like"),x.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("interaction_type","save"),x.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("interaction_type","share")]);return{likes:a.count||0,saves:r.count||0,shares:n.count||0}},enabled:!!t})}const Js="https://ws.audioscrobbler.com/2.0";function et(){return"your_lastfm_api_key"}async function Y(t,a){try{const r=et(),n=new URLSearchParams({method:t,api_key:r,format:"json",...a}),l=await fetch(`${Js}?${n}`);if(!l.ok)return console.error(`Last.fm API error: ${l.status}`),null;const o=await l.json();return o.error?(console.error(`Last.fm error ${o.error}: ${o.message}`),null):o}catch(r){return console.error("Last.fm request failed:",r),null}}async function Ve(t){const a=await Y("user.getInfo",{user:t});return(a==null?void 0:a.user)??null}async function st(t,a="3month",r=10){var l;const n=await Y("user.getTopArtists",{user:t,period:a,limit:r.toString()});return((l=n==null?void 0:n.topartists)==null?void 0:l.artist)??[]}async function tt(t,a="3month",r=10){var l;const n=await Y("user.getTopTracks",{user:t,period:a,limit:r.toString()});return((l=n==null?void 0:n.toptracks)==null?void 0:l.track)??[]}async function at(t,a=20){var n;const r=await Y("user.getRecentTracks",{user:t,limit:a.toString()});return((n=r==null?void 0:r.recenttracks)==null?void 0:n.track)??[]}async function rt(t){var r,n;const a=await Y("user.getWeeklyArtistChart",{user:t});return((n=(r=a==null?void 0:a.weeklyartistchart)==null?void 0:r.artist)==null?void 0:n.length)??0}async function nt(t){if(!t)return null;try{const[a,r,n,l,o]=await Promise.all([Ve(t),st(t,"3month",10),tt(t,"3month",10),at(t,10),rt(t)]);if(!a)return null;const h=c=>{var D;if(!c||c.length===0)return;const N=["extralarge","large","medium","small"];for(const z of N){const k=c.find(S=>S.size===z);if(k!=null&&k["#text"])return k["#text"]}return((D=c[0])==null?void 0:D["#text"])||void 0};return{totalScrobbles:parseInt(a.playcount,10)||0,artistCount:parseInt(a.artist_count,10)||0,trackCount:parseInt(a.track_count,10)||0,registeredDate:new Date(parseInt(a.registered.unixtime,10)*1e3),topArtists:r.map(c=>({name:c.name,playcount:parseInt(c.playcount,10)||0,imageUrl:h(c.image)})),topTracks:n.map(c=>({name:c.name,artist:c.artist.name,playcount:parseInt(c.playcount||"0",10)})),recentTracks:l.map(c=>{var N;return{name:c.name,artist:c.artist.name,album:(N=c.album)==null?void 0:N["#text"],playedAt:c.date?new Date(parseInt(c.date.uts,10)*1e3):void 0,imageUrl:h(c.image),nowPlaying:!c.date}}),weeklyArtistCount:o}}catch(a){return console.error("Error fetching Last.fm stats:",a),null}}async function it(t,a){if(!await Ve(a))throw new Error("Last.fm username not found. Please check the username and try again.");const{error:n}=await x.from("user_providers").upsert({user_id:t,provider:"lastfm",provider_user_id:a,access_token:"public",refresh_token:"public",expires_at:new Date(Date.now()+365*24*60*60*1e3).toISOString(),connected_at:new Date().toISOString()},{onConflict:"user_id,provider"});if(n)throw console.error("Failed to store Last.fm connection:",n),new Error("Failed to save Last.fm connection")}async function lt(t){const{data:a,error:r}=await x.from("user_providers").select("provider_user_id").eq("user_id",t).eq("provider","lastfm").single();return r||!a?null:a.provider_user_id}async function ot(t){const{error:a}=await x.from("user_providers").delete().eq("user_id",t).eq("provider","lastfm");if(a)throw new Error("Failed to disconnect Last.fm")}function We(){const{user:t}=C();return A({queryKey:["lastfm-username",t==null?void 0:t.id],queryFn:()=>lt(t.id),enabled:!!t,staleTime:5*60*1e3})}function ct(){const{user:t}=C(),{data:a}=We();return A({queryKey:["lastfm-stats",a],queryFn:()=>a?nt(a):null,enabled:!!t&&!!a,staleTime:5*60*1e3,refetchOnWindowFocus:!0})}function dt(){const{user:t}=C(),a=O();return Q({mutationFn:async r=>{if(!t)throw new Error("Must be logged in");return await it(t.id,r),r},onSuccess:r=>{a.setQueryData(["lastfm-username",t==null?void 0:t.id],r),a.invalidateQueries({queryKey:["lastfm-stats"]}),a.invalidateQueries({queryKey:["user-providers"]})}})}function mt(){const{user:t}=C(),a=O();return Q({mutationFn:async()=>{if(!t)throw new Error("Must be logged in");await ot(t.id)},onSuccess:()=>{a.setQueryData(["lastfm-username",t==null?void 0:t.id],null),a.setQueryData(["lastfm-stats",null],null),a.invalidateQueries({queryKey:["user-providers"]})}})}function Re(t){const a=new Date,r=typeof t=="string"?new Date(t):t,n=a.getTime()-r.getTime(),l=Math.floor(n/6e4),o=Math.floor(n/36e5),h=Math.floor(n/864e5);return l<1?"just now":l<60?`${l}m ago`:o<24?`${o}h ago`:h<7?`${h}d ago`:r.toLocaleDateString()}function ut({provider:t,className:a,showIcon:r=!0,showName:n=!0,size:l="md"}){const o=I[t],h={sm:"px-1.5 py-0.5 text-[10px] gap-0.5",md:"px-2 py-0.5 text-xs gap-1",lg:"px-3 py-1 text-sm gap-1.5"};return e.jsxs("span",{className:ts("inline-flex items-center rounded font-medium",h[l],a),style:{backgroundColor:`${o.color}20`,color:o.color},children:[r&&e.jsx("span",{className:l==="sm"?"text-[8px]":l==="md"?"text-[10px]":"text-xs",children:o.icon}),n&&e.jsx("span",{children:o.name})]})}function xt(t){return A({queryKey:["userTheme",t],queryFn:async()=>{var l;const a=t||((l=(await x.auth.getUser()).data.user)==null?void 0:l.id);if(!a)throw new Error("No user ID provided");const{data:r,error:n}=await x.from("user_themes").select("*").eq("user_id",a).maybeSingle();if(n)throw n;return r},staleTime:5*60*1e3,enabled:!!t||!0})}function ht(){return A({queryKey:["themePresets"],queryFn:async()=>{const{data:t,error:a}=await x.from("theme_presets").select("*").order("is_featured",{ascending:!1}).order("usage_count",{ascending:!1});if(a)throw a;return t},staleTime:10*60*1e3})}function pt(){const t=O();return Q({mutationFn:async a=>{const{data:r,error:n}=await x.from("user_themes").insert(a).select().single();if(n)throw n;return r},onSuccess:a=>{t.invalidateQueries({queryKey:["userTheme",a.user_id]})}})}function ft(){const t=O();return Q({mutationFn:async({userId:a,updates:r})=>{const{data:n,error:l}=await x.from("user_themes").update(r).eq("user_id",a).select().single();if(l)throw l;return n},onSuccess:a=>{t.invalidateQueries({queryKey:["userTheme",a.user_id]})}})}function gt(){const t=O();return Q({mutationFn:async({userId:a,presetId:r})=>{const{data:n,error:l}=await x.from("theme_presets").select("*").eq("id",r).single();if(l)throw l;await x.rpc("increment_theme_usage",{preset_id:r});const{data:o}=await x.from("user_themes").select("id").eq("user_id",a).maybeSingle();if(o){const{data:h,error:c}=await x.from("user_themes").update({theme_name:n.name,colors:n.colors,fonts:n.fonts,layout:n.layout,custom_css:n.custom_css,player_skin:n.player_skin,animated_background:n.animated_background}).eq("user_id",a).select().single();if(c)throw c;return h}else{const{data:h,error:c}=await x.from("user_themes").insert({user_id:a,theme_name:n.name,colors:n.colors,fonts:n.fonts,layout:n.layout,custom_css:n.custom_css,player_skin:n.player_skin,animated_background:n.animated_background}).select().single();if(c)throw c;return h}},onSuccess:a=>{t.invalidateQueries({queryKey:["userTheme",a.user_id]}),t.invalidateQueries({queryKey:["themePresets"]})}})}const yt={background:"#000000",surface:"#1a1a1a",primary:"#3b82f6",secondary:"#8b5cf6",accent:"#f59e0b",text:"#ffffff",textMuted:"#9ca3af"},jt={heading:"Inter",body:"Inter"},$e=["Inter","Roboto","Open Sans","Lato","Montserrat","Poppins","Playfair Display","Lora","Merriweather","Roboto Mono","Fira Code","Source Code Pro","Orbitron","Press Start 2P","Audiowide"],vt=[{value:"modern",label:"Modern"},{value:"minimal",label:"Minimal"},{value:"retro",label:"Retro"},{value:"neon",label:"Neon"},{value:"academic",label:"Academic"}],Nt=[{value:"default",label:"Default"},{value:"compact",label:"Compact"},{value:"glassmorphism",label:"Glassmorphism"},{value:"retro",label:"Retro"},{value:"minimal",label:"Minimal"}];function bt({open:t,onOpenChange:a,currentTheme:r,userId:n}){const{toast:l}=as(),[o,h]=y.useState((r==null?void 0:r.colors)||yt),[c,N]=y.useState((r==null?void 0:r.fonts)||jt),[D,z]=y.useState((r==null?void 0:r.layout)||"modern"),[k,S]=y.useState((r==null?void 0:r.custom_css)||""),[G,H]=y.useState((r==null?void 0:r.player_skin)||"default"),[V,m]=y.useState((r==null?void 0:r.animated_background)||!1),{data:P}=ht(),R=ft(),U=pt(),q=gt();y.useEffect(()=>{r&&(h(r.colors),N(r.fonts),z(r.layout),S(r.custom_css||""),H(r.player_skin),m(r.animated_background))},[r]);const Z=async()=>{try{const i={colors:o,fonts:c,layout:D,custom_css:k||null,player_skin:G,animated_background:V};r?await R.mutateAsync({userId:n,updates:i}):await U.mutateAsync({user_id:n,...i}),l({title:"Theme saved",description:"Your profile theme has been updated successfully."}),a(!1)}catch(i){l({title:"Error saving theme",description:i instanceof Error?i.message:"Failed to save theme",variant:"destructive"})}},ie=async i=>{try{const u=await q.mutateAsync({userId:n,presetId:i});h(u.colors),N(u.fonts),z(u.layout),S(u.custom_css||""),H(u.player_skin||"default"),m(u.animated_background),l({title:"Preset applied",description:"Theme preset has been applied to the editor."})}catch(u){l({title:"Error applying preset",description:u instanceof Error?u.message:"Failed to apply preset",variant:"destructive"})}},X=(i,u)=>{h(f=>({...f,[i]:u}))},p=(i,u)=>{N(f=>({...f,[i]:u}))};return e.jsx(Ue,{open:t,onOpenChange:a,children:e.jsxs(Be,{className:"max-w-5xl h-[90vh]",children:[e.jsx(Ke,{children:e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Theme Editor"]})}),e.jsxs("div",{className:"flex gap-4 flex-1 overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs(Qe,{defaultValue:"presets",className:"w-full",children:[e.jsxs(He,{className:"grid w-full grid-cols-5",children:[e.jsxs(E,{value:"presets",className:"flex items-center gap-1",children:[e.jsx(Hs,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Presets"})]}),e.jsxs(E,{value:"colors",className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Colors"})]}),e.jsxs(E,{value:"fonts",className:"flex items-center gap-1",children:[e.jsx(Qs,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Fonts"})]}),e.jsxs(E,{value:"layout",className:"flex items-center gap-1",children:[e.jsx(Os,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Layout"})]}),e.jsxs(E,{value:"advanced",className:"flex items-center gap-1",children:[e.jsx(Bs,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Advanced"})]})]}),e.jsxs(qs,{className:"h-[calc(90vh-180px)] mt-4",children:[e.jsxs(L,{value:"presets",className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start with a pre-made theme and customize it to your liking."}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:P==null?void 0:P.map(i=>e.jsxs("button",{onClick:()=>ie(i.id),className:"flex items-start gap-3 p-4 rounded-lg border hover:bg-accent transition-colors text-left",children:[e.jsx("div",{className:"w-12 h-12 rounded border shrink-0",style:{background:`linear-gradient(135deg, ${i.colors.primary}, ${i.colors.secondary})`}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium",children:i.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:i.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[i.is_featured&&e.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded",children:"Featured"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.usage_count," uses"]})]})]})]},i.id))})]}),e.jsx(L,{value:"colors",className:"space-y-4",children:Object.entries(o).map(([i,u])=>e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:i,className:"capitalize",children:i.replace(/([A-Z])/g," $1").trim()}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(he,{id:i,type:"color",value:u,onChange:f=>X(i,f.target.value),className:"w-20 h-10 p-1 cursor-pointer"}),e.jsx(he,{type:"text",value:u,onChange:f=>X(i,f.target.value),className:"flex-1",placeholder:"#000000"})]})]},i))}),e.jsxs(L,{value:"fonts",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"heading-font",children:"Heading Font"}),e.jsxs(se,{value:c.heading,onValueChange:i=>p("heading",i),children:[e.jsx(te,{id:"heading-font",children:e.jsx(ae,{})}),e.jsx(re,{children:$e.map(i=>e.jsx(ne,{value:i,style:{fontFamily:i},children:i},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"body-font",children:"Body Font"}),e.jsxs(se,{value:c.body,onValueChange:i=>p("body",i),children:[e.jsx(te,{id:"body-font",children:e.jsx(ae,{})}),e.jsx(re,{children:$e.map(i=>e.jsx(ne,{value:i,style:{fontFamily:i},children:i},i))})]})]})]}),e.jsxs(L,{value:"layout",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"layout-select",children:"Layout Style"}),e.jsxs(se,{value:D,onValueChange:z,children:[e.jsx(te,{id:"layout-select",children:e.jsx(ae,{})}),e.jsx(re,{children:vt.map(i=>e.jsx(ne,{value:i.value,children:i.label},i.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"player-skin",children:"Player Skin"}),e.jsxs(se,{value:G,onValueChange:H,children:[e.jsx(te,{id:"player-skin",children:e.jsx(ae,{})}),e.jsx(re,{children:Nt.map(i=>e.jsx(ne,{value:i.value,children:i.label},i.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx($,{htmlFor:"animated-bg",children:"Animated Background"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable subtle background animation"})]}),e.jsx(Ds,{id:"animated-bg",checked:V,onCheckedChange:m})]})]}),e.jsx(L,{value:"advanced",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"custom-css",children:"Custom CSS"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Advanced: Add custom CSS to further customize your profile"}),e.jsx(As,{id:"custom-css",value:k,onChange:i=>S(i.target.value),placeholder:".profile-header { ... }",className:"font-mono text-sm min-h-[200px]"})]})})]})]})}),e.jsxs("div",{className:"w-80 rounded-lg border p-4 overflow-hidden",style:{backgroundColor:o.background,color:o.text,fontFamily:c.body},children:[e.jsx("h3",{className:"text-sm font-medium mb-3",style:{fontFamily:c.heading},children:"Live Preview"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 rounded",style:{backgroundColor:o.surface},children:[e.jsx("h4",{className:"font-semibold mb-1",style:{fontFamily:c.heading,color:o.primary},children:"Heading Text"}),e.jsx("p",{className:"text-sm",style:{color:o.textMuted},children:"This is how your body text will appear on your profile."})]}),e.jsx("button",{className:"w-full py-2 px-4 rounded font-medium",style:{backgroundColor:o.primary,color:o.background},children:"Primary Button"}),e.jsx("button",{className:"w-full py-2 px-4 rounded font-medium",style:{backgroundColor:o.secondary,color:o.background},children:"Secondary Button"}),e.jsx("div",{className:"p-2 rounded text-sm",style:{backgroundColor:o.accent,color:o.background},children:"Accent Color"})]})]})]}),e.jsxs(Cs,{children:[e.jsx(_,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(_,{onClick:Z,disabled:R.isPending||U.isPending,children:[(R.isPending||U.isPending)&&e.jsx(B,{className:"w-4 h-4 mr-2 animate-spin"}),"Save Theme"]})]})]})})}const wt={energetic:"from-orange-500 to-red-500",chill:"from-blue-400 to-cyan-400",melancholic:"from-purple-500 to-indigo-600",upbeat:"from-yellow-400 to-orange-400",balanced:"from-green-400 to-emerald-500"},_t={energetic:"âš¡",chill:"ðŸŒŠ",melancholic:"ðŸŒ™",upbeat:"â˜€ï¸",balanced:"ðŸŽ¯"};function fa(){var Ce,Se,Pe,Fe,Le;const{user:t,signOut:a,loading:r}=C(),n=rs(),[l,o]=y.useState("all"),[h,c]=y.useState(!1),[N,D]=y.useState(""),[z,k]=y.useState(!1),[S,G]=y.useState("medium_term"),[H,V]=y.useState(!1),{data:m}=Ys(),{data:P=[],refetch:R}=Gs(),{data:U}=Ws(),{data:q}=Xs(t==null?void 0:t.id),{data:Z=[]}=Vs({limit:20,provider:l==="all"?void 0:l}),ie=Zs(),{data:X}=hs(),{data:p}=ps(),{data:i=[]}=fs(S,10),{data:u=[]}=gs(S,10),{data:f}=ys(20),{data:v}=js(),{data:fe=[]}=vs([],[],10),ge=ws(),ye=_s(),{data:je}=We(),{data:F}=ct(),J=dt(),le=mt(),{data:g,isLoading:oe}=ks(),{data:Ye}=xt(t==null?void 0:t.id),{data:ve}=ns(),{openPlayer:Ne}=is(),ce=X===!0,be=i.length>0?"tracks":u.length>0?"artists":"recent",ee=!!je,Ge=(q==null?void 0:q.likes)??0,Ze=(q==null?void 0:q.saves)??0,Xe=async()=>{await a(),n("/")},Je=async()=>{try{await ge.mutateAsync()}catch(s){M.error(s.message||"Failed to connect Spotify")}},es=async()=>{try{await ye.mutateAsync(),M.success("Spotify disconnected"),R()}catch{M.error("Failed to disconnect Spotify")}},we=async()=>{if(!N.trim()){M.error("Please enter your Last.fm username");return}try{await J.mutateAsync(N.trim()),M.success("Last.fm connected successfully!"),k(!1),D(""),R()}catch(s){M.error(s.message||"Failed to connect Last.fm")}},ss=async()=>{try{await le.mutateAsync(),M.success("Last.fm disconnected"),R()}catch{M.error("Failed to disconnect Last.fm")}},_e=async s=>{try{await ie.mutateAsync(s),c(!1)}catch(d){console.error("Failed to set preferred provider:",d)}},ke=y.useCallback(s=>s.spotifyId||s.spotify_id?"spotify":s.youtubeId||s.youtube_id?"youtube":ls()??null,[]),de=y.useCallback(s=>{const d=ke(s);if(!d)return;const j=d==="spotify"?s.spotifyId||s.spotify_id:s.youtubeId||s.youtube_id;j&&Ne({canonicalTrackId:s.id||s.track_id||null,provider:d,providerTrackId:j,title:s.title,artist:s.artist,album:s.album,autoplay:!0,context:"profile-recent"})},[Ne,ke]);return r?e.jsx(os,{fullScreen:!0}):t?e.jsxs(qe,{title:"Profile",headerActions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>V(!0),children:[e.jsx(pe,{className:"w-4 h-4"}),"Theme"]}),ve&&e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>n("/admin"),children:[e.jsx(Te,{className:"w-4 h-4"}),"Admin"]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:Xe,children:e.jsx(Ks,{className:"w-5 h-5"})})]}),children:[e.jsxs(Ns,{maxWidth:"full",className:"space-y-6",children:[e.jsxs(b.div,{variants:w,initial:"initial",animate:"animate",className:"flex items-center gap-4 p-4 glass rounded-2xl",children:[e.jsxs(Ps,{className:"w-16 h-16",children:[e.jsx(Fs,{src:(p==null?void 0:p.imageUrl)||(m==null?void 0:m.avatar_url)||void 0}),e.jsx(Ls,{className:"bg-gradient-to-br from-primary to-accent text-white text-xl",children:((Ce=p==null?void 0:p.displayName)==null?void 0:Ce[0])||((Se=t.email)==null?void 0:Se[0].toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"font-bold truncate",children:(p==null?void 0:p.displayName)||((Pe=t.email)==null?void 0:Pe.split("@")[0])}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:t.email}),p&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${p.product==="premium"?"bg-[#1DB954]/20 text-[#1DB954]":"bg-muted text-muted-foreground"}`,children:p.product==="premium"?"ðŸ‘‘ Premium":"Free"}),p.followers&&p.followers>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[p.followers," followers"]})]})]})]}),e.jsxs(b.div,{variants:w,initial:"initial",animate:"animate",transition:{delay:.05},className:"p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ts,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"font-medium",children:"Credits"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Free tier"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full w-1/4 bg-gradient-to-r from-primary to-accent rounded-full"})}),e.jsx("span",{className:"text-sm font-medium",children:"25/100"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Credits reset monthly. Used for track analysis."})]}),ce&&v&&e.jsxs(b.div,{variants:w,initial:"initial",animate:"animate",transition:{delay:.1},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ms,{className:"w-5 h-5"}),e.jsx("h3",{className:"font-bold",children:"Your Music DNA"})]}),e.jsxs("div",{className:`p-6 rounded-2xl bg-gradient-to-br ${wt[v.moodProfile]} text-white`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-4xl",children:_t[v.moodProfile]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold capitalize",children:v.moodProfile}),e.jsx("p",{className:"text-white/80 text-sm",children:"Your listening mood profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Energy"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${v.averageEnergy*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(v.averageEnergy*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Danceability"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${v.averageDanceability*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(v.averageDanceability*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Happiness"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${v.averageValence*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(v.averageValence*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Avg Tempo"}),e.jsxs("p",{className:"text-lg font-bold",children:[Math.round(v.averageTempo)," BPM"]})]})]})]}),v.topGenres.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Top Genres"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:v.topGenres.slice(0,8).map((s,d)=>e.jsx("span",{className:"px-3 py-1 rounded-full bg-primary/10 text-primary text-sm",style:{opacity:1-d*.08},children:s.genre},s.genre))})]})]}),e.jsxs(b.div,{variants:w,initial:"initial",animate:"animate",transition:{delay:.12},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-accent"}),e.jsx("h3",{className:"font-bold",children:"Chord Taste DNA"}),(g==null?void 0:g.totalTracksAnalyzed)&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",g.totalTracksAnalyzed," tracks analyzed)"]})]}),oe&&e.jsxs("div",{className:"p-8 glass rounded-2xl text-center",children:[e.jsx(B,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Analyzing your musical taste..."})]}),!oe&&!g&&e.jsxs("div",{className:"p-8 glass rounded-2xl text-center",children:[e.jsx(W,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start listening to tracks to build your taste profile"})]}),!oe&&g&&e.jsxs(e.Fragment,{children:[g.favoriteProgressions.length>0?e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Favorite Progressions"}),g.favoriteProgressions.map((s,d)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-1",children:s.progression.map((j,T)=>e.jsx(ms,{chord:j,size:"sm"},T))}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.count," ",s.count===1?"song":"songs"]})]},d))]}):e.jsx("div",{className:"p-4 glass rounded-2xl text-center text-sm text-muted-foreground",children:"No chord progressions detected yet"}),g.preferredModes.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Mode Preference"}),e.jsx("div",{className:"flex gap-2",children:g.preferredModes.map(s=>e.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-muted/50 text-center",children:[e.jsxs("span",{className:"text-lg font-bold",children:[s.percentage,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s.mode}),e.jsxs("p",{className:"text-xs text-muted-foreground/60",children:[s.count," tracks"]})]},s.mode))})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Energy Preference"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Low"}),e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-accent rounded-full transition-all",style:{width:`${g.energyPreference*100}%`}})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"High"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:[Math.round(g.energyPreference*100),"% energy â€¢ ",g.averageTempo," BPM avg"]})]}),g.cadencePreference&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Cadence Style"}),e.jsx("span",{className:"inline-block px-3 py-1 rounded-full bg-primary/10 text-primary text-sm capitalize",children:g.cadencePreference})]})]})]}),e.jsxs(b.div,{variants:w,initial:"initial",animate:"animate",transition:{delay:.15},className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Is,{className:"w-5 h-5"}),"Connected Services"]}),(()=>{const s=P.find(T=>T.provider==="spotify"),d=ge.isPending,j=ye.isPending;return e.jsxs("div",{className:"w-full p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#1DB954]/20 flex items-center justify-center",children:e.jsx(De,{className:"w-5 h-5 text-[#1DB954]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"Spotify"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s?`Connected ${ze(new Date(s.connected_at))} ago`:"Sync your listening history"})]})]}),s?e.jsx(_,{variant:"outline",size:"sm",onClick:es,disabled:j,className:"text-destructive hover:text-destructive",children:j?e.jsx(B,{className:"w-4 h-4 animate-spin"}):"Disconnect"}):e.jsx(_,{size:"sm",onClick:Je,disabled:d,className:"bg-[#1DB954] hover:bg-[#1ed760] text-white gap-2",children:d?e.jsx(B,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"w-4 h-4"}),"Connect"]})})]}),s&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[#1DB954]",children:[e.jsx(xe,{className:"w-3 h-3"}),e.jsx("span",{children:"Syncing your recently played tracks"})]})]})})(),e.jsx("button",{className:"w-full p-4 glass rounded-2xl flex items-center justify-between hover:bg-muted/30 transition-colors",onClick:()=>{},children:(()=>{const s=P.find(d=>d.provider==="youtube");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#FF0000]/20 flex items-center justify-center",children:e.jsx(W,{className:"w-5 h-5 text-[#FF0000]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"YouTube Music"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s?`Connected ${ze(new Date(s.connected_at))} ago`:"Coming soon"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsx(xe,{className:"w-4 h-4 text-[#FF0000]"}),e.jsx(Ie,{className:"w-5 h-5 text-muted-foreground"})]})]})})()}),e.jsxs("div",{className:"w-full p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#D51007]/20 flex items-center justify-center",children:e.jsx(Ee,{className:"w-5 h-5 text-[#D51007]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"Last.fm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:ee?e.jsxs(e.Fragment,{children:["@",je," â€¢ ",F==null?void 0:F.totalScrobbles.toLocaleString()," scrobbles"]}):"Connect to see your listening history"})]})]}),ee?e.jsx(_,{variant:"outline",size:"sm",onClick:ss,disabled:le.isPending,className:"text-destructive hover:text-destructive",children:le.isPending?e.jsx(B,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-4 h-4 mr-1"}),"Disconnect"]})}):e.jsxs(Ue,{open:z,onOpenChange:k,children:[e.jsx(Ss,{asChild:!0,children:e.jsx(_,{size:"sm",className:"bg-[#D51007] hover:bg-[#D51007]/90",children:"Connect"})}),e.jsxs(Be,{children:[e.jsx(Ke,{children:e.jsx(Oe,{children:"Connect Last.fm"})}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your Last.fm username to sync your listening history and scrobbles."}),e.jsx(he,{placeholder:"Your Last.fm username",value:N,onChange:s=>D(s.target.value),onKeyDown:s=>s.key==="Enter"&&we()}),e.jsxs(_,{onClick:we,disabled:J.isPending,className:"w-full bg-[#D51007] hover:bg-[#D51007]/90",children:[J.isPending?e.jsx(B,{className:"w-4 h-4 animate-spin mr-2"}):null,J.isPending?"Connecting...":"Connect Last.fm"]})]})]})]})]}),ee&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[#D51007]",children:[e.jsx(xe,{className:"w-3 h-3"}),e.jsx("span",{children:"Syncing your scrobble history"})]})]}),P.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Preferred Provider"}),e.jsx("button",{onClick:()=>c(!h),className:"text-xs text-primary hover:underline",children:"Change"})]}),h?e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>_e("none"),className:`w-full p-2 rounded-lg text-left text-sm transition-colors ${!(m!=null&&m.preferred_provider)||m.preferred_provider==="none"?"bg-primary/20 text-primary":"hover:bg-muted/30"}`,children:"No preference"}),P.map(s=>e.jsxs("button",{onClick:()=>_e(s.provider),className:`w-full p-2 rounded-lg flex items-center gap-2 text-sm transition-colors ${(m==null?void 0:m.preferred_provider)===s.provider?"bg-primary/20 text-primary":"hover:bg-muted/30"}`,children:[e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center text-xs",style:{backgroundColor:`${I[s.provider].color}20`},children:e.jsx("span",{children:I[s.provider].icon})}),I[s.provider].name]},s.id))]}):e.jsx("div",{className:"flex items-center gap-2",children:m!=null&&m.preferred_provider&&m.preferred_provider!=="none"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:`${I[m.preferred_provider].color}20`},children:e.jsx("span",{children:I[m.preferred_provider].icon})}),e.jsx("span",{className:"text-sm font-medium",children:I[m.preferred_provider].name})]}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"No preference set"})})]})]}),ce&&e.jsxs(b.div,{variants:w,initial:"initial",animate:"animate",transition:{delay:.17},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Es,{className:"w-5 h-5"}),"Your Music"]}),e.jsxs("select",{value:S,onChange:s=>G(s.target.value),className:"text-xs bg-muted/50 border-none rounded-lg px-2 py-1",children:[e.jsx("option",{value:"short_term",children:"Last 4 weeks"}),e.jsx("option",{value:"medium_term",children:"Last 6 months"}),e.jsx("option",{value:"long_term",children:"All time"})]})]}),e.jsxs(Qe,{defaultValue:be,value:be,className:"w-full",children:[e.jsxs(He,{className:"grid w-full grid-cols-3",children:[e.jsx(E,{value:"tracks",disabled:!i.length,children:"Top Tracks"}),e.jsx(E,{value:"artists",disabled:!u.length,children:"Top Artists"}),e.jsx(E,{value:"recent",disabled:!((Fe=f==null?void 0:f.tracks)!=null&&Fe.length),children:"Recent"})]}),i.length>0&&e.jsx(L,{value:"tracks",className:"mt-4",children:e.jsx(me,{cols:{sm:1,md:2,lg:3},gap:"sm",children:i.map((s,d)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",onClick:()=>de(s),children:[e.jsx("span",{className:"w-6 text-center text-muted-foreground text-sm",children:d+1}),e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden bg-muted",children:s.cover_url?e.jsx("img",{src:s.cover_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(W,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist})]})]},s.id))})}),u.length>0&&e.jsx(L,{value:"artists",className:"mt-4",children:e.jsx(me,{cols:{sm:1,md:2,lg:3},gap:"sm",children:u.map((s,d)=>{var j,T,Ae;return e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",children:[e.jsx("span",{className:"w-6 text-center text-muted-foreground text-sm",children:d+1}),e.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-muted",children:(T=(j=s.images)==null?void 0:j[0])!=null&&T.url?e.jsx("img",{src:s.images[0].url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ue,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:(Ae=s.genres)==null?void 0:Ae.slice(0,2).join(", ")})]})]},s.id)})})}),(Le=f==null?void 0:f.tracks)!=null&&Le.length?e.jsx(L,{value:"recent",className:"mt-4",children:e.jsx(me,{cols:{sm:1,md:2,lg:3},gap:"sm",children:f.tracks.filter(s=>s.spotifyId||s.spotify_id||s.youtubeId||s.youtube_id).map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/30 transition-colors cursor-pointer group",onClick:()=>de(s),children:[e.jsx("div",{className:"w-12 h-12 rounded-xl overflow-hidden bg-muted",children:s.cover_url?e.jsx("img",{src:s.cover_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(W,{className:"w-5 h-5 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist}),s.played_at&&e.jsx("p",{className:"text-[11px] text-muted-foreground/80",children:Re(s.played_at)})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:d=>{d.stopPropagation(),de(s)},className:"h-8 w-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center hover:bg-primary/90","aria-label":"Play",children:e.jsx(ds,{className:"w-4 h-4"})}),e.jsx(us,{track:{spotifyId:s.spotifyId||s.spotify_id,youtubeId:s.youtubeId||s.youtube_id},canonicalTrackId:s.id,trackTitle:s.title,trackArtist:s.artist,size:"sm"})]})]},s.id))})}):e.jsx(L,{value:"recent",className:"mt-4",children:e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No recent plays. Start listening now!"})})]})]}),ce&&fe.length>0&&e.jsxs(b.div,{variants:w,initial:"initial",animate:"animate",transition:{delay:.19},className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-accent"}),"Recommended For You"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3",children:fe.slice(0,10).map(s=>e.jsxs("div",{className:"p-2 glass rounded-xl hover:bg-muted/30 transition-colors group cursor-pointer",children:[e.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-muted mb-2",children:s.cover_url?e.jsx("img",{src:s.cover_url,alt:"",className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(zs,{className:"w-8 h-8 text-muted-foreground"})})}),e.jsx("p",{className:"font-medium text-xs truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist})]},s.id))})]}),ee&&F&&e.jsxs(b.div,{variants:w,initial:"initial",animate:"animate",transition:{delay:.21},className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-[#D51007]"}),"Last.fm Stats"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:F.totalScrobbles.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Scrobbles"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:F.weeklyArtistCount}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Artists This Week"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:F.topArtists.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Top Artists"})]})]}),F.topArtists.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Top Artists (3 months)"}),e.jsx("div",{className:"space-y-2",children:F.topArtists.slice(0,5).map((s,d)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 text-muted-foreground text-sm",children:d+1}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-muted",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ue,{className:"w-3 h-3 text-muted-foreground"})})}),e.jsx("span",{className:"flex-1 text-sm truncate",children:s.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.playcount," plays"]})]},s.name))})]})]}),Z.length>0&&e.jsxs(b.div,{variants:w,initial:"initial",animate:"animate",transition:{delay:.2},className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Rs,{className:"w-5 h-5"}),"Play History"]}),U&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[U.totalPlays," total plays"]})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[e.jsx("button",{onClick:()=>o("all"),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors ${l==="all"?"bg-primary text-primary-foreground":"bg-muted/50 text-muted-foreground hover:bg-muted"}`,children:"All"}),Object.entries(I).map(([s,d])=>P.some(T=>T.provider===s)?e.jsxs("button",{onClick:()=>o(s),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap flex items-center gap-1 transition-colors ${l===s?"text-white":"bg-muted/50 text-muted-foreground hover:bg-muted"}`,style:l===s?{backgroundColor:d.color}:{},children:[e.jsx("span",{children:d.icon}),d.name]},s):null)]}),e.jsx("div",{className:"space-y-2",children:Z.map(s=>{var j;if(!s.track_id)return null;const d=s.track_id.includes("seed-")?"Sample Track":((j=s.track_id.split(":").pop())==null?void 0:j.slice(0,12))||"Unknown Track";return e.jsxs(b.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-3 glass rounded-xl flex gap-3 hover:bg-muted/30 transition-colors cursor-pointer",onClick:()=>bs(n,s.track_id),children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-muted/50 flex-shrink-0",children:e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(W,{className:"w-6 h-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:d}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ut,{provider:s.provider,size:"sm"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:Re(s.played_at)})]})]}),e.jsx(Ie,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"})]},s.id)})})]}),e.jsxs(b.div,{variants:w,initial:"initial",animate:"animate",transition:{delay:.25},className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"p-4 glass rounded-2xl flex flex-col items-center gap-2 hover:bg-muted/30 transition-colors",children:[e.jsx($s,{className:"w-6 h-6 text-accent"}),e.jsx("span",{className:"text-sm font-medium",children:"Liked"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Ge," songs"]})]}),e.jsxs("button",{className:"p-4 glass rounded-2xl flex flex-col items-center gap-2 hover:bg-muted/30 transition-colors",children:[e.jsx(Us,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Saved"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Ze," songs"]})]})]}),ve&&e.jsx(b.div,{variants:w,initial:"initial",animate:"animate",transition:{delay:.3},className:"mt-6",children:e.jsxs(_,{variant:"outline",className:"w-full justify-center gap-2",onClick:()=>n("/admin"),children:[e.jsx(Te,{className:"w-4 h-4"}),"Admin Dashboard"]})})]}),e.jsx(bt,{open:H,onOpenChange:V,currentTheme:Ye,userId:(t==null?void 0:t.id)||""})]}):e.jsx(qe,{title:"Profile",children:e.jsx(xs,{icon:ue,title:"Sign in to see your profile",description:"Track your harmonic taste DNA and saved songs",actionLabel:"Sign in",onAction:()=>n("/auth")})})}export{fa as default};
