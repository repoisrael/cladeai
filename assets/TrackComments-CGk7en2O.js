import{c as Z,o as It,p as ke,q as Te,r as a,j as t,A as kt,af as ce,t as Q,w,D as Tt,z as At,v as V,F as Ae,E as Ot,ag as Oe,ah as Ft,R as Lt,H as Gt,I as Kt,G as $t,b as R,a as Ut,u as Bt,s as T,B as A,m as fe}from"./index-T1idvDzn.js";import{T as Se}from"./textarea-BY-RzU9o.js";import{A as zt}from"./avatar-CO2l9CZl.js";import{B as Vt}from"./badge-BoCeCX8k.js";import{u as Ht}from"./index-CaovQ9W8.js";import{h as qt,u as Xt,F as Yt,R as Wt}from"./Combination-xTo90D51.js";import{c as Fe,R as Jt,I as Zt}from"./index-DkbrCv0n.js";import{u as Ee}from"./index-pkhscWZO.js";import{C as Qt}from"./chevron-right-B_Jch_C1.js";import{C as en}from"./check-CHs1z_sf.js";import{M as he}from"./search-Bn18bVT0.js";import{S as tn}from"./send-uG0CH0ZG.js";import{S as nn}from"./sparkles-CJzOfiSm.js";import{A as De}from"./index-BUG_bgBD.js";import{f as rn}from"./formatDistanceToNow-3UBXKcFR.js";import{H as on}from"./heart-C_c4pjlL.js";import{T as an}from"./trash-2-B6Nt05Sp.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=Z("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=Z("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=Z("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=Z("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=Z("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var xe=["Enter"," "],un=["ArrowDown","PageUp","Home"],Le=["ArrowUp","PageDown","End"],pn=[...un,...Le],mn={ltr:[...xe,"ArrowRight"],rtl:[...xe,"ArrowLeft"]},fn={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ee="Menu",[W,hn,xn]=It(ee),[L,Ge]=ke(ee,[xn,Te,Fe]),ie=Te(),Ke=Fe(),[gn,G]=L(ee),[vn,te]=L(ee),$e=e=>{const{__scopeMenu:r,open:n=!1,children:o,dir:s,onOpenChange:c,modal:p=!0}=e,u=ie(r),[h,x]=a.useState(null),m=a.useRef(!1),i=Ae(c),f=Ht(s);return a.useEffect(()=>{const v=()=>{m.current=!0,document.addEventListener("pointerdown",M,{capture:!0,once:!0}),document.addEventListener("pointermove",M,{capture:!0,once:!0})},M=()=>m.current=!1;return document.addEventListener("keydown",v,{capture:!0}),()=>{document.removeEventListener("keydown",v,{capture:!0}),document.removeEventListener("pointerdown",M,{capture:!0}),document.removeEventListener("pointermove",M,{capture:!0})}},[]),t.jsx(Lt,{...u,children:t.jsx(gn,{scope:r,open:n,onOpenChange:i,content:h,onContentChange:x,children:t.jsx(vn,{scope:r,onClose:a.useCallback(()=>i(!1),[i]),isUsingKeyboardRef:m,dir:f,modal:p,children:o})})})};$e.displayName=ee;var wn="MenuAnchor",ve=a.forwardRef((e,r)=>{const{__scopeMenu:n,...o}=e,s=ie(n);return t.jsx(kt,{...s,...o,ref:r})});ve.displayName=wn;var we="MenuPortal",[Mn,Ue]=L(we,{forceMount:void 0}),Be=e=>{const{__scopeMenu:r,forceMount:n,children:o,container:s}=e,c=G(we,r);return t.jsx(Mn,{scope:r,forceMount:n,children:t.jsx(ce,{present:n||c.open,children:t.jsx(Gt,{asChild:!0,container:s,children:o})})})};Be.displayName=we;var j="MenuContent",[yn,Me]=L(j),ze=a.forwardRef((e,r)=>{const n=Ue(j,e.__scopeMenu),{forceMount:o=n.forceMount,...s}=e,c=G(j,e.__scopeMenu),p=te(j,e.__scopeMenu);return t.jsx(W.Provider,{scope:e.__scopeMenu,children:t.jsx(ce,{present:o||c.open,children:t.jsx(W.Slot,{scope:e.__scopeMenu,children:p.modal?t.jsx(_n,{...s,ref:r}):t.jsx(Cn,{...s,ref:r})})})})}),_n=a.forwardRef((e,r)=>{const n=G(j,e.__scopeMenu),o=a.useRef(null),s=Q(r,o);return a.useEffect(()=>{const c=o.current;if(c)return qt(c)},[]),t.jsx(ye,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:w(e.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Cn=a.forwardRef((e,r)=>{const n=G(j,e.__scopeMenu);return t.jsx(ye,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),bn=Kt("MenuContent.ScrollLock"),ye=a.forwardRef((e,r)=>{const{__scopeMenu:n,loop:o=!1,trapFocus:s,onOpenAutoFocus:c,onCloseAutoFocus:p,disableOutsidePointerEvents:u,onEntryFocus:h,onEscapeKeyDown:x,onPointerDownOutside:m,onFocusOutside:i,onInteractOutside:f,onDismiss:v,disableOutsideScroll:M,...D}=e,S=G(j,n),P=te(j,n),I=ie(n),F=Ke(n),ne=hn(n),[K,re]=a.useState(null),_=a.useRef(null),H=Q(r,_,S.onContentChange),$=a.useRef(0),U=a.useRef(""),ue=a.useRef(0),q=a.useRef(null),oe=a.useRef("right"),B=a.useRef(0),d=M?Wt:a.Fragment,g=M?{as:bn,allowPinchZoom:!0}:void 0,b=l=>{var z,Re;const N=U.current+l,E=ne().filter(k=>!k.disabled),O=document.activeElement,pe=(z=E.find(k=>k.ref.current===O))==null?void 0:z.textValue,me=E.map(k=>k.textValue),Ne=On(me,N,pe),X=(Re=E.find(k=>k.textValue===Ne))==null?void 0:Re.ref.current;(function k(je){U.current=je,window.clearTimeout($.current),je!==""&&($.current=window.setTimeout(()=>k(""),1e3))})(N),X&&setTimeout(()=>X.focus())};a.useEffect(()=>()=>window.clearTimeout($.current),[]),Xt();const C=a.useCallback(l=>{var E,O;return oe.current===((E=q.current)==null?void 0:E.side)&&Ln(l,(O=q.current)==null?void 0:O.area)},[]);return t.jsx(yn,{scope:n,searchRef:U,onItemEnter:a.useCallback(l=>{C(l)&&l.preventDefault()},[C]),onItemLeave:a.useCallback(l=>{var N;C(l)||((N=_.current)==null||N.focus(),re(null))},[C]),onTriggerLeave:a.useCallback(l=>{C(l)&&l.preventDefault()},[C]),pointerGraceTimerRef:ue,onPointerGraceIntentChange:a.useCallback(l=>{q.current=l},[]),children:t.jsx(d,{...g,children:t.jsx(Yt,{asChild:!0,trapped:s,onMountAutoFocus:w(c,l=>{var N;l.preventDefault(),(N=_.current)==null||N.focus({preventScroll:!0})}),onUnmountAutoFocus:p,children:t.jsx(Tt,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:x,onPointerDownOutside:m,onFocusOutside:i,onInteractOutside:f,onDismiss:v,children:t.jsx(Jt,{asChild:!0,...F,dir:P.dir,orientation:"vertical",loop:o,currentTabStopId:K,onCurrentTabStopIdChange:re,onEntryFocus:w(h,l=>{P.isUsingKeyboardRef.current||l.preventDefault()}),preventScrollOnEntryFocus:!0,children:t.jsx(At,{role:"menu","aria-orientation":"vertical","data-state":st(S.open),"data-radix-menu-content":"",dir:P.dir,...I,...D,ref:H,style:{outline:"none",...D.style},onKeyDown:w(D.onKeyDown,l=>{const E=l.target.closest("[data-radix-menu-content]")===l.currentTarget,O=l.ctrlKey||l.altKey||l.metaKey,pe=l.key.length===1;E&&(l.key==="Tab"&&l.preventDefault(),!O&&pe&&b(l.key));const me=_.current;if(l.target!==me||!pn.includes(l.key))return;l.preventDefault();const X=ne().filter(z=>!z.disabled).map(z=>z.ref.current);Le.includes(l.key)&&X.reverse(),Tn(X)}),onBlur:w(e.onBlur,l=>{l.currentTarget.contains(l.target)||(window.clearTimeout($.current),U.current="")}),onPointerMove:w(e.onPointerMove,J(l=>{const N=l.target,E=B.current!==l.clientX;if(l.currentTarget.contains(N)&&E){const O=l.clientX>B.current?"right":"left";oe.current=O,B.current=l.clientX}}))})})})})})})});ze.displayName=j;var Nn="MenuGroup",_e=a.forwardRef((e,r)=>{const{__scopeMenu:n,...o}=e;return t.jsx(V.div,{role:"group",...o,ref:r})});_e.displayName=Nn;var Rn="MenuLabel",Ve=a.forwardRef((e,r)=>{const{__scopeMenu:n,...o}=e;return t.jsx(V.div,{...o,ref:r})});Ve.displayName=Rn;var ae="MenuItem",Ie="menu.itemSelect",de=a.forwardRef((e,r)=>{const{disabled:n=!1,onSelect:o,...s}=e,c=a.useRef(null),p=te(ae,e.__scopeMenu),u=Me(ae,e.__scopeMenu),h=Q(r,c),x=a.useRef(!1),m=()=>{const i=c.current;if(!n&&i){const f=new CustomEvent(Ie,{bubbles:!0,cancelable:!0});i.addEventListener(Ie,v=>o==null?void 0:o(v),{once:!0}),Ft(i,f),f.defaultPrevented?x.current=!1:p.onClose()}};return t.jsx(He,{...s,ref:h,disabled:n,onClick:w(e.onClick,m),onPointerDown:i=>{var f;(f=e.onPointerDown)==null||f.call(e,i),x.current=!0},onPointerUp:w(e.onPointerUp,i=>{var f;x.current||(f=i.currentTarget)==null||f.click()}),onKeyDown:w(e.onKeyDown,i=>{const f=u.searchRef.current!=="";n||f&&i.key===" "||xe.includes(i.key)&&(i.currentTarget.click(),i.preventDefault())})})});de.displayName=ae;var He=a.forwardRef((e,r)=>{const{__scopeMenu:n,disabled:o=!1,textValue:s,...c}=e,p=Me(ae,n),u=Ke(n),h=a.useRef(null),x=Q(r,h),[m,i]=a.useState(!1),[f,v]=a.useState("");return a.useEffect(()=>{const M=h.current;M&&v((M.textContent??"").trim())},[c.children]),t.jsx(W.ItemSlot,{scope:n,disabled:o,textValue:s??f,children:t.jsx(Zt,{asChild:!0,...u,focusable:!o,children:t.jsx(V.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":o||void 0,"data-disabled":o?"":void 0,...c,ref:x,onPointerMove:w(e.onPointerMove,J(M=>{o?p.onItemLeave(M):(p.onItemEnter(M),M.defaultPrevented||M.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:w(e.onPointerLeave,J(M=>p.onItemLeave(M))),onFocus:w(e.onFocus,()=>i(!0)),onBlur:w(e.onBlur,()=>i(!1))})})})}),jn="MenuCheckboxItem",qe=a.forwardRef((e,r)=>{const{checked:n=!1,onCheckedChange:o,...s}=e;return t.jsx(Ze,{scope:e.__scopeMenu,checked:n,children:t.jsx(de,{role:"menuitemcheckbox","aria-checked":se(n)?"mixed":n,...s,ref:r,"data-state":be(n),onSelect:w(s.onSelect,()=>o==null?void 0:o(se(n)?!0:!n),{checkForDefaultPrevented:!1})})})});qe.displayName=jn;var Xe="MenuRadioGroup",[Sn,En]=L(Xe,{value:void 0,onValueChange:()=>{}}),Ye=a.forwardRef((e,r)=>{const{value:n,onValueChange:o,...s}=e,c=Ae(o);return t.jsx(Sn,{scope:e.__scopeMenu,value:n,onValueChange:c,children:t.jsx(_e,{...s,ref:r})})});Ye.displayName=Xe;var We="MenuRadioItem",Je=a.forwardRef((e,r)=>{const{value:n,...o}=e,s=En(We,e.__scopeMenu),c=n===s.value;return t.jsx(Ze,{scope:e.__scopeMenu,checked:c,children:t.jsx(de,{role:"menuitemradio","aria-checked":c,...o,ref:r,"data-state":be(c),onSelect:w(o.onSelect,()=>{var p;return(p=s.onValueChange)==null?void 0:p.call(s,n)},{checkForDefaultPrevented:!1})})})});Je.displayName=We;var Ce="MenuItemIndicator",[Ze,Dn]=L(Ce,{checked:!1}),Qe=a.forwardRef((e,r)=>{const{__scopeMenu:n,forceMount:o,...s}=e,c=Dn(Ce,n);return t.jsx(ce,{present:o||se(c.checked)||c.checked===!0,children:t.jsx(V.span,{...s,ref:r,"data-state":be(c.checked)})})});Qe.displayName=Ce;var Pn="MenuSeparator",et=a.forwardRef((e,r)=>{const{__scopeMenu:n,...o}=e;return t.jsx(V.div,{role:"separator","aria-orientation":"horizontal",...o,ref:r})});et.displayName=Pn;var In="MenuArrow",tt=a.forwardRef((e,r)=>{const{__scopeMenu:n,...o}=e,s=ie(n);return t.jsx(Ot,{...s,...o,ref:r})});tt.displayName=In;var kn="MenuSub",[Vr,nt]=L(kn),Y="MenuSubTrigger",rt=a.forwardRef((e,r)=>{const n=G(Y,e.__scopeMenu),o=te(Y,e.__scopeMenu),s=nt(Y,e.__scopeMenu),c=Me(Y,e.__scopeMenu),p=a.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:h}=c,x={__scopeMenu:e.__scopeMenu},m=a.useCallback(()=>{p.current&&window.clearTimeout(p.current),p.current=null},[]);return a.useEffect(()=>m,[m]),a.useEffect(()=>{const i=u.current;return()=>{window.clearTimeout(i),h(null)}},[u,h]),t.jsx(ve,{asChild:!0,...x,children:t.jsx(He,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":st(n.open),...e,ref:Oe(r,s.onTriggerChange),onClick:i=>{var f;(f=e.onClick)==null||f.call(e,i),!(e.disabled||i.defaultPrevented)&&(i.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:w(e.onPointerMove,J(i=>{c.onItemEnter(i),!i.defaultPrevented&&!e.disabled&&!n.open&&!p.current&&(c.onPointerGraceIntentChange(null),p.current=window.setTimeout(()=>{n.onOpenChange(!0),m()},100))})),onPointerLeave:w(e.onPointerLeave,J(i=>{var v,M;m();const f=(v=n.content)==null?void 0:v.getBoundingClientRect();if(f){const D=(M=n.content)==null?void 0:M.dataset.side,S=D==="right",P=S?-5:5,I=f[S?"left":"right"],F=f[S?"right":"left"];c.onPointerGraceIntentChange({area:[{x:i.clientX+P,y:i.clientY},{x:I,y:f.top},{x:F,y:f.top},{x:F,y:f.bottom},{x:I,y:f.bottom}],side:D}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>c.onPointerGraceIntentChange(null),300)}else{if(c.onTriggerLeave(i),i.defaultPrevented)return;c.onPointerGraceIntentChange(null)}})),onKeyDown:w(e.onKeyDown,i=>{var v;const f=c.searchRef.current!=="";e.disabled||f&&i.key===" "||mn[o.dir].includes(i.key)&&(n.onOpenChange(!0),(v=n.content)==null||v.focus(),i.preventDefault())})})})});rt.displayName=Y;var ot="MenuSubContent",at=a.forwardRef((e,r)=>{const n=Ue(j,e.__scopeMenu),{forceMount:o=n.forceMount,...s}=e,c=G(j,e.__scopeMenu),p=te(j,e.__scopeMenu),u=nt(ot,e.__scopeMenu),h=a.useRef(null),x=Q(r,h);return t.jsx(W.Provider,{scope:e.__scopeMenu,children:t.jsx(ce,{present:o||c.open,children:t.jsx(W.Slot,{scope:e.__scopeMenu,children:t.jsx(ye,{id:u.contentId,"aria-labelledby":u.triggerId,...s,ref:x,align:"start",side:p.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{var i;p.isUsingKeyboardRef.current&&((i=h.current)==null||i.focus()),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:w(e.onFocusOutside,m=>{m.target!==u.trigger&&c.onOpenChange(!1)}),onEscapeKeyDown:w(e.onEscapeKeyDown,m=>{p.onClose(),m.preventDefault()}),onKeyDown:w(e.onKeyDown,m=>{var v;const i=m.currentTarget.contains(m.target),f=fn[p.dir].includes(m.key);i&&f&&(c.onOpenChange(!1),(v=u.trigger)==null||v.focus(),m.preventDefault())})})})})})});at.displayName=ot;function st(e){return e?"open":"closed"}function se(e){return e==="indeterminate"}function be(e){return se(e)?"indeterminate":e?"checked":"unchecked"}function Tn(e){const r=document.activeElement;for(const n of e)if(n===r||(n.focus(),document.activeElement!==r))return}function An(e,r){return e.map((n,o)=>e[(r+o)%e.length])}function On(e,r,n){const s=r.length>1&&Array.from(r).every(x=>x===r[0])?r[0]:r,c=n?e.indexOf(n):-1;let p=An(e,Math.max(c,0));s.length===1&&(p=p.filter(x=>x!==n));const h=p.find(x=>x.toLowerCase().startsWith(s.toLowerCase()));return h!==n?h:void 0}function Fn(e,r){const{x:n,y:o}=e;let s=!1;for(let c=0,p=r.length-1;c<r.length;p=c++){const u=r[c],h=r[p],x=u.x,m=u.y,i=h.x,f=h.y;m>o!=f>o&&n<(i-x)*(o-m)/(f-m)+x&&(s=!s)}return s}function Ln(e,r){if(!r)return!1;const n={x:e.clientX,y:e.clientY};return Fn(n,r)}function J(e){return r=>r.pointerType==="mouse"?e(r):void 0}var Gn=$e,Kn=ve,$n=Be,Un=ze,Bn=_e,zn=Ve,Vn=de,Hn=qe,qn=Ye,Xn=Je,Yn=Qe,Wn=et,Jn=tt,Zn=rt,Qn=at,le="DropdownMenu",[er,Hr]=ke(le,[Ge]),y=Ge(),[tr,ct]=er(le),it=e=>{const{__scopeDropdownMenu:r,children:n,dir:o,open:s,defaultOpen:c,onOpenChange:p,modal:u=!0}=e,h=y(r),x=a.useRef(null),[m,i]=$t({prop:s,defaultProp:c??!1,onChange:p,caller:le});return t.jsx(tr,{scope:r,triggerId:Ee(),triggerRef:x,contentId:Ee(),open:m,onOpenChange:i,onOpenToggle:a.useCallback(()=>i(f=>!f),[i]),modal:u,children:t.jsx(Gn,{...h,open:m,onOpenChange:i,dir:o,modal:u,children:n})})};it.displayName=le;var dt="DropdownMenuTrigger",lt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,disabled:o=!1,...s}=e,c=ct(dt,n),p=y(n);return t.jsx(Kn,{asChild:!0,...p,children:t.jsx(V.button,{type:"button",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":c.open,"aria-controls":c.open?c.contentId:void 0,"data-state":c.open?"open":"closed","data-disabled":o?"":void 0,disabled:o,...s,ref:Oe(r,c.triggerRef),onPointerDown:w(e.onPointerDown,u=>{!o&&u.button===0&&u.ctrlKey===!1&&(c.onOpenToggle(),c.open||u.preventDefault())}),onKeyDown:w(e.onKeyDown,u=>{o||(["Enter"," "].includes(u.key)&&c.onOpenToggle(),u.key==="ArrowDown"&&c.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});lt.displayName=dt;var nr="DropdownMenuPortal",ut=e=>{const{__scopeDropdownMenu:r,...n}=e,o=y(r);return t.jsx($n,{...o,...n})};ut.displayName=nr;var pt="DropdownMenuContent",mt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=ct(pt,n),c=y(n),p=a.useRef(!1);return t.jsx(Un,{id:s.contentId,"aria-labelledby":s.triggerId,...c,...o,ref:r,onCloseAutoFocus:w(e.onCloseAutoFocus,u=>{var h;p.current||(h=s.triggerRef.current)==null||h.focus(),p.current=!1,u.preventDefault()}),onInteractOutside:w(e.onInteractOutside,u=>{const h=u.detail.originalEvent,x=h.button===0&&h.ctrlKey===!0,m=h.button===2||x;(!s.modal||m)&&(p.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mt.displayName=pt;var rr="DropdownMenuGroup",or=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(Bn,{...s,...o,ref:r})});or.displayName=rr;var ar="DropdownMenuLabel",ft=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(zn,{...s,...o,ref:r})});ft.displayName=ar;var sr="DropdownMenuItem",ht=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(Vn,{...s,...o,ref:r})});ht.displayName=sr;var cr="DropdownMenuCheckboxItem",xt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(Hn,{...s,...o,ref:r})});xt.displayName=cr;var ir="DropdownMenuRadioGroup",dr=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(qn,{...s,...o,ref:r})});dr.displayName=ir;var lr="DropdownMenuRadioItem",gt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(Xn,{...s,...o,ref:r})});gt.displayName=lr;var ur="DropdownMenuItemIndicator",vt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(Yn,{...s,...o,ref:r})});vt.displayName=ur;var pr="DropdownMenuSeparator",wt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(Wn,{...s,...o,ref:r})});wt.displayName=pr;var mr="DropdownMenuArrow",fr=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(Jn,{...s,...o,ref:r})});fr.displayName=mr;var hr="DropdownMenuSubTrigger",Mt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(Zn,{...s,...o,ref:r})});Mt.displayName=hr;var xr="DropdownMenuSubContent",yt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=y(n);return t.jsx(Qn,{...s,...o,ref:r,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});yt.displayName=xr;var gr=it,vr=lt,wr=ut,_t=mt,Ct=ft,bt=ht,Nt=xt,Rt=gt,jt=vt,St=wt,Et=Mt,Dt=yt;const Mr=gr,yr=vr,_r=a.forwardRef(({className:e,inset:r,children:n,...o},s)=>t.jsxs(Et,{ref:s,className:R("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",r&&"pl-8",e),...o,children:[n,t.jsx(Qt,{className:"ml-auto h-4 w-4"})]}));_r.displayName=Et.displayName;const Cr=a.forwardRef(({className:e,...r},n)=>t.jsx(Dt,{ref:n,className:R("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));Cr.displayName=Dt.displayName;const Pt=a.forwardRef(({className:e,sideOffset:r=4,...n},o)=>t.jsx(wr,{children:t.jsx(_t,{ref:o,sideOffset:r,className:R("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Pt.displayName=_t.displayName;const ge=a.forwardRef(({className:e,inset:r,...n},o)=>t.jsx(bt,{ref:o,className:R("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",r&&"pl-8",e),...n}));ge.displayName=bt.displayName;const br=a.forwardRef(({className:e,children:r,checked:n,...o},s)=>t.jsxs(Nt,{ref:s,className:R("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:n,...o,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(jt,{children:t.jsx(en,{className:"h-4 w-4"})})}),r]}));br.displayName=Nt.displayName;const Nr=a.forwardRef(({className:e,children:r,...n},o)=>t.jsxs(Rt,{ref:o,className:R("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...n,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(jt,{children:t.jsx(sn,{className:"h-2 w-2 fill-current"})})}),r]}));Nr.displayName=Rt.displayName;const Rr=a.forwardRef(({className:e,inset:r,...n},o)=>t.jsx(Ct,{ref:o,className:R("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",e),...n}));Rr.displayName=Ct.displayName;const jr=a.forwardRef(({className:e,...r},n)=>t.jsx(St,{ref:n,className:R("-mx-1 my-1 h-px bg-muted",e),...r}));jr.displayName=St.displayName;function qr({trackId:e,className:r=""}){const{user:n,guestMode:o}=Ut(),s=Bt(),[c,p]=a.useState([]),[u,h]=a.useState(""),[x,m]=a.useState(!1),[i,f]=a.useState(!0),[v,M]=a.useState(null),[D,S]=a.useState(null),[P,I]=a.useState(""),[F,ne]=a.useState({}),[K,re]=a.useState({});a.useEffect(()=>{e&&(_(),$())},[e]);const _=async()=>{f(!0);try{const{data:d,error:g}=await T.rpc("get_track_comments",{p_track_id:e,p_limit:50,p_offset:0});if(g)throw g;p(d||[])}catch(d){console.error("Error loading comments:",d)}finally{f(!1)}},H=async d=>{try{const{data:g,error:b}=await T.rpc("get_comment_replies",{p_comment_id:d});if(b)throw b;ne(C=>({...C,[d]:g||[]})),re(C=>({...C,[d]:!0}))}catch(g){console.error("Error loading replies:",g)}},$=()=>{const d=T.channel(`track-comments:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"track_comments",filter:`track_id=eq.${e}`},()=>{_()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"track_comments",filter:`track_id=eq.${e}`},()=>{_()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"track_comments",filter:`track_id=eq.${e}`},()=>{_()}).subscribe();return()=>{T.removeChannel(d)}},U=async d=>{if(d.preventDefault(),!(!u.trim()||!n||x)){m(!0);try{const{error:g}=await T.from("track_comments").insert({track_id:e,user_id:n.id,comment:u.trim(),reply_to:(v==null?void 0:v.id)||null});if(g)throw g;h(""),M(null),v?await H(v.id):await _()}catch(g){console.error("Error posting comment:",g)}finally{m(!1)}}},ue=async(d,g)=>{if(n)try{g?await T.from("track_comment_likes").delete().eq("comment_id",d).eq("user_id",n.id):await T.from("track_comment_likes").insert({comment_id:d,user_id:n.id}),await _(),Object.keys(K).forEach(b=>{K[b]&&H(b)})}catch(b){console.error("Error toggling like:",b)}},q=async d=>{if(P.trim())try{const{error:g}=await T.from("track_comments").update({comment:P.trim(),edited_at:new Date().toISOString()}).eq("id",d);if(g)throw g;S(null),I(""),await _()}catch(g){console.error("Error editing comment:",g)}},oe=async d=>{if(confirm("Delete this comment?"))try{const{error:g}=await T.from("track_comments").delete().eq("id",d);if(g)throw g;await _()}catch(g){console.error("Error deleting comment:",g)}},B=(d,g=!1)=>{var b,C;return t.jsxs(fe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:R("space-y-2",g&&"ml-12"),children:[t.jsxs("div",{className:"flex gap-3",children:[t.jsx(zt,{className:"w-10 h-10 flex-shrink-0",children:d.user_avatar_url?t.jsx("img",{src:d.user_avatar_url,alt:""}):t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-sm font-semibold",children:((C=(b=d.user_display_name)==null?void 0:b[0])==null?void 0:C.toUpperCase())||"?"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:"font-medium text-sm",children:d.user_display_name||"Anonymous"}),t.jsx("span",{className:"text-xs text-muted-foreground",children:rn(new Date(d.created_at),{addSuffix:!0})}),d.edited_at&&t.jsx("span",{className:"text-xs text-muted-foreground",children:"(edited)"})]}),D===d.id?t.jsxs("div",{className:"space-y-2",children:[t.jsx(Se,{value:P,onChange:l=>I(l.target.value),className:"min-h-[60px]",maxLength:2e3}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(A,{size:"sm",onClick:()=>q(d.id),children:"Save"}),t.jsx(A,{size:"sm",variant:"ghost",onClick:()=>{S(null),I("")},children:"Cancel"})]})]}):t.jsx("p",{className:"text-sm break-words whitespace-pre-wrap",children:d.comment}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsxs(A,{variant:"ghost",size:"sm",className:R("h-8 gap-1.5 text-xs",d.user_liked&&"text-red-500 hover:text-red-600"),onClick:()=>ue(d.id,d.user_liked),children:[t.jsx(on,{className:R("w-4 h-4",d.user_liked&&"fill-current")}),d.likes_count>0&&d.likes_count]}),!g&&t.jsxs(A,{variant:"ghost",size:"sm",className:"h-8 gap-1.5 text-xs",onClick:()=>M(d),children:[t.jsx(Pe,{className:"w-4 h-4"}),"Reply"]}),(n==null?void 0:n.id)===d.user_id&&t.jsxs(Mr,{children:[t.jsx(yr,{asChild:!0,children:t.jsx(A,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:t.jsx(cn,{className:"w-4 h-4"})})}),t.jsxs(Pt,{align:"end",children:[t.jsxs(ge,{onClick:()=>{S(d.id),I(d.comment)},children:[t.jsx(dn,{className:"w-4 h-4 mr-2"}),"Edit"]}),t.jsxs(ge,{className:"text-red-600",onClick:()=>oe(d.id),children:[t.jsx(an,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),!g&&!K[d.id]&&t.jsx(A,{variant:"ghost",size:"sm",className:"h-8 text-xs mt-2",onClick:()=>H(d.id),children:"View replies"})]})]}),t.jsx(De,{children:K[d.id]&&F[d.id]&&t.jsx(fe.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"space-y-3 mt-3",children:F[d.id].map(l=>B(l,!0))})})]},d.id)};return t.jsxs("div",{className:R("space-y-6",r),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(he,{className:"w-5 h-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"Comments"}),t.jsx(Vt,{variant:"secondary",children:c.length})]}),n?t.jsxs("form",{onSubmit:U,className:"space-y-3",children:[v&&t.jsxs("div",{className:"p-3 bg-muted rounded-lg flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.jsx(Pe,{className:"w-3 h-3 inline mr-1"}),"Replying to ",v.user_display_name]}),t.jsx(A,{type:"button",variant:"ghost",size:"sm",onClick:()=>M(null),children:"Cancel"})]}),t.jsx(Se,{placeholder:"Share your thoughts about this track...",value:u,onChange:d=>h(d.target.value),className:"min-h-[100px] resize-none",maxLength:2e3}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-xs text-muted-foreground",children:[u.length,"/2000"]}),t.jsxs(A,{type:"submit",disabled:!u.trim()||x,children:[t.jsx(tn,{className:"w-4 h-4 mr-2"}),x?"Posting...":v?"Reply":"Post Comment"]})]})]}):t.jsxs(fe.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"relative overflow-hidden rounded-xl border-2 border-dashed border-border/50 bg-gradient-to-br from-background via-background to-muted/20 p-8 text-center",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#00F5FF]/5 via-[#FF00FF]/5 to-[#00F5FF]/5 animate-pulse"}),t.jsxs("div",{className:"relative z-10",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-[#00F5FF] to-[#FF00FF] mb-4",children:t.jsx(he,{className:"w-8 h-8 text-white"})}),t.jsxs("h4",{className:"text-lg font-semibold mb-2 flex items-center justify-center gap-2",children:["Join the Conversation",t.jsx(nn,{className:"w-4 h-4 text-[#FF00FF]"})]}),t.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-md mx-auto",children:"Sign up to share your thoughts, reply to others, and connect with music lovers who get it"}),t.jsxs(A,{size:"lg",onClick:()=>s("/auth"),className:"bg-gradient-to-r from-[#00F5FF] to-[#FF00FF] hover:opacity-90 transition-opacity shadow-lg shadow-[#00F5FF]/20",children:[t.jsx(ln,{className:"w-5 h-5 mr-2"}),"Sign Up to Comment"]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-4",children:["Already have an account?"," ",t.jsx("button",{onClick:()=>s("/auth"),className:"text-[#00F5FF] hover:underline font-medium",children:"Sign in"})]})]})]}),t.jsx("div",{className:"space-y-6",children:i?t.jsx("div",{className:"text-center py-8",children:t.jsx("div",{className:"inline-block w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"})}):c.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(he,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground opacity-50"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"No comments yet. Be the first to share your thoughts!"})]}):t.jsx(De,{children:c.map(d=>B(d))})})]})}export{Mr as D,cn as E,dn as P,Pe as R,qr as T,ln as U,yr as a,Pt as b,ge as c,jr as d};
