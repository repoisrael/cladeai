import{p as f}from"./index-BVR2Ma7G.js";const d="https://api.spotify.com/v1";async function y(n,l,i=50,o=0){const s=await f(n);if(!s)return console.warn("No Spotify access token available - user may need to reconnect"),[];try{const a=new URLSearchParams({q:l,type:"track",limit:Math.min(i,50).toString(),offset:Math.max(0,o).toString(),market:"US"}),e=await fetch(`${d}/search?${a}`,{headers:{Authorization:`Bearer ${s}`}});if(!e.ok)return e.status===401?console.error("Spotify token invalid - user needs to reconnect"):console.error("Spotify search failed:",e.status,await e.text()),[];const t=await e.json();return{total:t.tracks.total,tracks:t.tracks.items.map(r=>{var c,p,m;return{id:`spotify:${r.id}`,title:r.name,artist:r.artists.map(u=>u.name).join(", "),artists:r.artists.map(u=>u.name),album:r.album.name,cover_url:(c=r.album.images[0])==null?void 0:c.url,artwork_url:(p=r.album.images[0])==null?void 0:p.url,duration_ms:r.duration_ms,preview_url:r.preview_url,spotify_id:r.id,url_spotify_web:r.external_urls.spotify,url_spotify_app:r.uri,provider:"spotify",external_id:r.id,isrc:(m=r.external_ids)==null?void 0:m.isrc}})}}catch(a){return console.error("Error searching Spotify:",a),{tracks:[],total:0}}}async function h(n,l){var o,s,a;const i=await f(n);if(!i)return console.warn("No Spotify access token available - user may need to reconnect"),null;try{const e=await fetch(`${d}/tracks/${l}`,{headers:{Authorization:`Bearer ${i}`}});if(!e.ok)return console.error("Spotify track fetch failed:",e.status),null;const t=await e.json();return{id:`spotify:${t.id}`,title:t.name,artist:t.artists.map(r=>r.name).join(", "),artists:t.artists.map(r=>r.name),album:t.album.name,cover_url:(o=t.album.images[0])==null?void 0:o.url,artwork_url:(s=t.album.images[0])==null?void 0:s.url,duration_ms:t.duration_ms,preview_url:t.preview_url,spotify_id:t.id,url_spotify_web:t.external_urls.spotify,url_spotify_app:t.uri,provider:"spotify",external_id:t.id,isrc:(a=t.external_ids)==null?void 0:a.isrc}}catch(e){return console.error("Error fetching Spotify track:",e),null}}export{h as g,y as s};
