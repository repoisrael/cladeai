import{c as k,r as f,a as G,u as J,j as e,m as x,C as R,S as $,l as p,B as K,M as z}from"./index-DHJxnaPT.js";import{I as W}from"./input-BttSyAy8.js";import{A as v,a as _,b as j}from"./avatar-DeHHhi9Z.js";import{M as q,S as Q}from"./send-BbrQ2bbq.js";import{A as U}from"./index-D7HgWSwk.js";import{H as E}from"./heart-DZ1V0Hja.js";import{f as N}from"./formatDistanceToNow-3UBXKcFR.js";import{A as Y,a as Z}from"./arrow-up-86T_lu8l.js";import{M as g}from"./music-2-B88W2iwL.js";import{E as X}from"./external-link-DD09RarS.js";import{C as ee}from"./chevron-right-BtaW63t8.js";import{F as te}from"./file-text-B4Na35_J.js";import{G as se,M as ae}from"./mic-vocal-CzYIyz72.js";import{U as ie}from"./users-Ck42oO20.js";import{M as re}from"./map-pin-TbMuVzg4.js";import{C as ne}from"./clock-D8GCpzH4.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=k("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=k("Drum",[["path",{d:"m2 2 8 8",key:"1v6059"}],["path",{d:"m22 2-8 8",key:"173r8a"}],["ellipse",{cx:"12",cy:"9",rx:"10",ry:"5",key:"liohsx"}],["path",{d:"M7 13.4v7.9",key:"1yi6u9"}],["path",{d:"M12 14v8",key:"1tn2tj"}],["path",{d:"M17 13.4v7.9",key:"eqz2v3"}],["path",{d:"M2 9v8a10 5 0 0 0 20 0V9",key:"1750ul"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=k("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]),de=[{id:"1",user_id:"u1",content:"This beat is absolutely fire! The way it samples the original is genius ðŸ”¥",created_at:new Date(Date.now()-5*60*1e3).toISOString(),likes_count:42,user:{display_name:"MusicLover99",avatar_url:void 0}},{id:"2",user_id:"u2",content:"The bassline in this is so smooth. Instant classic.",created_at:new Date(Date.now()-15*60*1e3).toISOString(),likes_count:128,user:{display_name:"BeatHead",avatar_url:void 0},is_pinned:!0},{id:"3",user_id:"u3",content:"Just found this through the sample connection. Amazing discovery!",created_at:new Date(Date.now()-30*60*1e3).toISOString(),likes_count:15,user:{display_name:"SampleHunter",avatar_url:void 0}},{id:"4",user_id:"u4",content:"This takes me back to summer 2024. Perfect vibes.",created_at:new Date(Date.now()-60*60*1e3).toISOString(),likes_count:8,user:{display_name:"VibeMaster",avatar_url:void 0}},{id:"5",user_id:"u5",content:"Anyone else hear the jazz influence in the chord progression?",created_at:new Date(Date.now()-2*60*60*1e3).toISOString(),likes_count:23,user:{display_name:"JazzHead",avatar_url:void 0}}];function Te({entityId:a,entityType:d,entityTitle:n,className:i}){var D,M,C,I,A;const[s,l]=f.useState(de),[m,u]=f.useState(""),[b,F]=f.useState(!1),H=f.useRef(null),{user:h}=G(),w=J(),c=s.reduce((t,o)=>o.likes_count>((t==null?void 0:t.likes_count)??0)?o:t,s[0]),S=s.filter(t=>t.id!==(c==null?void 0:c.id)).sort((t,o)=>new Date(o.created_at).getTime()-new Date(t.created_at).getTime()),P=async t=>{var r;if(t.preventDefault(),!m.trim())return;if(!h){w("/auth");return}const o={id:`temp-${Date.now()}`,user_id:h.id,content:m.trim(),created_at:new Date().toISOString(),likes_count:0,user:{display_name:(r=h.email)==null?void 0:r.split("@")[0]}};l(y=>[o,...y]),u("")},V=t=>{if(!h){w("/auth");return}l(o=>o.map(r=>r.id===t?{...r,likes_count:r.user_liked?r.likes_count-1:r.likes_count+1,user_liked:!r.user_liked}:r))};return e.jsxs("div",{className:p("flex flex-col",i),children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-t-xl cursor-pointer",onClick:()=>F(!b),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"font-medium",children:"Live Comments"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",s.length,")"]})]}),e.jsx(x.div,{animate:{rotate:b?180:0},transition:{duration:.2},children:e.jsx(R,{className:"w-5 h-5 text-muted-foreground"})})]}),e.jsx(U,{children:b&&e.jsxs(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:[e.jsx($,{className:"h-64 p-3 bg-background/50 rounded-b-xl",ref:H,children:e.jsxs("div",{className:"space-y-3",children:[S.map((t,o)=>{var r,y,L,T,B;return e.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:o*.05},className:"flex gap-3 p-2 rounded-lg hover:bg-muted/30 transition-colors",children:[e.jsxs(v,{className:"w-8 h-8",children:[e.jsx(_,{src:(r=t.user)==null?void 0:r.avatar_url}),e.jsx(j,{className:"text-xs bg-primary/20 text-primary",children:((T=(L=(y=t.user)==null?void 0:y.display_name)==null?void 0:L[0])==null?void 0:T.toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium truncate",children:((B=t.user)==null?void 0:B.display_name)||"Anonymous"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:N(new Date(t.created_at),{addSuffix:!0})})]}),e.jsx("p",{className:"text-sm text-foreground/90 mt-0.5",children:t.content}),e.jsxs("button",{onClick:()=>V(t.id),className:p("flex items-center gap-1 mt-1 text-xs transition-colors",t.user_liked?"text-accent":"text-muted-foreground hover:text-accent"),children:[e.jsx(E,{className:p("w-3.5 h-3.5",t.user_liked&&"fill-current")}),t.likes_count]})]})]},t.id)}),S.length===0&&e.jsx("p",{className:"text-center text-muted-foreground text-sm py-8",children:"Be the first to comment!"})]})}),e.jsxs("form",{onSubmit:P,className:"flex gap-2 p-3 border-t border-border",children:[e.jsx(W,{placeholder:h?"Add a comment...":"Sign in to comment",value:m,onChange:t=>u(t.target.value),disabled:!h,className:"flex-1"}),e.jsx(K,{type:"submit",size:"icon",disabled:!m.trim()||!h,className:"shrink-0",children:e.jsx(Q,{className:"w-4 h-4"})})]})]})}),c&&e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"fixed bottom-20 left-4 right-4 lg:left-auto lg:right-8 lg:w-96 z-40",children:e.jsxs("div",{className:"glass rounded-xl p-3 shadow-lg border border-accent/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(oe,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-xs font-medium text-accent",children:"Most Liked Comment"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(v,{className:"w-8 h-8",children:[e.jsx(_,{src:(D=c.user)==null?void 0:D.avatar_url}),e.jsx(j,{className:"text-xs bg-accent/20 text-accent",children:((I=(C=(M=c.user)==null?void 0:M.display_name)==null?void 0:C[0])==null?void 0:I.toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium truncate",children:(A=c.user)==null?void 0:A.display_name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:N(new Date(c.created_at),{addSuffix:!0})})]}),e.jsx("p",{className:"text-sm text-foreground/90 mt-0.5 line-clamp-2",children:c.content}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-accent",children:[e.jsx(E,{className:"w-3.5 h-3.5 fill-current"}),c.likes_count]})]})]})]})})]})}const me={vocals:{icon:ae,label:"Vocals",color:"text-pink-500 bg-pink-500/10"},hook:{icon:g,label:"Hook",color:"text-purple-500 bg-purple-500/10"},drums:{icon:ce,label:"Drums",color:"text-orange-500 bg-orange-500/10"},bassline:{icon:se,label:"Bassline",color:"text-blue-500 bg-blue-500/10"},melody:{icon:z,label:"Melody",color:"text-green-500 bg-green-500/10"},lyrics:{icon:te,label:"Lyrics",color:"text-yellow-500 bg-yellow-500/10"},multiple:{icon:g,label:"Multiple Elements",color:"text-accent bg-accent/10"},other:{icon:g,label:"Other",color:"text-muted-foreground bg-muted"}},ue=[{id:"1",original_track:{id:"orig",title:"",artist:""},sampling_track:{id:"s1",title:"Lose Yourself",artist:"Eminem",cover_url:"https://i.scdn.co/image/ab67616d0000b273e1e7e9cf0e30d7a5b1c2f0a8",album:"8 Mile"},element:"drums",description:"Uses the iconic drum pattern from the original",verified:!0,votes:245},{id:"2",original_track:{id:"orig",title:"",artist:""},sampling_track:{id:"s2",title:"Gold Digger",artist:"Kanye West",cover_url:"https://i.scdn.co/image/ab67616d0000b273d4f5a8e2c1a2e3b4c5d6e7f8",album:"Late Registration"},element:"vocals",description:"Samples the vocal hook from the chorus",verified:!0,votes:189},{id:"3",original_track:{id:"orig",title:"",artist:""},sampling_track:{id:"s3",title:"Uptown Funk",artist:"Bruno Mars",cover_url:"https://i.scdn.co/image/ab67616d0000b273a1b2c3d4e5f6a7b8c9d0e1f2",album:"Uptown Special"},element:"bassline",description:"Interpolates the signature bassline",verified:!1,votes:67}],xe=[{id:"4",original_track:{id:"o1",title:"I Got the...",artist:"Labi Siffre",cover_url:"https://i.scdn.co/image/ab67616d0000b273f1f2f3f4f5f6f7f8f9f0f1f2",album:"Remember My Song"},sampling_track:{id:"curr",title:"",artist:""},element:"hook",description:"The main guitar riff was sampled for the beat",verified:!0,votes:312,start_time:45},{id:"5",original_track:{id:"o2",title:"Funky Drummer",artist:"James Brown",cover_url:"https://i.scdn.co/image/ab67616d0000b273c1c2c3c4c5c6c7c8c9c0c1c2",album:"In the Jungle Groove"},sampling_track:{id:"curr",title:"",artist:""},element:"drums",description:"Classic breakbeat from the bridge section",verified:!0,votes:567,start_time:128}];function pe({element:a}){const d=me[a],n=d.icon;return e.jsxs("span",{className:p("inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium",d.color),children:[e.jsx(n,{className:"w-3 h-3"}),d.label]})}function O({connection:a,direction:d}){const n=d==="sampled_by"?a.sampling_track:a.original_track;return e.jsxs(x.div,{initial:{opacity:0,x:d==="sampled_by"?20:-20},animate:{opacity:1,x:0},className:"flex gap-3 p-3 glass rounded-xl hover:bg-muted/30 transition-colors group cursor-pointer",children:[e.jsx("div",{className:"w-14 h-14 rounded-lg overflow-hidden bg-muted shrink-0",children:n.cover_url?e.jsx("img",{src:n.cover_url,alt:n.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(z,{className:"w-6 h-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:n.title}),a.verified&&e.jsx(le,{className:"w-3.5 h-3.5 text-primary shrink-0"})]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:n.artist}),e.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[e.jsx(pe,{element:a.element}),a.start_time&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["@ ",Math.floor(a.start_time/60),":",String(a.start_time%60).padStart(2,"0")]})]}),a.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1",children:a.description})]}),e.jsx("div",{className:"flex items-center text-muted-foreground group-hover:text-primary transition-colors",children:e.jsx(ee,{className:"w-5 h-5"})})]})}function Be({trackId:a,trackTitle:d,className:n}){const[i,s]=f.useState("sampled_by"),l=ue,m=xe;return e.jsxs("div",{className:p("space-y-4",n),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>s("sampled_by"),className:p("flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-colors",i==="sampled_by"?"bg-primary text-primary-foreground":"bg-muted/50 text-muted-foreground hover:bg-muted"),children:[e.jsx(Y,{className:"w-4 h-4"}),"Sampled By (",l.length,")"]}),e.jsxs("button",{onClick:()=>s("samples_from"),className:p("flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-colors",i==="samples_from"?"bg-primary text-primary-foreground":"bg-muted/50 text-muted-foreground hover:bg-muted"),children:[e.jsx(Z,{className:"w-4 h-4"}),"Samples (",m.length,")"]})]}),e.jsx(U,{mode:"wait",children:e.jsx(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"space-y-2",children:i==="sampled_by"?l.length>0?l.map(u=>e.jsx(O,{connection:u,direction:"sampled_by"},u.id)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(g,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No known songs have sampled this track yet"})]}):m.length>0?m.map(u=>e.jsx(O,{connection:u,direction:"samples_from"},u.id)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(g,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No known samples detected in this track"})]})},i)}),(i==="sampled_by"?l:m).length>0&&e.jsxs("button",{className:"w-full py-2 text-sm text-primary hover:underline flex items-center justify-center gap-1",children:["View all on WhoSampled",e.jsx(X,{className:"w-3.5 h-3.5"})]})]})}const he=[{id:"1",user_id:"u1",display_name:"Alex M.",avatar_url:void 0,listened_at:new Date(Date.now()-5*60*1e3).toISOString(),distance_km:.5,city:"Brooklyn"},{id:"2",user_id:"u2",display_name:"Sarah K.",avatar_url:void 0,listened_at:new Date(Date.now()-15*60*1e3).toISOString(),distance_km:1.2,city:"Manhattan"},{id:"3",user_id:"u3",display_name:"Mike T.",avatar_url:void 0,listened_at:new Date(Date.now()-45*60*1e3).toISOString(),distance_km:2.8,city:"Queens"},{id:"4",user_id:"u4",display_name:"Emma L.",avatar_url:void 0,listened_at:new Date(Date.now()-2*60*60*1e3).toISOString(),distance_km:3.5,city:"Bronx"},{id:"5",user_id:"u5",display_name:"James P.",avatar_url:void 0,listened_at:new Date(Date.now()-4*60*60*1e3).toISOString(),distance_km:5.2,city:"Jersey City"}];function fe(a){return a<1?`${Math.round(a*1e3)}m away`:`${a.toFixed(1)}km away`}function Ee({entityId:a,entityType:d,className:n}){const i=he;return i.length===0?null:e.jsxs("div",{className:p("space-y-4",n),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-bold",children:"Nearby Listeners"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",i.length,")"]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 glass rounded-xl",children:[e.jsxs("div",{className:"flex -space-x-3",children:[i.slice(0,5).map((s,l)=>e.jsx(x.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:l*.1},children:e.jsxs(v,{className:"w-10 h-10 border-2 border-background",children:[e.jsx(_,{src:s.avatar_url}),e.jsx(j,{className:"text-xs bg-primary/20 text-primary",children:s.display_name[0]})]})},s.id)),i.length>5&&e.jsx("div",{className:"w-10 h-10 rounded-full bg-muted border-2 border-background flex items-center justify-center",children:e.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:["+",i.length-5]})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium",children:[i.length," ",i.length===1?"person":"people"," nearby"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"listened to this recently"})]})]}),e.jsx("div",{className:"space-y-2",children:i.map((s,l)=>e.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:l*.05},className:"flex items-center gap-3 p-3 glass rounded-xl hover:bg-muted/30 transition-colors cursor-pointer",children:[e.jsxs(v,{className:"w-10 h-10",children:[e.jsx(_,{src:s.avatar_url}),e.jsx(j,{className:"text-sm bg-primary/20 text-primary",children:s.display_name[0]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.display_name}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[s.distance_km!==void 0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(re,{className:"w-3 h-3"}),fe(s.distance_km)]}),s.city&&e.jsx("span",{children:s.city})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(ne,{className:"w-3 h-3"}),e.jsx("span",{children:N(new Date(s.listened_at),{addSuffix:!0})})]})})]},s.id))})]})}export{le as B,Te as L,Ee as N,Be as S};
