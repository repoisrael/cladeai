import{c as J,r as s,j as n,t as ve,N as Te,v as It,x as kt,G as Tt,K as Ae,E as Oe,ax as se,I as At,z as Q,H as w,D as V,F as Ot,O as Ft,ay as Lt,Q as Gt,T as Kt,U as $t,W as Ut,Y as Bt,_ as Vt,w as zt,y as Ee,i as b,a as Ht,u as Wt,s as I,B as k,m as fe}from"./index-CeBvdGEW.js";import{T as De}from"./textarea-Cwk_wuum.js";import{A as qt}from"./avatar-CCUMLOo3.js";import{B as Yt}from"./badge-CG6PNnpc.js";import{c as Fe,I as Xt,R as Zt}from"./index-kaDVCPPI.js";import{C as Jt}from"./chevron-right-6lhyndeH.js";import{C as Qt}from"./check-DOkHSHr-.js";import{M as he}from"./search-DPVAO1Be.js";import{S as en}from"./send-bW9eGos3.js";import{S as tn}from"./sparkles-DNVEt6sE.js";import{A as Pe}from"./index-DFQEX0L-.js";import{f as nn}from"./formatDistanceToNow-3UBXKcFR.js";import{H as rn}from"./heart-Bhuj_Rs_.js";import{T as on}from"./trash-2-Cg3EcgUN.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=J("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=J("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=J("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=J("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=J("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function dn(e){const r=un(e),t=s.forwardRef((o,a)=>{const{children:i,...l}=o,u=s.Children.toArray(i),f=u.find(mn);if(f){const x=f.props.children,m=u.map(c=>c===f?s.Children.count(x)>1?s.Children.only(null):s.isValidElement(x)?x.props.children:null:c);return n.jsx(r,{...l,ref:a,children:s.isValidElement(x)?s.cloneElement(x,void 0,m):null})}return n.jsx(r,{...l,ref:a,children:i})});return t.displayName=`${e}.Slot`,t}function un(e){const r=s.forwardRef((t,o)=>{const{children:a,...i}=t;if(s.isValidElement(a)){const l=hn(a),u=fn(i,a.props);return a.type!==s.Fragment&&(u.ref=o?ve(o,l):l),s.cloneElement(a,u)}return s.Children.count(a)>1?s.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var pn=Symbol("radix.slottable");function mn(e){return s.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===pn}function fn(e,r){const t={...r};for(const o in r){const a=e[o],i=r[o];/^on[A-Z]/.test(o)?a&&i?t[o]=(...u)=>{const f=i(...u);return a(...u),f}:a&&(t[o]=a):o==="style"?t[o]={...a,...i}:o==="className"&&(t[o]=[a,i].filter(Boolean).join(" "))}return{...e,...t}}function hn(e){var o,a;let r=(o=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:o.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(r=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}var xe=["Enter"," "],xn=["ArrowDown","PageUp","Home"],Le=["ArrowUp","PageDown","End"],gn=[...xn,...Le],vn={ltr:[...xe,"ArrowRight"],rtl:[...xe,"ArrowLeft"]},wn={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ee="Menu",[X,yn,Mn]=Ot(ee),[G,Ge]=Ae(ee,[Mn,Oe,Fe]),ie=Oe(),Ke=Fe(),[_n,K]=G(ee),[Cn,te]=G(ee),$e=e=>{const{__scopeMenu:r,open:t=!1,children:o,dir:a,onOpenChange:i,modal:l=!0}=e,u=ie(r),[f,x]=s.useState(null),m=s.useRef(!1),c=Te(i),h=It(a);return s.useEffect(()=>{const y=()=>{m.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>m.current=!1;return document.addEventListener("keydown",y,{capture:!0}),()=>{document.removeEventListener("keydown",y,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),n.jsx(kt,{...u,children:n.jsx(_n,{scope:r,open:t,onOpenChange:c,content:f,onContentChange:x,children:n.jsx(Cn,{scope:r,onClose:s.useCallback(()=>c(!1),[c]),isUsingKeyboardRef:m,dir:h,modal:l,children:o})})})};$e.displayName=ee;var bn="MenuAnchor",we=s.forwardRef((e,r)=>{const{__scopeMenu:t,...o}=e,a=ie(t);return n.jsx(Tt,{...a,...o,ref:r})});we.displayName=bn;var ye="MenuPortal",[Nn,Ue]=G(ye,{forceMount:void 0}),Be=e=>{const{__scopeMenu:r,forceMount:t,children:o,container:a}=e,i=K(ye,r);return n.jsx(Nn,{scope:r,forceMount:t,children:n.jsx(se,{present:t||i.open,children:n.jsx(At,{asChild:!0,container:a,children:o})})})};Be.displayName=ye;var N="MenuContent",[jn,Me]=G(N),Ve=s.forwardRef((e,r)=>{const t=Ue(N,e.__scopeMenu),{forceMount:o=t.forceMount,...a}=e,i=K(N,e.__scopeMenu),l=te(N,e.__scopeMenu);return n.jsx(X.Provider,{scope:e.__scopeMenu,children:n.jsx(se,{present:o||i.open,children:n.jsx(X.Slot,{scope:e.__scopeMenu,children:l.modal?n.jsx(Rn,{...a,ref:r}):n.jsx(Sn,{...a,ref:r})})})})}),Rn=s.forwardRef((e,r)=>{const t=K(N,e.__scopeMenu),o=s.useRef(null),a=Q(r,o);return s.useEffect(()=>{const i=o.current;if(i)return Ft(i)},[]),n.jsx(_e,{...e,ref:a,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:w(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),Sn=s.forwardRef((e,r)=>{const t=K(N,e.__scopeMenu);return n.jsx(_e,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),En=dn("MenuContent.ScrollLock"),_e=s.forwardRef((e,r)=>{const{__scopeMenu:t,loop:o=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:l,disableOutsidePointerEvents:u,onEntryFocus:f,onEscapeKeyDown:x,onPointerDownOutside:m,onFocusOutside:c,onInteractOutside:h,onDismiss:y,disableOutsideScroll:g,...j}=e,T=K(N,t),E=te(N,t),A=ie(t),D=Ke(t),z=yn(t),[de,L]=s.useState(null),$=s.useRef(null),R=Q(r,$,T.onContentChange),O=s.useRef(0),U=s.useRef(""),ue=s.useRef(0),H=s.useRef(null),ne=s.useRef("right"),W=s.useRef(0),re=g?Kt:s.Fragment,d=g?{as:En,allowPinchZoom:!0}:void 0,v=p=>{var B,Re;const _=U.current+p,S=z().filter(P=>!P.disabled),F=document.activeElement,pe=(B=S.find(P=>P.ref.current===F))==null?void 0:B.textValue,me=S.map(P=>P.textValue),je=$n(me,_,pe),q=(Re=S.find(P=>P.textValue===je))==null?void 0:Re.ref.current;(function P(Se){U.current=Se,window.clearTimeout(O.current),Se!==""&&(O.current=window.setTimeout(()=>P(""),1e3))})(_),q&&setTimeout(()=>q.focus())};s.useEffect(()=>()=>window.clearTimeout(O.current),[]),Gt();const M=s.useCallback(p=>{var S,F;return ne.current===((S=H.current)==null?void 0:S.side)&&Bn(p,(F=H.current)==null?void 0:F.area)},[]);return n.jsx(jn,{scope:t,searchRef:U,onItemEnter:s.useCallback(p=>{M(p)&&p.preventDefault()},[M]),onItemLeave:s.useCallback(p=>{var _;M(p)||((_=$.current)==null||_.focus(),L(null))},[M]),onTriggerLeave:s.useCallback(p=>{M(p)&&p.preventDefault()},[M]),pointerGraceTimerRef:ue,onPointerGraceIntentChange:s.useCallback(p=>{H.current=p},[]),children:n.jsx(re,{...d,children:n.jsx($t,{asChild:!0,trapped:a,onMountAutoFocus:w(i,p=>{var _;p.preventDefault(),(_=$.current)==null||_.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:n.jsx(Ut,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:x,onPointerDownOutside:m,onFocusOutside:c,onInteractOutside:h,onDismiss:y,children:n.jsx(Zt,{asChild:!0,...D,dir:E.dir,orientation:"vertical",loop:o,currentTabStopId:de,onCurrentTabStopIdChange:L,onEntryFocus:w(f,p=>{E.isUsingKeyboardRef.current||p.preventDefault()}),preventScrollOnEntryFocus:!0,children:n.jsx(Bt,{role:"menu","aria-orientation":"vertical","data-state":st(T.open),"data-radix-menu-content":"",dir:E.dir,...A,...j,ref:R,style:{outline:"none",...j.style},onKeyDown:w(j.onKeyDown,p=>{const S=p.target.closest("[data-radix-menu-content]")===p.currentTarget,F=p.ctrlKey||p.altKey||p.metaKey,pe=p.key.length===1;S&&(p.key==="Tab"&&p.preventDefault(),!F&&pe&&v(p.key));const me=$.current;if(p.target!==me||!gn.includes(p.key))return;p.preventDefault();const q=z().filter(B=>!B.disabled).map(B=>B.ref.current);Le.includes(p.key)&&q.reverse(),Gn(q)}),onBlur:w(e.onBlur,p=>{p.currentTarget.contains(p.target)||(window.clearTimeout(O.current),U.current="")}),onPointerMove:w(e.onPointerMove,Z(p=>{const _=p.target,S=W.current!==p.clientX;if(p.currentTarget.contains(_)&&S){const F=p.clientX>W.current?"right":"left";ne.current=F,W.current=p.clientX}}))})})})})})})});Ve.displayName=N;var Dn="MenuGroup",Ce=s.forwardRef((e,r)=>{const{__scopeMenu:t,...o}=e;return n.jsx(V.div,{role:"group",...o,ref:r})});Ce.displayName=Dn;var Pn="MenuLabel",ze=s.forwardRef((e,r)=>{const{__scopeMenu:t,...o}=e;return n.jsx(V.div,{...o,ref:r})});ze.displayName=Pn;var oe="MenuItem",ke="menu.itemSelect",ce=s.forwardRef((e,r)=>{const{disabled:t=!1,onSelect:o,...a}=e,i=s.useRef(null),l=te(oe,e.__scopeMenu),u=Me(oe,e.__scopeMenu),f=Q(r,i),x=s.useRef(!1),m=()=>{const c=i.current;if(!t&&c){const h=new CustomEvent(ke,{bubbles:!0,cancelable:!0});c.addEventListener(ke,y=>o==null?void 0:o(y),{once:!0}),Lt(c,h),h.defaultPrevented?x.current=!1:l.onClose()}};return n.jsx(He,{...a,ref:f,disabled:t,onClick:w(e.onClick,m),onPointerDown:c=>{var h;(h=e.onPointerDown)==null||h.call(e,c),x.current=!0},onPointerUp:w(e.onPointerUp,c=>{var h;x.current||(h=c.currentTarget)==null||h.click()}),onKeyDown:w(e.onKeyDown,c=>{const h=u.searchRef.current!=="";t||h&&c.key===" "||xe.includes(c.key)&&(c.currentTarget.click(),c.preventDefault())})})});ce.displayName=oe;var He=s.forwardRef((e,r)=>{const{__scopeMenu:t,disabled:o=!1,textValue:a,...i}=e,l=Me(oe,t),u=Ke(t),f=s.useRef(null),x=Q(r,f),[m,c]=s.useState(!1),[h,y]=s.useState("");return s.useEffect(()=>{const g=f.current;g&&y((g.textContent??"").trim())},[i.children]),n.jsx(X.ItemSlot,{scope:t,disabled:o,textValue:a??h,children:n.jsx(Xt,{asChild:!0,...u,focusable:!o,children:n.jsx(V.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":o||void 0,"data-disabled":o?"":void 0,...i,ref:x,onPointerMove:w(e.onPointerMove,Z(g=>{o?l.onItemLeave(g):(l.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:w(e.onPointerLeave,Z(g=>l.onItemLeave(g))),onFocus:w(e.onFocus,()=>c(!0)),onBlur:w(e.onBlur,()=>c(!1))})})})}),In="MenuCheckboxItem",We=s.forwardRef((e,r)=>{const{checked:t=!1,onCheckedChange:o,...a}=e;return n.jsx(Je,{scope:e.__scopeMenu,checked:t,children:n.jsx(ce,{role:"menuitemcheckbox","aria-checked":ae(t)?"mixed":t,...a,ref:r,"data-state":Ne(t),onSelect:w(a.onSelect,()=>o==null?void 0:o(ae(t)?!0:!t),{checkForDefaultPrevented:!1})})})});We.displayName=In;var qe="MenuRadioGroup",[kn,Tn]=G(qe,{value:void 0,onValueChange:()=>{}}),Ye=s.forwardRef((e,r)=>{const{value:t,onValueChange:o,...a}=e,i=Te(o);return n.jsx(kn,{scope:e.__scopeMenu,value:t,onValueChange:i,children:n.jsx(Ce,{...a,ref:r})})});Ye.displayName=qe;var Xe="MenuRadioItem",Ze=s.forwardRef((e,r)=>{const{value:t,...o}=e,a=Tn(Xe,e.__scopeMenu),i=t===a.value;return n.jsx(Je,{scope:e.__scopeMenu,checked:i,children:n.jsx(ce,{role:"menuitemradio","aria-checked":i,...o,ref:r,"data-state":Ne(i),onSelect:w(o.onSelect,()=>{var l;return(l=a.onValueChange)==null?void 0:l.call(a,t)},{checkForDefaultPrevented:!1})})})});Ze.displayName=Xe;var be="MenuItemIndicator",[Je,An]=G(be,{checked:!1}),Qe=s.forwardRef((e,r)=>{const{__scopeMenu:t,forceMount:o,...a}=e,i=An(be,t);return n.jsx(se,{present:o||ae(i.checked)||i.checked===!0,children:n.jsx(V.span,{...a,ref:r,"data-state":Ne(i.checked)})})});Qe.displayName=be;var On="MenuSeparator",et=s.forwardRef((e,r)=>{const{__scopeMenu:t,...o}=e;return n.jsx(V.div,{role:"separator","aria-orientation":"horizontal",...o,ref:r})});et.displayName=On;var Fn="MenuArrow",tt=s.forwardRef((e,r)=>{const{__scopeMenu:t,...o}=e,a=ie(t);return n.jsx(Vt,{...a,...o,ref:r})});tt.displayName=Fn;var Ln="MenuSub",[Wr,nt]=G(Ln),Y="MenuSubTrigger",rt=s.forwardRef((e,r)=>{const t=K(Y,e.__scopeMenu),o=te(Y,e.__scopeMenu),a=nt(Y,e.__scopeMenu),i=Me(Y,e.__scopeMenu),l=s.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:f}=i,x={__scopeMenu:e.__scopeMenu},m=s.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return s.useEffect(()=>m,[m]),s.useEffect(()=>{const c=u.current;return()=>{window.clearTimeout(c),f(null)}},[u,f]),n.jsx(we,{asChild:!0,...x,children:n.jsx(He,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":a.contentId,"data-state":st(t.open),...e,ref:ve(r,a.onTriggerChange),onClick:c=>{var h;(h=e.onClick)==null||h.call(e,c),!(e.disabled||c.defaultPrevented)&&(c.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:w(e.onPointerMove,Z(c=>{i.onItemEnter(c),!c.defaultPrevented&&!e.disabled&&!t.open&&!l.current&&(i.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{t.onOpenChange(!0),m()},100))})),onPointerLeave:w(e.onPointerLeave,Z(c=>{var y,g;m();const h=(y=t.content)==null?void 0:y.getBoundingClientRect();if(h){const j=(g=t.content)==null?void 0:g.dataset.side,T=j==="right",E=T?-5:5,A=h[T?"left":"right"],D=h[T?"right":"left"];i.onPointerGraceIntentChange({area:[{x:c.clientX+E,y:c.clientY},{x:A,y:h.top},{x:D,y:h.top},{x:D,y:h.bottom},{x:A,y:h.bottom}],side:j}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(c),c.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:w(e.onKeyDown,c=>{var y;const h=i.searchRef.current!=="";e.disabled||h&&c.key===" "||vn[o.dir].includes(c.key)&&(t.onOpenChange(!0),(y=t.content)==null||y.focus(),c.preventDefault())})})})});rt.displayName=Y;var ot="MenuSubContent",at=s.forwardRef((e,r)=>{const t=Ue(N,e.__scopeMenu),{forceMount:o=t.forceMount,...a}=e,i=K(N,e.__scopeMenu),l=te(N,e.__scopeMenu),u=nt(ot,e.__scopeMenu),f=s.useRef(null),x=Q(r,f);return n.jsx(X.Provider,{scope:e.__scopeMenu,children:n.jsx(se,{present:o||i.open,children:n.jsx(X.Slot,{scope:e.__scopeMenu,children:n.jsx(_e,{id:u.contentId,"aria-labelledby":u.triggerId,...a,ref:x,align:"start",side:l.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{var c;l.isUsingKeyboardRef.current&&((c=f.current)==null||c.focus()),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:w(e.onFocusOutside,m=>{m.target!==u.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:w(e.onEscapeKeyDown,m=>{l.onClose(),m.preventDefault()}),onKeyDown:w(e.onKeyDown,m=>{var y;const c=m.currentTarget.contains(m.target),h=wn[l.dir].includes(m.key);c&&h&&(i.onOpenChange(!1),(y=u.trigger)==null||y.focus(),m.preventDefault())})})})})})});at.displayName=ot;function st(e){return e?"open":"closed"}function ae(e){return e==="indeterminate"}function Ne(e){return ae(e)?"indeterminate":e?"checked":"unchecked"}function Gn(e){const r=document.activeElement;for(const t of e)if(t===r||(t.focus(),document.activeElement!==r))return}function Kn(e,r){return e.map((t,o)=>e[(r+o)%e.length])}function $n(e,r,t){const a=r.length>1&&Array.from(r).every(x=>x===r[0])?r[0]:r,i=t?e.indexOf(t):-1;let l=Kn(e,Math.max(i,0));a.length===1&&(l=l.filter(x=>x!==t));const f=l.find(x=>x.toLowerCase().startsWith(a.toLowerCase()));return f!==t?f:void 0}function Un(e,r){const{x:t,y:o}=e;let a=!1;for(let i=0,l=r.length-1;i<r.length;l=i++){const u=r[i],f=r[l],x=u.x,m=u.y,c=f.x,h=f.y;m>o!=h>o&&t<(c-x)*(o-m)/(h-m)+x&&(a=!a)}return a}function Bn(e,r){if(!r)return!1;const t={x:e.clientX,y:e.clientY};return Un(t,r)}function Z(e){return r=>r.pointerType==="mouse"?e(r):void 0}var Vn=$e,zn=we,Hn=Be,Wn=Ve,qn=Ce,Yn=ze,Xn=ce,Zn=We,Jn=Ye,Qn=Ze,er=Qe,tr=et,nr=tt,rr=rt,or=at,le="DropdownMenu",[ar]=Ae(le,[Ge]),C=Ge(),[sr,it]=ar(le),ct=e=>{const{__scopeDropdownMenu:r,children:t,dir:o,open:a,defaultOpen:i,onOpenChange:l,modal:u=!0}=e,f=C(r),x=s.useRef(null),[m,c]=zt({prop:a,defaultProp:i??!1,onChange:l,caller:le});return n.jsx(sr,{scope:r,triggerId:Ee(),triggerRef:x,contentId:Ee(),open:m,onOpenChange:c,onOpenToggle:s.useCallback(()=>c(h=>!h),[c]),modal:u,children:n.jsx(Vn,{...f,open:m,onOpenChange:c,dir:o,modal:u,children:t})})};ct.displayName=le;var lt="DropdownMenuTrigger",dt=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,disabled:o=!1,...a}=e,i=it(lt,t),l=C(t);return n.jsx(zn,{asChild:!0,...l,children:n.jsx(V.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":o?"":void 0,disabled:o,...a,ref:ve(r,i.triggerRef),onPointerDown:w(e.onPointerDown,u=>{!o&&u.button===0&&u.ctrlKey===!1&&(i.onOpenToggle(),i.open||u.preventDefault())}),onKeyDown:w(e.onKeyDown,u=>{o||(["Enter"," "].includes(u.key)&&i.onOpenToggle(),u.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});dt.displayName=lt;var ir="DropdownMenuPortal",ut=e=>{const{__scopeDropdownMenu:r,...t}=e,o=C(r);return n.jsx(Hn,{...o,...t})};ut.displayName=ir;var pt="DropdownMenuContent",mt=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=it(pt,t),i=C(t),l=s.useRef(!1);return n.jsx(Wn,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...o,ref:r,onCloseAutoFocus:w(e.onCloseAutoFocus,u=>{var f;l.current||(f=a.triggerRef.current)==null||f.focus(),l.current=!1,u.preventDefault()}),onInteractOutside:w(e.onInteractOutside,u=>{const f=u.detail.originalEvent,x=f.button===0&&f.ctrlKey===!0,m=f.button===2||x;(!a.modal||m)&&(l.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mt.displayName=pt;var cr="DropdownMenuGroup",lr=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(qn,{...a,...o,ref:r})});lr.displayName=cr;var dr="DropdownMenuLabel",ft=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(Yn,{...a,...o,ref:r})});ft.displayName=dr;var ur="DropdownMenuItem",ht=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(Xn,{...a,...o,ref:r})});ht.displayName=ur;var pr="DropdownMenuCheckboxItem",xt=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(Zn,{...a,...o,ref:r})});xt.displayName=pr;var mr="DropdownMenuRadioGroup",fr=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(Jn,{...a,...o,ref:r})});fr.displayName=mr;var hr="DropdownMenuRadioItem",gt=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(Qn,{...a,...o,ref:r})});gt.displayName=hr;var xr="DropdownMenuItemIndicator",vt=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(er,{...a,...o,ref:r})});vt.displayName=xr;var gr="DropdownMenuSeparator",wt=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(tr,{...a,...o,ref:r})});wt.displayName=gr;var vr="DropdownMenuArrow",wr=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(nr,{...a,...o,ref:r})});wr.displayName=vr;var yr="DropdownMenuSubTrigger",yt=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(rr,{...a,...o,ref:r})});yt.displayName=yr;var Mr="DropdownMenuSubContent",Mt=s.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...o}=e,a=C(t);return n.jsx(or,{...a,...o,ref:r,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Mt.displayName=Mr;var _r=ct,Cr=dt,br=ut,_t=mt,Ct=ft,bt=ht,Nt=xt,jt=gt,Rt=vt,St=wt,Et=yt,Dt=Mt;const Nr=_r,jr=Cr,Rr=s.forwardRef(({className:e,inset:r,children:t,...o},a)=>n.jsxs(Et,{ref:a,className:b("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",r&&"pl-8",e),...o,children:[t,n.jsx(Jt,{className:"ml-auto h-4 w-4"})]}));Rr.displayName=Et.displayName;const Sr=s.forwardRef(({className:e,...r},t)=>n.jsx(Dt,{ref:t,className:b("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));Sr.displayName=Dt.displayName;const Pt=s.forwardRef(({className:e,sideOffset:r=4,...t},o)=>n.jsx(br,{children:n.jsx(_t,{ref:o,sideOffset:r,className:b("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})}));Pt.displayName=_t.displayName;const ge=s.forwardRef(({className:e,inset:r,...t},o)=>n.jsx(bt,{ref:o,className:b("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",r&&"pl-8",e),...t}));ge.displayName=bt.displayName;const Er=s.forwardRef(({className:e,children:r,checked:t,...o},a)=>n.jsxs(Nt,{ref:a,className:b("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:t,...o,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(Rt,{children:n.jsx(Qt,{className:"h-4 w-4"})})}),r]}));Er.displayName=Nt.displayName;const Dr=s.forwardRef(({className:e,children:r,...t},o)=>n.jsxs(jt,{ref:o,className:b("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...t,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(Rt,{children:n.jsx(an,{className:"h-2 w-2 fill-current"})})}),r]}));Dr.displayName=jt.displayName;const Pr=s.forwardRef(({className:e,inset:r,...t},o)=>n.jsx(Ct,{ref:o,className:b("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",e),...t}));Pr.displayName=Ct.displayName;const Ir=s.forwardRef(({className:e,...r},t)=>n.jsx(St,{ref:t,className:b("-mx-1 my-1 h-px bg-muted",e),...r}));Ir.displayName=St.displayName;function qr({trackId:e,className:r=""}){const{user:t,guestMode:o}=Ht(),a=Wt(),i=typeof window<"u"&&window.location.hostname.endsWith("github.io"),[l,u]=s.useState([]),[f,x]=s.useState(""),[m,c]=s.useState(!1),[h,y]=s.useState(!0),[g,j]=s.useState(null),[T,E]=s.useState(null),[A,D]=s.useState(""),[z,de]=s.useState({}),[L,$]=s.useState({});s.useEffect(()=>{if(i){y(!1);return}e&&(R(),U())},[e,i]);const R=async()=>{if(i){u([]),y(!1);return}y(!0);try{const{data:d,error:v}=await I.from("track_comments").select("*").eq("track_id",e).order("created_at",{ascending:!0}).limit(50);if(v){console.warn("[TrackComments] skipping comments fetch due to schema error",v),u([]);return}u(d||[])}catch(d){console.error("Error loading comments:",d)}finally{y(!1)}},O=async d=>{try{const{data:v,error:M}=await I.rpc("get_comment_replies",{p_comment_id:d});if(M)throw M;de(p=>({...p,[d]:v||[]})),$(p=>({...p,[d]:!0}))}catch(v){console.error("Error loading replies:",v)}},U=()=>{const d=I.channel(`track-comments:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"track_comments",filter:`track_id=eq.${e}`},()=>{R()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"track_comments",filter:`track_id=eq.${e}`},()=>{R()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"track_comments",filter:`track_id=eq.${e}`},()=>{R()}).subscribe();return()=>{I.removeChannel(d)}},ue=async d=>{if(d.preventDefault(),!(!f.trim()||!t||m)){c(!0);try{const{error:v}=await I.from("track_comments").insert({track_id:e,user_id:t.id,comment:f.trim(),reply_to:(g==null?void 0:g.id)||null});if(v)throw v;x(""),j(null),g?await O(g.id):await R()}catch(v){console.error("Error posting comment:",v)}finally{c(!1)}}},H=async(d,v)=>{if(t)try{v?await I.from("track_comment_likes").delete().eq("comment_id",d).eq("user_id",t.id):await I.from("track_comment_likes").insert({comment_id:d,user_id:t.id}),await R(),Object.keys(L).forEach(M=>{L[M]&&O(M)})}catch(M){console.error("Error toggling like:",M)}},ne=async d=>{if(A.trim())try{const{error:v}=await I.from("track_comments").update({comment:A.trim(),edited_at:new Date().toISOString()}).eq("id",d);if(v)throw v;E(null),D(""),await R()}catch(v){console.error("Error editing comment:",v)}},W=async d=>{if(confirm("Delete this comment?"))try{const{error:v}=await I.from("track_comments").delete().eq("id",d);if(v)throw v;await R()}catch(v){console.error("Error deleting comment:",v)}},re=(d,v=!1)=>{var M,p;return n.jsxs(fe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:b("space-y-2",v&&"ml-12"),children:[n.jsxs("div",{className:"flex gap-3",children:[n.jsx(qt,{className:"w-10 h-10 flex-shrink-0",children:d.user_avatar_url?n.jsx("img",{src:d.user_avatar_url,alt:""}):n.jsx("div",{className:"w-full h-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-sm font-semibold",children:((p=(M=d.user_display_name)==null?void 0:M[0])==null?void 0:p.toUpperCase())||"?"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-medium text-sm",children:d.user_display_name||"Anonymous"}),n.jsx("span",{className:"text-xs text-muted-foreground",children:nn(new Date(d.created_at),{addSuffix:!0})}),d.edited_at&&n.jsx("span",{className:"text-xs text-muted-foreground",children:"(edited)"})]}),T===d.id?n.jsxs("div",{className:"space-y-2",children:[n.jsx(De,{value:A,onChange:_=>D(_.target.value),className:"min-h-[60px]",maxLength:2e3}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(k,{size:"sm",onClick:()=>ne(d.id),children:"Save"}),n.jsx(k,{size:"sm",variant:"ghost",onClick:()=>{E(null),D("")},children:"Cancel"})]})]}):n.jsx("p",{className:"text-sm break-words whitespace-pre-wrap",children:d.comment}),n.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[n.jsxs(k,{variant:"ghost",size:"sm",className:b("h-8 gap-1.5 text-xs",d.user_liked&&"text-red-500 hover:text-red-600"),onClick:()=>H(d.id,d.user_liked),children:[n.jsx(rn,{className:b("w-4 h-4",d.user_liked&&"fill-current")}),d.likes_count>0&&d.likes_count]}),!v&&n.jsxs(k,{variant:"ghost",size:"sm",className:"h-8 gap-1.5 text-xs",onClick:()=>j(d),children:[n.jsx(Ie,{className:"w-4 h-4"}),"Reply"]}),(t==null?void 0:t.id)===d.user_id&&n.jsxs(Nr,{children:[n.jsx(jr,{asChild:!0,children:n.jsx(k,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:n.jsx(sn,{className:"w-4 h-4"})})}),n.jsxs(Pt,{align:"end",children:[n.jsxs(ge,{onClick:()=>{E(d.id),D(d.comment)},children:[n.jsx(cn,{className:"w-4 h-4 mr-2"}),"Edit"]}),n.jsxs(ge,{className:"text-red-600",onClick:()=>W(d.id),children:[n.jsx(on,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),!v&&!L[d.id]&&n.jsx(k,{variant:"ghost",size:"sm",className:"h-8 text-xs mt-2",onClick:()=>O(d.id),children:"View replies"})]})]}),n.jsx(Pe,{children:L[d.id]&&z[d.id]&&n.jsx(fe.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"space-y-3 mt-3",children:z[d.id].map(_=>re(_,!0))})})]},d.id)};return n.jsxs("div",{className:b("space-y-6",r),children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(he,{className:"w-5 h-5"}),n.jsx("h3",{className:"text-lg font-semibold",children:"Comments"}),n.jsx(Yt,{variant:"secondary",children:l.length})]}),t?n.jsxs("form",{onSubmit:ue,className:"space-y-3",children:[g&&n.jsxs("div",{className:"p-3 bg-muted rounded-lg flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm text-muted-foreground",children:[n.jsx(Ie,{className:"w-3 h-3 inline mr-1"}),"Replying to ",g.user_display_name]}),n.jsx(k,{type:"button",variant:"ghost",size:"sm",onClick:()=>j(null),children:"Cancel"})]}),n.jsx(De,{placeholder:"Share your thoughts about this track...",value:f,onChange:d=>x(d.target.value),className:"min-h-[100px] resize-none",maxLength:2e3}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("span",{className:"text-xs text-muted-foreground",children:[f.length,"/2000"]}),n.jsxs(k,{type:"submit",disabled:!f.trim()||m,children:[n.jsx(en,{className:"w-4 h-4 mr-2"}),m?"Posting...":g?"Reply":"Post Comment"]})]})]}):n.jsxs(fe.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"relative overflow-hidden rounded-xl border-2 border-dashed border-border/50 bg-gradient-to-br from-background via-background to-muted/20 p-8 text-center",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#00F5FF]/5 via-[#FF00FF]/5 to-[#00F5FF]/5 animate-pulse"}),n.jsxs("div",{className:"relative z-10",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-[#00F5FF] to-[#FF00FF] mb-4",children:n.jsx(he,{className:"w-8 h-8 text-white"})}),n.jsxs("h4",{className:"text-lg font-semibold mb-2 flex items-center justify-center gap-2",children:["Join the Conversation",n.jsx(tn,{className:"w-4 h-4 text-[#FF00FF]"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-md mx-auto",children:"Sign up to share your thoughts, reply to others, and connect with music lovers who get it"}),n.jsxs(k,{size:"lg",onClick:()=>a("/auth"),className:"bg-gradient-to-r from-[#00F5FF] to-[#FF00FF] hover:opacity-90 transition-opacity shadow-lg shadow-[#00F5FF]/20",children:[n.jsx(ln,{className:"w-5 h-5 mr-2"}),"Sign Up to Comment"]}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-4",children:["Already have an account?"," ",n.jsx("button",{onClick:()=>a("/auth"),className:"text-[#00F5FF] hover:underline font-medium",children:"Sign in"})]})]})]}),n.jsx("div",{className:"space-y-6",children:h?n.jsx("div",{className:"text-center py-8",children:n.jsx("div",{className:"inline-block w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"})}):l.length===0?n.jsxs("div",{className:"text-center py-8",children:[n.jsx(he,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground opacity-50"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"No comments yet. Be the first to share your thoughts!"})]}):n.jsx(Pe,{children:l.map(d=>re(d))})})]})}export{Nr as D,sn as E,cn as P,qr as T,ln as U,jr as a,Pt as b,ge as c,Ir as d};
