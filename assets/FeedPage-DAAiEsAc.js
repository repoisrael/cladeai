import{j as e,m as M,b as V,a as Y,r as x,s as N,B as v,X as G,u as K,d as Q,C as Z,e as ee}from"./index-c329HF_1.js";import{T as se}from"./TrackCard-BVDtLIjm.js";import{M as te}from"./music-2-BcfYlxUr.js";import{T as ae}from"./trending-up-BlffUzxi.js";import{C as ne}from"./clock-N3nql8dK.js";import{I as re}from"./input-BJ4xkDAq.js";import{S as ie}from"./scroll-area-D5ZK86WI.js";import{A as oe}from"./avatar-CYv5D5kH.js";import{B as le}from"./badge-BA5s1yNZ.js";import{U}from"./users-Cm8MYJHk.js";import{A as X}from"./index-D7xJxKgH.js";import{R as $,U as ce}from"./TrackComments-LQIXCVWr.js";import{S as de}from"./send-BGxLnG_1.js";import{f as me}from"./formatDistanceToNow-3UBXKcFR.js";import{u as xe,S as ue}from"./useTracks-DtAlFu4J.js";import{B as A}from"./BottomNav-C7zBnHcu.js";import{S as he}from"./sparkles-CZyxbzdI.js";import{u as fe,R as q,D as pe}from"./useSpotifyUser-Cygkuqjm.js";import{u as ge}from"./useTasteDNA-Bd0RqdmT.js";import{C as je}from"./circle-alert-CcAQqgvQ.js";import{M as ye}from"./music-CMPAeTdu.js";import{L as Ne}from"./log-in-DQSSCOtP.js";import"./ChordBadge-BAZ4S6be.js";import"./rotate-ccw-D15SLOrf.js";import"./switch-d0VEYaTe.js";import"./index-Bnn9L8d2.js";import"./Combination-NfQ5RBhx.js";import"./index-YKlYwKWt.js";import"./useFollowing-B6Rr8OWQ.js";import"./index-BdQq_4o_.js";import"./index-Tos3mqeW.js";import"./useMutation-D798oNfM.js";import"./label-Cc2e1r2g.js";import"./map-pin-BPMMvOOp.js";import"./radio-C-kp7DPq.js";import"./share-2-TdaFdxIY.js";import"./check-Zdd17R-I.js";import"./twitter-BbATbpf0.js";import"./QuickStreamButtons-D2HsXWDl.js";import"./providers-CHelMshW.js";import"./timeFormat-BXo_t6_Q.js";import"./CladeIcon-CxCXJW6a.js";import"./heart-DvPh-FzJ.js";import"./waves-BGHSM7lK.js";import"./bookmark-B6MPdxC2.js";import"./search-DtZ2HCsW.js";import"./textarea-DxZyr71o.js";import"./index-DIjJgEKO.js";import"./chevron-right-5l7v9NNQ.js";import"./trash-2-XclxO6rO.js";import"./en-US-wfBU2YNu.js";import"./seedTracks-B22TRa5Y.js";import"./youtubeSearchService-lZc7ageC.js";function ve(){return e.jsxs("div",{className:"relative w-full h-full flex flex-col",children:[e.jsx("div",{className:"absolute inset-0 z-0",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-secondary to-background animate-shimmer"})}),e.jsxs("div",{className:"relative z-10 flex-1 flex flex-col justify-end p-6 pb-8 space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},className:"h-8 w-3/4 bg-muted/50 rounded-lg animate-shimmer"}),e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.05},className:"h-6 w-1/2 bg-muted/50 rounded-lg animate-shimmer"})]}),e.jsx("div",{className:"h-12 w-36 bg-muted/50 rounded-xl animate-shimmer"}),e.jsxs("div",{className:"glass-strong rounded-2xl p-4 space-y-3",children:[e.jsx("div",{className:"h-4 w-24 bg-muted/50 rounded animate-shimmer"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4].map(s=>e.jsx("div",{className:"h-8 w-12 bg-muted/50 rounded-lg animate-shimmer",style:{animationDelay:`${s*100}ms`}},s))})]}),e.jsx("div",{className:"flex items-center justify-between pt-4",children:[1,2,3,4,5].map(s=>e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-12 h-12 bg-muted/50 rounded-full animate-shimmer"}),e.jsx("div",{className:"w-10 h-3 bg-muted/50 rounded animate-shimmer"})]},s))})]})]})}function R({children:s,hover:i=!0,padding:o="md",rounded:l="xl",className:m,...t}){const u={sm:"p-2",md:"p-3",lg:"p-4"},_={md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl","2xl":"rounded-2xl"};return e.jsx("div",{className:V("glass",_[l],u[o],i&&"hover:bg-muted/30 transition-colors",m),...t,children:s})}function be({currentTrack:s,trackIndex:i,totalTracks:o}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx(R,{padding:"lg",rounded:"2xl",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Your Feed"}),e.jsxs("span",{className:"text-2xl font-bold gradient-text",children:[i+1,"/",o]})]}),e.jsx("div",{className:"h-2 bg-muted/30 rounded-full overflow-hidden",children:e.jsx(M.div,{className:"h-full bg-gradient-to-r from-primary to-accent",initial:{width:0},animate:{width:`${(i+1)/o*100}%`},transition:{duration:.3}})})]})}),s&&e.jsx(R,{padding:"lg",rounded:"2xl",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("h3",{className:"text-sm font-medium",children:"Now Playing"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg line-clamp-2",children:s.title}),s.artist&&e.jsx("p",{className:"text-muted-foreground line-clamp-1",children:s.artist})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t border-border/50",children:[s.detected_key&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Key"}),e.jsxs("span",{className:"font-medium",children:[s.detected_key," ",s.detected_mode]})]}),s.tempo&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"BPM"}),e.jsx("span",{className:"font-medium",children:Math.round(s.tempo)})]}),s.genre&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Genre"}),e.jsx("span",{className:"font-medium capitalize",children:s.genre})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(R,{padding:"md",rounded:"xl",hover:!1,className:"text-center",children:[e.jsx(ae,{className:"w-5 h-5 text-primary mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Trending"})]}),e.jsxs(R,{padding:"md",rounded:"xl",hover:!1,className:"text-center",children:[e.jsx(ne,{className:"w-5 h-5 text-accent mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Recent"})]})]}),e.jsxs(R,{padding:"md",rounded:"xl",hover:!1,children:[e.jsx("h3",{className:"text-xs font-medium text-muted-foreground mb-3",children:"Keyboard Shortcuts"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Next track"}),e.jsx("kbd",{className:"px-2 py-1 rounded bg-muted/50 font-mono",children:"↓ or J"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Previous track"}),e.jsx("kbd",{className:"px-2 py-1 rounded bg-muted/50 font-mono",children:"↑ or K"})]})]})]})]})}function we({roomId:s="global",roomType:i="global",trackId:o,className:l=""}){var I;const m=typeof window<"u"&&window.location.hostname.endsWith("github.io"),{user:t}=Y(),[u,_]=x.useState([]),[y,S]=x.useState(""),[b,p]=x.useState(!0),[L,h]=x.useState([]),[w,T]=x.useState(null),z=x.useRef(null),E=x.useRef(null);if(m)return null;x.useEffect(()=>{if(!t)return;(async()=>{try{if(i==="global"){F("global");return}if(i==="track"&&o){const{data:r}=await N.from("chat_rooms").select("id").eq("type","track").eq("track_id",o).single();if(r)F(r.id);else{const{data:c}=await N.from("chat_rooms").insert({name:"Track Chat",type:"track",track_id:o}).select("id").single();c&&F(c.id)}}}catch(r){console.error("Error initializing chat room:",r)}})()},[t,i,o]);const F=async a=>{p(!0);try{const{data:r,error:c}=await N.from("chat_messages").select(`
          id,
          user_id,
          message,
          created_at,
          reply_to,
          user:profiles!chat_messages_user_id_fkey (
            id,
            display_name,
            avatar_url
          )
        `).eq("room_id",a).order("created_at",{ascending:!0}).limit(100);if(c)throw c;_(r||[]),C()}catch(r){console.error("Error loading messages:",r)}finally{p(!1)}};x.useEffect(()=>{if(!t)return;const a=N.channel(`chat:${s}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`room_id=eq.${s}`},async r=>{const{data:c}=await N.from("profiles").select("id, display_name, avatar_url").eq("id",r.new.user_id).single();_(n=>[...n,{...r.new,user:c}]),C()}).subscribe();return()=>{N.removeChannel(a)}},[t,s]),x.useEffect(()=>{if(!t)return;const a=N.channel("online-users",{config:{presence:{key:t.id}}});return a.on("presence",{event:"sync"},()=>{const r=a.presenceState(),c=Object.values(r).flat();h(c)}).subscribe(async r=>{r==="SUBSCRIBED"&&await a.track({user_id:t.id,status:"online",online_at:new Date().toISOString()})}),()=>{N.removeChannel(a)}},[t]),x.useEffect(()=>{if(!t)return;const a=async r=>{await N.from("user_presence").upsert({user_id:t.id,status:r,current_track_id:o,last_seen:new Date().toISOString()})};return a("online"),()=>{a("offline")}},[t,o]);const C=()=>{setTimeout(()=>{var a;(a=z.current)==null||a.scrollIntoView({behavior:"smooth"})},100)},D=async a=>{var r;if(a.preventDefault(),!(!y.trim()||!t))try{const{error:c}=await N.from("chat_messages").insert({room_id:s,user_id:t.id,message:y.trim(),reply_to:(w==null?void 0:w.id)||null});if(c)throw c;S(""),T(null),(r=E.current)==null||r.focus()}catch(c){console.error("Error sending message:",c)}};return t?e.jsxs("div",{className:`flex flex-col glass rounded-xl overflow-hidden ${l}`,children:[e.jsx("div",{className:"p-4 border-b flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),e.jsx("h3",{className:"font-semibold",children:i==="global"?"Global Chat":"Track Chat"}),e.jsxs(le,{variant:"secondary",className:"text-xs",children:[L.length," online"]})]})}),e.jsx(ie,{className:"flex-1 p-4 h-[400px]",children:b?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"inline-block w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"})}):u.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(U,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground opacity-50"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No messages yet. Start the conversation!"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx(X,{initial:!1,children:u.map(a=>{var r,c,n,d,f;return e.jsxs(M.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`flex gap-3 ${a.user_id===t.id?"flex-row-reverse":""}`,children:[e.jsx(oe,{className:"w-8 h-8 flex-shrink-0",children:(r=a.user)!=null&&r.avatar_url?e.jsx("img",{src:a.user.avatar_url,alt:""}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-xs font-semibold",children:((d=(n=(c=a.user)==null?void 0:c.display_name)==null?void 0:n[0])==null?void 0:d.toUpperCase())||"?"})}),e.jsxs("div",{className:`flex-1 min-w-0 ${a.user_id===t.id?"text-right":""}`,children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium truncate",children:((f=a.user)==null?void 0:f.display_name)||"Anonymous"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:me(new Date(a.created_at),{addSuffix:!0})})]}),a.reply_to&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-1 opacity-70",children:[e.jsx($,{className:"w-3 h-3 inline mr-1"}),"Replying to message"]}),e.jsx("div",{className:`inline-block px-3 py-2 rounded-lg max-w-[80%] break-words ${a.user_id===t.id?"bg-primary text-primary-foreground":"bg-muted"}`,children:e.jsx("p",{className:"text-sm",children:a.message})}),a.user_id!==t.id&&e.jsxs(v,{variant:"ghost",size:"sm",className:"h-6 text-xs mt-1 opacity-0 hover:opacity-100 transition-opacity",onClick:()=>T(a),children:[e.jsx($,{className:"w-3 h-3 mr-1"}),"Reply"]})]})]},a.id)})}),e.jsx("div",{ref:z})]})}),e.jsxs("div",{className:"p-4 border-t",children:[w&&e.jsxs("div",{className:"mb-2 p-2 bg-muted rounded-lg flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx($,{className:"w-3 h-3 inline mr-1"}),"Replying to ",(I=w.user)==null?void 0:I.display_name]}),e.jsx(v,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>T(null),children:e.jsx(G,{className:"w-3 h-3"})})]}),e.jsxs("form",{onSubmit:D,className:"flex gap-2",children:[e.jsx(re,{ref:E,placeholder:"Type a message...",value:y,onChange:a=>S(a.target.value),className:"flex-1",maxLength:500}),e.jsx(v,{type:"submit",size:"icon",disabled:!y.trim(),children:e.jsx(de,{className:"w-4 h-4"})})]})]})]}):e.jsxs("div",{className:`glass rounded-xl p-6 text-center ${l}`,children:[e.jsx(U,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sign in to chat with other music lovers"})]})}function _e(){const{guestMode:s,user:i}=Y(),o=K(),[l,m]=x.useState(()=>{const y=localStorage.getItem("clade_guest_banner_dismissed");if(!y)return!1;const S=parseInt(y,10),b=24*60*60*1e3;return Date.now()-S<b}),t=s&&!i&&!l,u=()=>{m(!0),localStorage.setItem("clade_guest_banner_dismissed",Date.now().toString())},_=()=>{o("/auth")};return e.jsx(X,{children:t&&e.jsxs(M.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{type:"spring",damping:20,stiffness:300},className:"fixed bottom-0 left-0 right-0 z-50 safe-bottom",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[e.jsx("div",{className:"absolute inset-0 bg-background/95 backdrop-blur-xl border-t border-border/50"}),e.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 py-4 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 rounded-full bg-gradient-to-br from-[#00F5FF] to-[#FF00FF]",children:e.jsx(he,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground mb-0.5",children:"Join the Conversation"}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:"Sign up to comment, like, and connect with music lovers"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(v,{size:"sm",onClick:_,className:"bg-gradient-to-r from-[#00F5FF] to-[#FF00FF] hover:opacity-90 transition-opacity shadow-lg shadow-[#00F5FF]/20",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Sign Up"}),e.jsx("span",{className:"sm:hidden",children:"Join"})]}),e.jsx(v,{size:"sm",variant:"ghost",onClick:u,className:"text-muted-foreground hover:text-foreground",children:e.jsx(G,{className:"w-4 h-4"})})]})]})]})})}function Se(s,i){if(!i)return{track:s,score:.5,reasons:["New user - exploring catalog"]};let o=0;const l=[];if(s.progression_roman&&i.favoriteProgressions.length>0){const m=s.progression_roman.join("→"),t=i.favoriteProgressions.find(u=>u.progression.join("→")===m);if(t){const u=.4*(t.count/i.totalTracksAnalyzed);o+=u,l.push(`Matches your favorite progression: ${t.progression.join("-")}`)}}if(s.detected_mode&&i.preferredModes.length>0){const m=i.preferredModes.find(t=>t.mode===s.detected_mode);if(m){const t=.2*(m.percentage/100);o+=t,l.push(`${s.detected_mode} mode (${Math.round(m.percentage)}% of your taste)`)}}if(typeof s.energy=="number"&&typeof i.energyPreference=="number"){const m=Math.abs(s.energy-i.energyPreference),t=.2*(1-m);o+=t,m<.2?l.push("Perfect energy match"):m<.4&&l.push("Good energy match")}if(typeof s.tempo=="number"&&typeof i.averageTempo=="number"){const m=Math.abs(s.tempo-i.averageTempo),t=.2*Math.max(0,1-m/100);o+=t,m<15&&l.push("Similar tempo to your favorites")}return o=Math.max(0,Math.min(1,o)),l.length===0&&l.push("Recommended for you"),{track:s,score:o,reasons:l}}function ke(s,i,o){const l=s.map(t=>Se(t,i));return l.sort((t,u)=>u.score-t.score),l.map(t=>t.track)}function ks(){const{user:s,loading:i}=Y(),o=K(),{data:l,isLoading:m,error:t}=xe(50),{data:u,isLoading:_}=fe(20),{data:y}=ge(),S=(l==null?void 0:l.tracks)??[],b=(u==null?void 0:u.tracks)??[],p=(()=>{let n;if(b.length>0){const d=new Set(b.map(j=>j.spotify_id).filter(Boolean)),f=new Set(b.map(j=>j.id).filter(Boolean)),g=S.filter(j=>!d.has(j.spotify_id)&&!f.has(j.id));n=[...b,...g]}else{const d=new Set;n=S.filter(f=>{const g=f.spotify_id||f.id;return d.has(g)?!1:(d.add(g),!0)})}return s&&y?ke(n,y):n})(),L=b.length>0?"spotify":l==null?void 0:l.source,[h,w]=x.useState(0),[T,z]=x.useState(new Map),E=x.useRef(null),[F,C]=x.useState(!s),{openPlayer:D}=Q();x.useEffect(()=>{s&&C(!1)},[s]);const I=n=>{var f;if(!s){C(!0);return}const d=(f=p[h])==null?void 0:f.id;d&&(z(g=>{const j=new Map(g),k=new Set(g.get(d)||[]);return k.has(n)?k.delete(n):k.add(n),j.set(d,k),j}),n==="skip"&&h<p.length-1&&w(g=>g+1))},a=x.useCallback(()=>{h<p.length-1&&w(n=>n+1)},[h,p.length]),r=x.useCallback(()=>{h>0&&w(n=>n-1)},[h]);if(x.useEffect(()=>{const n=d=>{d.target instanceof HTMLInputElement||d.target instanceof HTMLTextAreaElement||(d.key==="ArrowDown"||d.key==="j"?a():(d.key==="ArrowUp"||d.key==="k")&&r())};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[a,r]),x.useEffect(()=>{const n=E.current;if(!n)return;let d=0,f=0,g=0;const j=P=>{d=P.touches[0].clientY,f=P.touches[0].clientX,g=Date.now()},k=P=>{const O=P.changedTouches[0].clientY,W=P.changedTouches[0].clientX,B=d-O,H=Math.abs(f-W),J=Date.now()-g;Math.abs(B)>50&&Math.abs(B)>H&&J<500&&(B>0?a():r())};return n.addEventListener("touchstart",j,{passive:!0}),n.addEventListener("touchend",k,{passive:!0}),()=>{n.removeEventListener("touchstart",j),n.removeEventListener("touchend",k)}},[a,r]),i||m)return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ve,{}),e.jsx(A,{})]});if(t)return e.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center",children:[e.jsxs("div",{className:"text-center p-6",children:[e.jsx(je,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Failed to load tracks"}),e.jsx("p",{className:"text-muted-foreground",children:"Please try again later"})]}),e.jsx(A,{})]});const c=p[h];return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col touch-pan-y",ref:E,"data-feed":!0,children:[e.jsx("header",{className:"fixed top-0 left-0 right-0 z-40 glass-strong safe-top",children:e.jsx(q,{maxWidth:"full",children:e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsx("h1",{className:"text-lg lg:text-xl font-bold gradient-text",children:"HarmonyFeed"}),e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsxs("span",{className:"text-xs lg:text-sm text-muted-foreground flex items-center gap-1",children:[h+1," / ",p.length,L==="spotify"&&e.jsx("span",{className:"ml-1 text-[#1DB954] flex items-center gap-0.5",title:"Your Spotify history",children:e.jsx(ye,{className:"w-3 h-3"})}),L==="seed"&&e.jsx("span",{className:"ml-1 text-amber-500",title:"Using demo data",children:"•"})]}),!s&&e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>o("/auth"),className:"gap-1.5",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Sign in"})]})]})]})})}),F&&!s&&e.jsx("div",{className:"pt-16 px-4",children:e.jsx("div",{className:"mx-auto max-w-3xl rounded-xl border border-border/60 bg-background/70 px-4 py-3 text-sm text-muted-foreground shadow-lg backdrop-blur",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"You’re exploring in guest mode."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sign in to like, comment, follow, and save tracks. Playback and browsing stay open."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{size:"sm",onClick:()=>o("/auth"),children:"Sign in"}),e.jsx(v,{size:"sm",variant:"outline",onClick:()=>C(!1),children:"Maybe later"})]})]})})}),e.jsxs("div",{className:"hidden md:flex fixed left-4 top-1/2 -translate-y-1/2 z-30 flex-col gap-2",children:[e.jsx(v,{variant:"outline",size:"icon",className:"glass",onClick:r,disabled:h===0,children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsx(v,{variant:"outline",size:"icon",className:"glass",onClick:a,disabled:h===p.length-1,children:e.jsx(ee,{className:"w-5 h-5"})})]}),e.jsx("main",{className:"flex-1 pt-16 pb-24",children:e.jsx(q,{maxWidth:"full",className:"py-6",children:e.jsx(pe,{left:e.jsx(be,{currentTrack:c,trackIndex:h,totalTracks:p.length}),center:e.jsx("div",{className:"h-[calc(100vh-12rem)] max-w-lg mx-auto lg:max-w-2xl",children:e.jsx(X,{mode:"wait",children:c&&e.jsx(M.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},transition:{duration:.3},className:"h-full",children:e.jsx(se,{track:c,isActive:!0,onInteraction:I,interactions:T.get(c.id)||new Set,onPipModeActivate:(n,d)=>{n&&D({canonicalTrackId:c.id,provider:"youtube",providerTrackId:n,autoplay:!0,context:"feed",title:d,artist:c.artist})}})},c.id)})}),right:e.jsx("div",{className:"sticky top-20 space-y-4",children:e.jsx(we,{roomType:"global",className:"h-[calc(100vh-8rem)]"})}),centerWidth:"wide"})})}),p[h]&&e.jsx(ue,{roomId:"global",maxVisible:3,scrollSpeed:4e3}),e.jsx(_e,{}),e.jsx(A,{})]})}export{ks as default};
