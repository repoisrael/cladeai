import{j as e,m as T,b as V,a as Y,r as x,s as v,B as b,X as G,u as K,d as Q,C as Z,e as ee}from"./index-Djud7ByU.js";import{T as se}from"./TrackCard-xZNLz6uj.js";import{M as te}from"./music-2-CmJg9-px.js";import{T as ae}from"./trending-up-B84sYYZi.js";import{C as re}from"./clock-Dq9xLlmU.js";import{I as ne}from"./input-C8mRCalK.js";import{S as ie}from"./scroll-area-BGs96uJX.js";import{A as oe}from"./avatar-BY4hebTo.js";import{B as le}from"./badge-DgTFHXjH.js";import{U}from"./users-wWRpjEuz.js";import{A as X}from"./index-CU_qgXc9.js";import{R as $,U as ce}from"./TrackComments-sds4i_WT.js";import{S as de}from"./send-B2X-zINU.js";import{f as me}from"./formatDistanceToNow-3UBXKcFR.js";import{u as xe,S as ue}from"./useTracks-jLG7bFpD.js";import{B as A}from"./BottomNav-CxsfTDIy.js";import{S as he}from"./sparkles-BFF6S3yB.js";import{u as fe,R as q,D as pe}from"./useSpotifyUser-DOtU91CJ.js";import{u as ge}from"./useTasteDNA-BXas5Y0x.js";import{C as je}from"./circle-alert-hH7Y7JX8.js";import{M as ye}from"./music-sJrrR1HR.js";import{L as Ne}from"./log-in-BB7UWCW8.js";import"./ChordBadge-Bptbx8Oj.js";import"./rotate-ccw-BS9o1-4V.js";import"./switch-Bb6NfSCy.js";import"./index-CzEbuzxP.js";import"./Combination-DBib_6W6.js";import"./index-jngyoMZJ.js";import"./useFollowing-CQ0YF8eX.js";import"./index-BdQq_4o_.js";import"./index-BVS16Evc.js";import"./useMutation-BkEs0-PX.js";import"./label-oZaHZSq8.js";import"./map-pin-cP2ZAnNs.js";import"./radio-BPurDKku.js";import"./share-2-DaYwD1wj.js";import"./check-CoTfArUT.js";import"./twitter-xlyPvbn0.js";import"./QuickStreamButtons-CA4jE52U.js";import"./providers-CHelMshW.js";import"./timeFormat-BXo_t6_Q.js";import"./CladeIcon-Bd1TI5Om.js";import"./heart-DzDTEwI4.js";import"./waves-0BcqoMf1.js";import"./bookmark-Cwdajlcf.js";import"./search-LENj6gJG.js";import"./textarea-DJmziO1Y.js";import"./index-B4m09yIf.js";import"./chevron-right-Bq-ihZ5f.js";import"./trash-2-DtycEVWE.js";import"./en-US-wfBU2YNu.js";import"./seedTracks-B22TRa5Y.js";import"./youtubeSearchService-CkfmGNdC.js";function ve(){return e.jsxs("div",{className:"relative w-full h-full flex flex-col",children:[e.jsx("div",{className:"absolute inset-0 z-0",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-secondary to-background animate-shimmer"})}),e.jsxs("div",{className:"relative z-10 flex-1 flex flex-col justify-end p-6 pb-8 space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},className:"h-8 w-3/4 bg-muted/50 rounded-lg animate-shimmer"}),e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.05},className:"h-6 w-1/2 bg-muted/50 rounded-lg animate-shimmer"})]}),e.jsx("div",{className:"h-12 w-36 bg-muted/50 rounded-xl animate-shimmer"}),e.jsxs("div",{className:"glass-strong rounded-2xl p-4 space-y-3",children:[e.jsx("div",{className:"h-4 w-24 bg-muted/50 rounded animate-shimmer"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4].map(s=>e.jsx("div",{className:"h-8 w-12 bg-muted/50 rounded-lg animate-shimmer",style:{animationDelay:`${s*100}ms`}},s))})]}),e.jsx("div",{className:"flex items-center justify-between pt-4",children:[1,2,3,4,5].map(s=>e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-12 h-12 bg-muted/50 rounded-full animate-shimmer"}),e.jsx("div",{className:"w-10 h-3 bg-muted/50 rounded animate-shimmer"})]},s))})]})]})}function P({children:s,hover:i=!0,padding:l="md",rounded:c="xl",className:t,...o}){const h={sm:"p-2",md:"p-3",lg:"p-4"},w={md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl","2xl":"rounded-2xl"};return e.jsx("div",{className:V("glass",w[c],h[l],i&&"hover:bg-muted/30 transition-colors",t),...o,children:s})}function be({currentTrack:s,trackIndex:i,totalTracks:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx(P,{padding:"lg",rounded:"2xl",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Your Feed"}),e.jsxs("span",{className:"text-2xl font-bold gradient-text",children:[i+1,"/",l]})]}),e.jsx("div",{className:"h-2 bg-muted/30 rounded-full overflow-hidden",children:e.jsx(T.div,{className:"h-full bg-gradient-to-r from-primary to-accent",initial:{width:0},animate:{width:`${(i+1)/l*100}%`},transition:{duration:.3}})})]})}),s&&e.jsx(P,{padding:"lg",rounded:"2xl",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("h3",{className:"text-sm font-medium",children:"Now Playing"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg line-clamp-2",children:s.title}),s.artist&&e.jsx("p",{className:"text-muted-foreground line-clamp-1",children:s.artist})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t border-border/50",children:[s.detected_key&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Key"}),e.jsxs("span",{className:"font-medium",children:[s.detected_key," ",s.detected_mode]})]}),s.tempo&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"BPM"}),e.jsx("span",{className:"font-medium",children:Math.round(s.tempo)})]}),s.genre&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Genre"}),e.jsx("span",{className:"font-medium capitalize",children:s.genre})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(P,{padding:"md",rounded:"xl",hover:!1,className:"text-center",children:[e.jsx(ae,{className:"w-5 h-5 text-primary mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Trending"})]}),e.jsxs(P,{padding:"md",rounded:"xl",hover:!1,className:"text-center",children:[e.jsx(re,{className:"w-5 h-5 text-accent mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Recent"})]})]}),e.jsxs(P,{padding:"md",rounded:"xl",hover:!1,children:[e.jsx("h3",{className:"text-xs font-medium text-muted-foreground mb-3",children:"Keyboard Shortcuts"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Next track"}),e.jsx("kbd",{className:"px-2 py-1 rounded bg-muted/50 font-mono",children:"↓ or J"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Previous track"}),e.jsx("kbd",{className:"px-2 py-1 rounded bg-muted/50 font-mono",children:"↑ or K"})]})]})]})]})}function we({roomId:s="global",roomType:i="global",trackId:l,className:c=""}){var B;const{user:t}=Y(),[o,h]=x.useState([]),[w,_]=x.useState(""),[C,y]=x.useState(!0),[j,R]=x.useState([]),[u,S]=x.useState(null),L=x.useRef(null),z=x.useRef(null);x.useEffect(()=>{if(!t)return;(async()=>{try{if(i==="global"){M("global");return}if(i==="track"&&l){const{data:r}=await v.from("chat_rooms").select("id").eq("type","track").eq("track_id",l).single();if(r)M(r.id);else{const{data:d}=await v.from("chat_rooms").insert({name:"Track Chat",type:"track",track_id:l}).select("id").single();d&&M(d.id)}}}catch(r){console.error("Error initializing chat room:",r)}})()},[t,i,l]);const M=async a=>{y(!0);try{const{data:r,error:d}=await v.from("chat_messages").select(`
          id,
          user_id,
          message,
          created_at,
          reply_to,
          user:profiles!chat_messages_user_id_fkey (
            id,
            display_name,
            avatar_url
          )
        `).eq("room_id",a).order("created_at",{ascending:!0}).limit(100);if(d)throw d;h(r||[]),I()}catch(r){console.error("Error loading messages:",r)}finally{y(!1)}};x.useEffect(()=>{if(!t)return;const a=v.channel(`chat:${s}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`room_id=eq.${s}`},async r=>{const{data:d}=await v.from("profiles").select("id, display_name, avatar_url").eq("id",r.new.user_id).single();h(f=>[...f,{...r.new,user:d}]),I()}).subscribe();return()=>{v.removeChannel(a)}},[t,s]),x.useEffect(()=>{if(!t)return;const a=v.channel("online-users",{config:{presence:{key:t.id}}});return a.on("presence",{event:"sync"},()=>{const r=a.presenceState(),d=Object.values(r).flat();R(d)}).subscribe(async r=>{r==="SUBSCRIBED"&&await a.track({user_id:t.id,status:"online",online_at:new Date().toISOString()})}),()=>{v.removeChannel(a)}},[t]),x.useEffect(()=>{if(!t)return;const a=async r=>{await v.from("user_presence").upsert({user_id:t.id,status:r,current_track_id:l,last_seen:new Date().toISOString()})};return a("online"),()=>{a("offline")}},[t,l]);const I=()=>{setTimeout(()=>{var a;(a=L.current)==null||a.scrollIntoView({behavior:"smooth"})},100)},E=async a=>{var r;if(a.preventDefault(),!(!w.trim()||!t))try{const{error:d}=await v.from("chat_messages").insert({room_id:s,user_id:t.id,message:w.trim(),reply_to:(u==null?void 0:u.id)||null});if(d)throw d;_(""),S(null),(r=z.current)==null||r.focus()}catch(d){console.error("Error sending message:",d)}};return t?e.jsxs("div",{className:`flex flex-col glass rounded-xl overflow-hidden ${c}`,children:[e.jsx("div",{className:"p-4 border-b flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),e.jsx("h3",{className:"font-semibold",children:i==="global"?"Global Chat":"Track Chat"}),e.jsxs(le,{variant:"secondary",className:"text-xs",children:[j.length," online"]})]})}),e.jsx(ie,{className:"flex-1 p-4 h-[400px]",children:C?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"inline-block w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"})}):o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(U,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground opacity-50"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No messages yet. Start the conversation!"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx(X,{initial:!1,children:o.map(a=>{var r,d,f,n,m;return e.jsxs(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`flex gap-3 ${a.user_id===t.id?"flex-row-reverse":""}`,children:[e.jsx(oe,{className:"w-8 h-8 flex-shrink-0",children:(r=a.user)!=null&&r.avatar_url?e.jsx("img",{src:a.user.avatar_url,alt:""}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-xs font-semibold",children:((n=(f=(d=a.user)==null?void 0:d.display_name)==null?void 0:f[0])==null?void 0:n.toUpperCase())||"?"})}),e.jsxs("div",{className:`flex-1 min-w-0 ${a.user_id===t.id?"text-right":""}`,children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium truncate",children:((m=a.user)==null?void 0:m.display_name)||"Anonymous"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:me(new Date(a.created_at),{addSuffix:!0})})]}),a.reply_to&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-1 opacity-70",children:[e.jsx($,{className:"w-3 h-3 inline mr-1"}),"Replying to message"]}),e.jsx("div",{className:`inline-block px-3 py-2 rounded-lg max-w-[80%] break-words ${a.user_id===t.id?"bg-primary text-primary-foreground":"bg-muted"}`,children:e.jsx("p",{className:"text-sm",children:a.message})}),a.user_id!==t.id&&e.jsxs(b,{variant:"ghost",size:"sm",className:"h-6 text-xs mt-1 opacity-0 hover:opacity-100 transition-opacity",onClick:()=>S(a),children:[e.jsx($,{className:"w-3 h-3 mr-1"}),"Reply"]})]})]},a.id)})}),e.jsx("div",{ref:L})]})}),e.jsxs("div",{className:"p-4 border-t",children:[u&&e.jsxs("div",{className:"mb-2 p-2 bg-muted rounded-lg flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx($,{className:"w-3 h-3 inline mr-1"}),"Replying to ",(B=u.user)==null?void 0:B.display_name]}),e.jsx(b,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>S(null),children:e.jsx(G,{className:"w-3 h-3"})})]}),e.jsxs("form",{onSubmit:E,className:"flex gap-2",children:[e.jsx(ne,{ref:z,placeholder:"Type a message...",value:w,onChange:a=>_(a.target.value),className:"flex-1",maxLength:500}),e.jsx(b,{type:"submit",size:"icon",disabled:!w.trim(),children:e.jsx(de,{className:"w-4 h-4"})})]})]})]}):e.jsxs("div",{className:`glass rounded-xl p-6 text-center ${c}`,children:[e.jsx(U,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sign in to chat with other music lovers"})]})}function _e(){const{guestMode:s,user:i}=Y(),l=K(),[c,t]=x.useState(()=>{const _=localStorage.getItem("clade_guest_banner_dismissed");if(!_)return!1;const C=parseInt(_,10),y=24*60*60*1e3;return Date.now()-C<y}),o=s&&!i&&!c,h=()=>{t(!0),localStorage.setItem("clade_guest_banner_dismissed",Date.now().toString())},w=()=>{l("/auth")};return e.jsx(X,{children:o&&e.jsxs(T.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{type:"spring",damping:20,stiffness:300},className:"fixed bottom-0 left-0 right-0 z-50 safe-bottom",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[e.jsx("div",{className:"absolute inset-0 bg-background/95 backdrop-blur-xl border-t border-border/50"}),e.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 py-4 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 rounded-full bg-gradient-to-br from-[#00F5FF] to-[#FF00FF]",children:e.jsx(he,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground mb-0.5",children:"Join the Conversation"}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:"Sign up to comment, like, and connect with music lovers"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(b,{size:"sm",onClick:w,className:"bg-gradient-to-r from-[#00F5FF] to-[#FF00FF] hover:opacity-90 transition-opacity shadow-lg shadow-[#00F5FF]/20",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Sign Up"}),e.jsx("span",{className:"sm:hidden",children:"Join"})]}),e.jsx(b,{size:"sm",variant:"ghost",onClick:h,className:"text-muted-foreground hover:text-foreground",children:e.jsx(G,{className:"w-4 h-4"})})]})]})]})})}function Se(s,i){if(!i)return{track:s,score:.5,reasons:["New user - exploring catalog"]};let l=0;const c=[];if(s.progression_roman&&i.favoriteProgressions.length>0){const t=s.progression_roman.join("→"),o=i.favoriteProgressions.find(h=>h.progression.join("→")===t);if(o){const h=.4*(o.count/i.totalTracksAnalyzed);l+=h,c.push(`Matches your favorite progression: ${o.progression.join("-")}`)}}if(s.detected_mode&&i.preferredModes.length>0){const t=i.preferredModes.find(o=>o.mode===s.detected_mode);if(t){const o=.2*(t.percentage/100);l+=o,c.push(`${s.detected_mode} mode (${Math.round(t.percentage)}% of your taste)`)}}if(typeof s.energy=="number"&&typeof i.energyPreference=="number"){const t=Math.abs(s.energy-i.energyPreference),o=.2*(1-t);l+=o,t<.2?c.push("Perfect energy match"):t<.4&&c.push("Good energy match")}if(typeof s.tempo=="number"&&typeof i.averageTempo=="number"){const t=Math.abs(s.tempo-i.averageTempo),o=.2*Math.max(0,1-t/100);l+=o,t<15&&c.push("Similar tempo to your favorites")}return l=Math.max(0,Math.min(1,l)),c.length===0&&c.push("Recommended for you"),{track:s,score:l,reasons:c}}function ke(s,i,l){const c=s.map(o=>Se(o,i));return c.sort((o,h)=>h.score-o.score),c.map(o=>o.track)}function ks(){const{user:s,loading:i}=Y(),l=K(),{data:c,isLoading:t,error:o}=xe(50),{data:h,isLoading:w}=fe(20),{data:_}=ge(),C=(c==null?void 0:c.tracks)??[],y=(h==null?void 0:h.tracks)??[],j=(()=>{let n;if(y.length>0){const m=new Set(y.map(g=>g.spotify_id).filter(Boolean)),N=new Set(y.map(g=>g.id).filter(Boolean)),p=C.filter(g=>!m.has(g.spotify_id)&&!N.has(g.id));n=[...y,...p]}else{const m=new Set;n=C.filter(N=>{const p=N.spotify_id||N.id;return m.has(p)?!1:(m.add(p),!0)})}return s&&_?ke(n,_):n})(),R=y.length>0?"spotify":c==null?void 0:c.source,[u,S]=x.useState(0),[L,z]=x.useState(new Map),M=x.useRef(null),[I,E]=x.useState(!s),{openPlayer:B}=Q();x.useEffect(()=>{s&&E(!1)},[s]);const a=n=>{var N;if(!s){E(!0);return}const m=(N=j[u])==null?void 0:N.id;m&&(z(p=>{const g=new Map(p),k=new Set(p.get(m)||[]);return k.has(n)?k.delete(n):k.add(n),g.set(m,k),g}),n==="skip"&&u<j.length-1&&S(p=>p+1))},r=x.useCallback(()=>{u<j.length-1&&S(n=>n+1)},[u,j.length]),d=x.useCallback(()=>{u>0&&S(n=>n-1)},[u]);if(x.useEffect(()=>{const n=m=>{m.target instanceof HTMLInputElement||m.target instanceof HTMLTextAreaElement||(m.key==="ArrowDown"||m.key==="j"?r():(m.key==="ArrowUp"||m.key==="k")&&d())};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[r,d]),x.useEffect(()=>{const n=M.current;if(!n)return;let m=0,N=0,p=0;const g=F=>{m=F.touches[0].clientY,N=F.touches[0].clientX,p=Date.now()},k=F=>{const O=F.changedTouches[0].clientY,H=F.changedTouches[0].clientX,D=m-O,J=Math.abs(N-H),W=Date.now()-p;Math.abs(D)>50&&Math.abs(D)>J&&W<500&&(D>0?r():d())};return n.addEventListener("touchstart",g,{passive:!0}),n.addEventListener("touchend",k,{passive:!0}),()=>{n.removeEventListener("touchstart",g),n.removeEventListener("touchend",k)}},[r,d]),i||t)return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ve,{}),e.jsx(A,{})]});if(o)return e.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center",children:[e.jsxs("div",{className:"text-center p-6",children:[e.jsx(je,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Failed to load tracks"}),e.jsx("p",{className:"text-muted-foreground",children:"Please try again later"})]}),e.jsx(A,{})]});const f=j[u];return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col touch-pan-y",ref:M,"data-feed":!0,children:[e.jsx("header",{className:"fixed top-0 left-0 right-0 z-40 glass-strong safe-top",children:e.jsx(q,{maxWidth:"full",children:e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsx("h1",{className:"text-lg lg:text-xl font-bold gradient-text",children:"HarmonyFeed"}),e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsxs("span",{className:"text-xs lg:text-sm text-muted-foreground flex items-center gap-1",children:[u+1," / ",j.length,R==="spotify"&&e.jsx("span",{className:"ml-1 text-[#1DB954] flex items-center gap-0.5",title:"Your Spotify history",children:e.jsx(ye,{className:"w-3 h-3"})}),R==="seed"&&e.jsx("span",{className:"ml-1 text-amber-500",title:"Using demo data",children:"•"})]}),!s&&e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>l("/auth"),className:"gap-1.5",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Sign in"})]})]})]})})}),I&&!s&&e.jsx("div",{className:"pt-16 px-4",children:e.jsx("div",{className:"mx-auto max-w-3xl rounded-xl border border-border/60 bg-background/70 px-4 py-3 text-sm text-muted-foreground shadow-lg backdrop-blur",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"You’re exploring in guest mode."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sign in to like, comment, follow, and save tracks. Playback and browsing stay open."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{size:"sm",onClick:()=>l("/auth"),children:"Sign in"}),e.jsx(b,{size:"sm",variant:"outline",onClick:()=>E(!1),children:"Maybe later"})]})]})})}),e.jsxs("div",{className:"hidden md:flex fixed left-4 top-1/2 -translate-y-1/2 z-30 flex-col gap-2",children:[e.jsx(b,{variant:"outline",size:"icon",className:"glass",onClick:d,disabled:u===0,children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsx(b,{variant:"outline",size:"icon",className:"glass",onClick:r,disabled:u===j.length-1,children:e.jsx(ee,{className:"w-5 h-5"})})]}),e.jsx("main",{className:"flex-1 pt-16 pb-24",children:e.jsx(q,{maxWidth:"full",className:"py-6",children:e.jsx(pe,{left:e.jsx(be,{currentTrack:f,trackIndex:u,totalTracks:j.length}),center:e.jsx("div",{className:"h-[calc(100vh-12rem)] max-w-lg mx-auto lg:max-w-2xl",children:e.jsx(X,{mode:"wait",children:f&&e.jsx(T.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},transition:{duration:.3},className:"h-full",children:e.jsx(se,{track:f,isActive:!0,onInteraction:a,interactions:L.get(f.id)||new Set,onPipModeActivate:(n,m)=>{n&&B({canonicalTrackId:f.id,provider:"youtube",providerTrackId:n,autoplay:!0,context:"feed",title:m,artist:f.artist})}})},f.id)})}),right:e.jsx("div",{className:"sticky top-20 space-y-4",children:e.jsx(we,{roomType:"global",className:"h-[calc(100vh-8rem)]"})}),centerWidth:"wide"})})}),j[u]&&e.jsx(ue,{roomId:"global",maxVisible:3,scrollSpeed:4e3}),e.jsx(_e,{}),e.jsx(A,{})]})}export{ks as default};
