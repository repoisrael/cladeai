import{c as V,a as T,g as q,s as h,h as W,j as e,i as ts,k as as,r as N,B as A,f as Q,u as rs,l as ns,b as is,n as ls,L as os,m as S,X as cs,P as ds,e as $}from"./index-DkNgIbaA.js";import{C as ms}from"./ChordBadge-1HmQNrCl.js";import{S as Te,Q as us}from"./QuickStreamButtons-CmUZVWQ7.js";import{P as De}from"./PageLayout-vo7FfAux.js";import{E as xs,f as L}from"./animations-CPU72z3F.js";import{R as hs,a as me}from"./ResponsiveLayout--nwsv9mD.js";import{I as he}from"./input-Y6iSTuwf.js";import{u as ps,a as fs,b as gs,c as ys,d as js,e as vs,f as Ns,n as bs}from"./useSpotifyUser-DlQOabv_.js";import{u as Y}from"./useMutation-CY0DwmRx.js";import{u as ws,a as _s}from"./useSpotifyConnect-bM5lrXNF.js";import{P as U}from"./providers-CHelMshW.js";import{D as Ue,a as Be,b as Ke,c as Oe,d as ks,e as Cs}from"./dialog-C3P2pDxP.js";import{T as He,a as Qe,b as B,c as E}from"./tabs-DRQl-Rsg.js";import{A as Ss,a as Ps,b as Fs}from"./avatar-CQD746jw.js";import{L as H}from"./label-C2QQQN2X.js";import{S as se,a as te,b as ae,c as re,d as ne}from"./select-Dhq0JGh-.js";import{T as Ls}from"./textarea-DQtRfUCU.js";import{S as As}from"./switch-DsDf-KEc.js";import{S as Ts}from"./scroll-area-Do2AukxK.js";import{U as ue}from"./BottomNav-Spcbbn6k.js";import{S as qe}from"./shield-C0J97ZJ5.js";import{Z as Ds}from"./zap-P9lejt4c.js";import{C as qs}from"./chart-column-B9fqmsEd.js";import{S as Me}from"./sparkles-B9EE0NBl.js";import{M as G}from"./music-0ZRneg1E.js";import{L as Ms}from"./link-P296mC_M.js";import{C as xe}from"./check-ho0733Lh.js";import{C as Ie}from"./chevron-right-CX0E31ic.js";import{R as Ee}from"./radio-C3XOASku.js";import{T as Is}from"./trending-up-H-QumB4D.js";import{D as Es}from"./disc-3-CxGNGhGA.js";import{C as Rs}from"./clock-D7VW3-Gk.js";import{H as zs}from"./heart-DnZ_7-g6.js";import{B as $s}from"./bookmark-CAEy-oMF.js";import{f as Re}from"./formatDistanceToNow-3UBXKcFR.js";import"./youtubeSearchService-C_W3FhdG.js";import"./CladeIcon-DNEJ9K2C.js";import"./index-BoL5jZSa.js";import"./index--h7i-X9I.js";import"./index-C-uSMMx4.js";import"./index-BdQq_4o_.js";import"./Combination-mAjfBmO8.js";import"./index-DAiq7sMS.js";import"./search-qxkC8hqk.js";import"./en-US-wfBU2YNu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=V("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=V("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=V("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=V("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=V("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=V("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);function Qs(s={}){const{user:a}=T(),{limit:r=20}=s;return q({queryKey:["play-history",a==null?void 0:a.id,r],queryFn:async()=>{if(!a)return[];const{data:n,error:o}=await h.from("user_interactions").select(`
          id,
          user_id,
          track_id,
          interaction_type,
          created_at
        `).eq("user_id",a.id).like("interaction_type","play_%").order("created_at",{ascending:!1}).limit(r);return o?(console.warn("Failed to fetch play history:",o),[]):(n||[]).map(d=>({id:d.id,user_id:d.user_id,track_id:d.track_id,provider:"spotify",action:d.interaction_type.replace("play_",""),played_at:d.created_at}))},enabled:!!a})}function Vs(){const{user:s}=T();return q({queryKey:["play-stats",s==null?void 0:s.id],queryFn:async()=>{if(!s)return null;const{count:a}=await h.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",s.id).like("interaction_type","play_%");return{totalPlays:a||0,providerCounts:{},recentPlays:0}},enabled:!!s})}function Ws(){const{user:s}=T();return q({queryKey:["profile",s==null?void 0:s.id],queryFn:async()=>{if(!s)return null;const{data:a,error:r}=await h.from("profiles").select("*").eq("id",s.id).single();if(r)throw r;return a},enabled:!!s})}function Ys(){const{user:s}=T();return q({queryKey:["user-providers",s==null?void 0:s.id],queryFn:async()=>{if(!s)return[];const{data:a,error:r}=await h.from("user_providers").select("*").eq("user_id",s.id).order("connected_at",{ascending:!1});if(r)throw r;return a},enabled:!!s})}function Gs(){const{user:s}=T(),a=W();return Y({mutationFn:async r=>{if(!s)throw new Error("Not authenticated");const{data:n,error:o}=await h.from("profiles").update({preferred_provider:r}).eq("id",s.id).select().single();if(o)throw o;return n},onSuccess:()=>{a.invalidateQueries({queryKey:["profile"]})}})}function Zs(s){return q({queryKey:["user-interaction-stats",s],queryFn:async()=>{if(!s)return{likes:0,saves:0,shares:0};const[a,r,n]=await Promise.all([h.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",s).eq("interaction_type","like"),h.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",s).eq("interaction_type","save"),h.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",s).eq("interaction_type","share")]);return{likes:a.count||0,saves:r.count||0,shares:n.count||0}},enabled:!!s})}const Xs="https://ws.audioscrobbler.com/2.0";function Js(){return"35ed8783bc2fca78c9b0dd99d8dcb9ef"}async function Z(s,a){try{const r=Js(),n=new URLSearchParams({method:s,api_key:r,format:"json",...a}),o=await fetch(`${Xs}?${n}`);if(!o.ok)return console.error(`Last.fm API error: ${o.status}`),null;const d=await o.json();return d.error?(console.error(`Last.fm error ${d.error}: ${d.message}`),null):d}catch(r){return console.error("Last.fm request failed:",r),null}}async function Ve(s){const a=await Z("user.getInfo",{user:s});return(a==null?void 0:a.user)??null}async function et(s,a="3month",r=10){var o;const n=await Z("user.getTopArtists",{user:s,period:a,limit:r.toString()});return((o=n==null?void 0:n.topartists)==null?void 0:o.artist)??[]}async function st(s,a="3month",r=10){var o;const n=await Z("user.getTopTracks",{user:s,period:a,limit:r.toString()});return((o=n==null?void 0:n.toptracks)==null?void 0:o.track)??[]}async function tt(s,a=20){var n;const r=await Z("user.getRecentTracks",{user:s,limit:a.toString()});return((n=r==null?void 0:r.recenttracks)==null?void 0:n.track)??[]}async function at(s){var r,n;const a=await Z("user.getWeeklyArtistChart",{user:s});return((n=(r=a==null?void 0:a.weeklyartistchart)==null?void 0:r.artist)==null?void 0:n.length)??0}async function rt(s){if(!s)return null;try{const[a,r,n,o,d]=await Promise.all([Ve(s),et(s,"3month",10),st(s,"3month",10),tt(s,10),at(s)]);if(!a)return null;const p=c=>{var D;if(!c||c.length===0)return;const y=["extralarge","large","medium","small"];for(const b of y){const w=c.find(P=>P.size===b);if(w!=null&&w["#text"])return w["#text"]}return((D=c[0])==null?void 0:D["#text"])||void 0};return{totalScrobbles:parseInt(a.playcount,10)||0,artistCount:parseInt(a.artist_count,10)||0,trackCount:parseInt(a.track_count,10)||0,registeredDate:new Date(parseInt(a.registered.unixtime,10)*1e3),topArtists:r.map(c=>({name:c.name,playcount:parseInt(c.playcount,10)||0,imageUrl:p(c.image)})),topTracks:n.map(c=>({name:c.name,artist:c.artist.name,playcount:parseInt(c.playcount||"0",10)})),recentTracks:o.map(c=>{var y;return{name:c.name,artist:c.artist.name,album:(y=c.album)==null?void 0:y["#text"],playedAt:c.date?new Date(parseInt(c.date.uts,10)*1e3):void 0,imageUrl:p(c.image),nowPlaying:!c.date}}),weeklyArtistCount:d}}catch(a){return console.error("Error fetching Last.fm stats:",a),null}}async function nt(s,a){if(!await Ve(a))throw new Error("Last.fm username not found. Please check the username and try again.");const{error:n}=await h.from("user_providers").upsert({user_id:s,provider:"lastfm",provider_user_id:a,access_token:"public",refresh_token:"public",expires_at:new Date(Date.now()+365*24*60*60*1e3).toISOString(),connected_at:new Date().toISOString()},{onConflict:"user_id,provider"});if(n)throw console.error("Failed to store Last.fm connection:",n),new Error("Failed to save Last.fm connection")}async function it(s){const{data:a,error:r}=await h.from("user_providers").select("provider_user_id").eq("user_id",s).eq("provider","lastfm").single();return r||!a?null:a.provider_user_id}async function lt(s){const{error:a}=await h.from("user_providers").delete().eq("user_id",s).eq("provider","lastfm");if(a)throw new Error("Failed to disconnect Last.fm")}function We(){const{user:s}=T();return q({queryKey:["lastfm-username",s==null?void 0:s.id],queryFn:()=>it(s.id),enabled:!!s,staleTime:5*60*1e3})}function ot(){const{user:s}=T(),{data:a}=We();return q({queryKey:["lastfm-stats",a],queryFn:()=>a?rt(a):null,enabled:!!s&&!!a,staleTime:5*60*1e3,refetchOnWindowFocus:!0})}function ct(){const{user:s}=T(),a=W();return Y({mutationFn:async r=>{if(!s)throw new Error("Must be logged in");return await nt(s.id,r),r},onSuccess:r=>{a.setQueryData(["lastfm-username",s==null?void 0:s.id],r),a.invalidateQueries({queryKey:["lastfm-stats"]}),a.invalidateQueries({queryKey:["user-providers"]})}})}function dt(){const{user:s}=T(),a=W();return Y({mutationFn:async()=>{if(!s)throw new Error("Must be logged in");await lt(s.id)},onSuccess:()=>{a.setQueryData(["lastfm-username",s==null?void 0:s.id],null),a.setQueryData(["lastfm-stats",null],null),a.invalidateQueries({queryKey:["user-providers"]})}})}async function mt(s){var a;try{const[r,n]=await Promise.all([h.from("play_history").select("track_id, tracks!inner(*)").eq("user_id",s).order("played_at",{ascending:!1}).limit(200),h.from("user_interactions").select("track_id, tracks!inner(*)").eq("user_id",s).in("interaction_type",["like","save"]).order("created_at",{ascending:!1}).limit(100)]),o=(r.data||[]).map(l=>l.tracks).filter(Boolean),d=(n.data||[]).map(l=>l.tracks).filter(Boolean),p=new Map;[...o,...d].forEach(l=>{l!=null&&l.id&&p.set(l.id,l)});const c=Array.from(p.values());if(c.length===0)return null;const y=new Map;c.forEach(l=>{if(l.progression_roman&&l.progression_roman.length>0){const m=l.progression_roman.join("â†’"),F=y.get(m);F?(F.count++,F.tracks.push(l.id)):y.set(m,{count:1,tracks:[l.id]})}});const D=Array.from(y.entries()).map(([l,m])=>({progression:l.split("â†’"),count:m.count,tracks:m.tracks})).sort((l,m)=>m.count-l.count).slice(0,5),b=c.reduce((l,m)=>(m.detected_mode==="major"?l.major++:m.detected_mode==="minor"&&l.minor++,l),{major:0,minor:0}),w=b.major+b.minor,P=w>0?[{mode:"major",percentage:Math.round(b.major/w*100),count:b.major},{mode:"minor",percentage:Math.round(b.minor/w*100),count:b.minor}].sort((l,m)=>m.percentage-l.percentage):[],R=c.filter(l=>typeof l.energy=="number").map(l=>l.energy),K=R.length>0?R.reduce((l,m)=>l+m,0)/R.length:.5,O=c.reduce((l,m)=>{const F=m.cadence_type||"loop";return l[F]=(l[F]||0)+1,l},{}),x=((a=Object.entries(O).sort((l,m)=>m[1]-l[1])[0])==null?void 0:a[0])||"loop",k=c.filter(l=>typeof l.tempo=="number").map(l=>l.tempo),M=k.length>0?Math.round(k.reduce((l,m)=>l+m,0)/k.length):120;return{favoriteProgressions:D,preferredModes:P,energyPreference:K,cadencePreference:x,averageTempo:M,totalTracksAnalyzed:c.length}}catch(r){return console.error("Error computing taste DNA:",r),null}}function ut(){const{user:s}=T();return q({queryKey:["taste-dna",s==null?void 0:s.id],queryFn:async()=>s!=null&&s.id?mt(s.id):null,enabled:!!(s!=null&&s.id),staleTime:5*60*1e3,gcTime:10*60*1e3})}function ze(s){const a=new Date,r=typeof s=="string"?new Date(s):s,n=a.getTime()-r.getTime(),o=Math.floor(n/6e4),d=Math.floor(n/36e5),p=Math.floor(n/864e5);return o<1?"just now":o<60?`${o}m ago`:d<24?`${d}h ago`:p<7?`${p}d ago`:r.toLocaleDateString()}function xt({provider:s,className:a,showIcon:r=!0,showName:n=!0,size:o="md"}){const d=U[s],p={sm:"px-1.5 py-0.5 text-[10px] gap-0.5",md:"px-2 py-0.5 text-xs gap-1",lg:"px-3 py-1 text-sm gap-1.5"};return e.jsxs("span",{className:ts("inline-flex items-center rounded font-medium",p[o],a),style:{backgroundColor:`${d.color}20`,color:d.color},children:[r&&e.jsx("span",{className:o==="sm"?"text-[8px]":o==="md"?"text-[10px]":"text-xs",children:d.icon}),n&&e.jsx("span",{children:d.name})]})}function ht(s){return q({queryKey:["userTheme",s],queryFn:async()=>{var o;const a=s||((o=(await h.auth.getUser()).data.user)==null?void 0:o.id);if(!a)throw new Error("No user ID provided");const{data:r,error:n}=await h.from("user_themes").select("*").eq("user_id",a).maybeSingle();if(n)throw n;return r},staleTime:5*60*1e3,enabled:!!s||!0})}function pt(){return q({queryKey:["themePresets"],queryFn:async()=>{const{data:s,error:a}=await h.from("theme_presets").select("*").order("is_featured",{ascending:!1}).order("usage_count",{ascending:!1});if(a)throw a;return s},staleTime:10*60*1e3})}function ft(){const s=W();return Y({mutationFn:async a=>{const{data:r,error:n}=await h.from("user_themes").insert(a).select().single();if(n)throw n;return r},onSuccess:a=>{s.invalidateQueries({queryKey:["userTheme",a.user_id]})}})}function gt(){const s=W();return Y({mutationFn:async({userId:a,updates:r})=>{const{data:n,error:o}=await h.from("user_themes").update(r).eq("user_id",a).select().single();if(o)throw o;return n},onSuccess:a=>{s.invalidateQueries({queryKey:["userTheme",a.user_id]})}})}function yt(){const s=W();return Y({mutationFn:async({userId:a,presetId:r})=>{const{data:n,error:o}=await h.from("theme_presets").select("*").eq("id",r).single();if(o)throw o;await h.rpc("increment_theme_usage",{preset_id:r});const{data:d}=await h.from("user_themes").select("id").eq("user_id",a).maybeSingle();if(d){const{data:p,error:c}=await h.from("user_themes").update({theme_name:n.name,colors:n.colors,fonts:n.fonts,layout:n.layout,custom_css:n.custom_css,player_skin:n.player_skin,animated_background:n.animated_background}).eq("user_id",a).select().single();if(c)throw c;return p}else{const{data:p,error:c}=await h.from("user_themes").insert({user_id:a,theme_name:n.name,colors:n.colors,fonts:n.fonts,layout:n.layout,custom_css:n.custom_css,player_skin:n.player_skin,animated_background:n.animated_background}).select().single();if(c)throw c;return p}},onSuccess:a=>{s.invalidateQueries({queryKey:["userTheme",a.user_id]}),s.invalidateQueries({queryKey:["themePresets"]})}})}const jt={background:"#000000",surface:"#1a1a1a",primary:"#3b82f6",secondary:"#8b5cf6",accent:"#f59e0b",text:"#ffffff",textMuted:"#9ca3af"},vt={heading:"Inter",body:"Inter"},$e=["Inter","Roboto","Open Sans","Lato","Montserrat","Poppins","Playfair Display","Lora","Merriweather","Roboto Mono","Fira Code","Source Code Pro","Orbitron","Press Start 2P","Audiowide"],Nt=[{value:"modern",label:"Modern"},{value:"minimal",label:"Minimal"},{value:"retro",label:"Retro"},{value:"neon",label:"Neon"},{value:"academic",label:"Academic"}],bt=[{value:"default",label:"Default"},{value:"compact",label:"Compact"},{value:"glassmorphism",label:"Glassmorphism"},{value:"retro",label:"Retro"},{value:"minimal",label:"Minimal"}];function wt({open:s,onOpenChange:a,currentTheme:r,userId:n}){const{toast:o}=as(),[d,p]=N.useState((r==null?void 0:r.colors)||jt),[c,y]=N.useState((r==null?void 0:r.fonts)||vt),[D,b]=N.useState((r==null?void 0:r.layout)||"modern"),[w,P]=N.useState((r==null?void 0:r.custom_css)||""),[R,K]=N.useState((r==null?void 0:r.player_skin)||"default"),[O,x]=N.useState((r==null?void 0:r.animated_background)||!1),{data:k}=pt(),M=gt(),l=ft(),m=yt();N.useEffect(()=>{r&&(p(r.colors),y(r.fonts),b(r.layout),P(r.custom_css||""),K(r.player_skin),x(r.animated_background))},[r]);const F=async()=>{try{const i={colors:d,fonts:c,layout:D,custom_css:w||null,player_skin:R,animated_background:O};r?await M.mutateAsync({userId:n,updates:i}):await l.mutateAsync({user_id:n,...i}),o({title:"Theme saved",description:"Your profile theme has been updated successfully."}),a(!1)}catch(i){o({title:"Error saving theme",description:i instanceof Error?i.message:"Failed to save theme",variant:"destructive"})}},ie=async i=>{try{const f=await m.mutateAsync({userId:n,presetId:i});p(f.colors),y(f.fonts),b(f.layout),P(f.custom_css||""),K(f.player_skin||"default"),x(f.animated_background),o({title:"Preset applied",description:"Theme preset has been applied to the editor."})}catch(f){o({title:"Error applying preset",description:f instanceof Error?f.message:"Failed to apply preset",variant:"destructive"})}},X=(i,f)=>{p(j=>({...j,[i]:f}))},g=(i,f)=>{y(j=>({...j,[i]:f}))};return e.jsx(Ue,{open:s,onOpenChange:a,children:e.jsxs(Be,{className:"max-w-5xl h-[90vh]",children:[e.jsx(Ke,{children:e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Theme Editor"]})}),e.jsxs("div",{className:"flex gap-4 flex-1 overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs(He,{defaultValue:"presets",className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-5",children:[e.jsxs(B,{value:"presets",className:"flex items-center gap-1",children:[e.jsx(Hs,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Presets"})]}),e.jsxs(B,{value:"colors",className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Colors"})]}),e.jsxs(B,{value:"fonts",className:"flex items-center gap-1",children:[e.jsx(Os,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Fonts"})]}),e.jsxs(B,{value:"layout",className:"flex items-center gap-1",children:[e.jsx(Ks,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Layout"})]}),e.jsxs(B,{value:"advanced",className:"flex items-center gap-1",children:[e.jsx(Us,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Advanced"})]})]}),e.jsxs(Ts,{className:"h-[calc(90vh-180px)] mt-4",children:[e.jsxs(E,{value:"presets",className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start with a pre-made theme and customize it to your liking."}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:k==null?void 0:k.map(i=>e.jsxs("button",{onClick:()=>ie(i.id),className:"flex items-start gap-3 p-4 rounded-lg border hover:bg-accent transition-colors text-left",children:[e.jsx("div",{className:"w-12 h-12 rounded border shrink-0",style:{background:`linear-gradient(135deg, ${i.colors.primary}, ${i.colors.secondary})`}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium",children:i.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:i.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[i.is_featured&&e.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded",children:"Featured"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.usage_count," uses"]})]})]})]},i.id))})]}),e.jsx(E,{value:"colors",className:"space-y-4",children:Object.entries(d).map(([i,f])=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:i,className:"capitalize",children:i.replace(/([A-Z])/g," $1").trim()}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(he,{id:i,type:"color",value:f,onChange:j=>X(i,j.target.value),className:"w-20 h-10 p-1 cursor-pointer"}),e.jsx(he,{type:"text",value:f,onChange:j=>X(i,j.target.value),className:"flex-1",placeholder:"#000000"})]})]},i))}),e.jsxs(E,{value:"fonts",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"heading-font",children:"Heading Font"}),e.jsxs(se,{value:c.heading,onValueChange:i=>g("heading",i),children:[e.jsx(te,{id:"heading-font",children:e.jsx(ae,{})}),e.jsx(re,{children:$e.map(i=>e.jsx(ne,{value:i,style:{fontFamily:i},children:i},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"body-font",children:"Body Font"}),e.jsxs(se,{value:c.body,onValueChange:i=>g("body",i),children:[e.jsx(te,{id:"body-font",children:e.jsx(ae,{})}),e.jsx(re,{children:$e.map(i=>e.jsx(ne,{value:i,style:{fontFamily:i},children:i},i))})]})]})]}),e.jsxs(E,{value:"layout",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"layout-select",children:"Layout Style"}),e.jsxs(se,{value:D,onValueChange:b,children:[e.jsx(te,{id:"layout-select",children:e.jsx(ae,{})}),e.jsx(re,{children:Nt.map(i=>e.jsx(ne,{value:i.value,children:i.label},i.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"player-skin",children:"Player Skin"}),e.jsxs(se,{value:R,onValueChange:K,children:[e.jsx(te,{id:"player-skin",children:e.jsx(ae,{})}),e.jsx(re,{children:bt.map(i=>e.jsx(ne,{value:i.value,children:i.label},i.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(H,{htmlFor:"animated-bg",children:"Animated Background"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable subtle background animation"})]}),e.jsx(As,{id:"animated-bg",checked:O,onCheckedChange:x})]})]}),e.jsx(E,{value:"advanced",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"custom-css",children:"Custom CSS"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Advanced: Add custom CSS to further customize your profile"}),e.jsx(Ls,{id:"custom-css",value:w,onChange:i=>P(i.target.value),placeholder:".profile-header { ... }",className:"font-mono text-sm min-h-[200px]"})]})})]})]})}),e.jsxs("div",{className:"w-80 rounded-lg border p-4 overflow-hidden",style:{backgroundColor:d.background,color:d.text,fontFamily:c.body},children:[e.jsx("h3",{className:"text-sm font-medium mb-3",style:{fontFamily:c.heading},children:"Live Preview"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 rounded",style:{backgroundColor:d.surface},children:[e.jsx("h4",{className:"font-semibold mb-1",style:{fontFamily:c.heading,color:d.primary},children:"Heading Text"}),e.jsx("p",{className:"text-sm",style:{color:d.textMuted},children:"This is how your body text will appear on your profile."})]}),e.jsx("button",{className:"w-full py-2 px-4 rounded font-medium",style:{backgroundColor:d.primary,color:d.background},children:"Primary Button"}),e.jsx("button",{className:"w-full py-2 px-4 rounded font-medium",style:{backgroundColor:d.secondary,color:d.background},children:"Secondary Button"}),e.jsx("div",{className:"p-2 rounded text-sm",style:{backgroundColor:d.accent,color:d.background},children:"Accent Color"})]})]})]}),e.jsxs(ks,{children:[e.jsx(A,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(A,{onClick:F,disabled:M.isPending||l.isPending,children:[(M.isPending||l.isPending)&&e.jsx(Q,{className:"w-4 h-4 mr-2 animate-spin"}),"Save Theme"]})]})]})})}const _t={energetic:"from-orange-500 to-red-500",chill:"from-blue-400 to-cyan-400",melancholic:"from-purple-500 to-indigo-600",upbeat:"from-yellow-400 to-orange-400",balanced:"from-green-400 to-emerald-500"},kt={energetic:"âš¡",chill:"ðŸŒŠ",melancholic:"ðŸŒ™",upbeat:"â˜€ï¸",balanced:"ðŸŽ¯"};function ga(){var Ce,Se,Pe,Fe,Le;const{user:s,signOut:a,loading:r}=T(),n=rs(),[o,d]=N.useState("all"),[p,c]=N.useState(!1),[y,D]=N.useState(""),[b,w]=N.useState(!1),[P,R]=N.useState("medium_term"),[K,O]=N.useState(!1),{data:x}=Ws(),{data:k=[],refetch:M}=Ys(),{data:l}=Vs(),{data:m}=Zs(s==null?void 0:s.id),{data:F=[]}=Qs({limit:20,provider:o==="all"?void 0:o}),ie=Gs(),{data:X}=ps(),{data:g}=fs(),{data:i=[]}=gs(P,10),{data:f=[]}=ys(P,10),{data:j}=js(20),{data:C}=vs(),{data:fe=[]}=Ns([],[],10),ge=ws(),ye=_s(),{data:je}=We(),{data:I}=ot(),J=ct(),le=dt(),{data:v,isLoading:oe}=ut(),{data:Ye}=ht(s==null?void 0:s.id),{data:ve}=ns(),{openPlayer:Ne}=is(),ce=X===!0,be=i.length>0?"tracks":f.length>0?"artists":"recent",ee=!!je,Ge=(m==null?void 0:m.likes)??0,Ze=(m==null?void 0:m.saves)??0,Xe=async()=>{await a(),n("/")},Je=async()=>{try{await ge.mutateAsync()}catch(t){$.error(t.message||"Failed to connect Spotify")}},es=async()=>{try{await ye.mutateAsync(),$.success("Spotify disconnected"),M()}catch{$.error("Failed to disconnect Spotify")}},we=async()=>{if(!y.trim()){$.error("Please enter your Last.fm username");return}try{await J.mutateAsync(y.trim()),$.success("Last.fm connected successfully!"),w(!1),D(""),M()}catch(t){$.error(t.message||"Failed to connect Last.fm")}},ss=async()=>{try{await le.mutateAsync(),$.success("Last.fm disconnected"),M()}catch{$.error("Failed to disconnect Last.fm")}},_e=async t=>{try{await ie.mutateAsync(t),c(!1)}catch(u){console.error("Failed to set preferred provider:",u)}},ke=N.useCallback(t=>t.spotifyId||t.spotify_id?"spotify":t.youtubeId||t.youtube_id?"youtube":ls()??null,[]),de=N.useCallback(t=>{const u=ke(t);if(!u)return;const _=u==="spotify"?t.spotifyId||t.spotify_id:t.youtubeId||t.youtube_id;_&&Ne({canonicalTrackId:t.id||t.track_id||null,provider:u,providerTrackId:_,title:t.title,artist:t.artist,album:t.album,autoplay:!0,context:"profile-recent"})},[Ne,ke]);return r?e.jsx(os,{fullScreen:!0}):s?e.jsxs(De,{title:"Profile",headerActions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>O(!0),children:[e.jsx(pe,{className:"w-4 h-4"}),"Theme"]}),ve&&e.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>n("/admin"),children:[e.jsx(qe,{className:"w-4 h-4"}),"Admin"]}),e.jsx(A,{variant:"ghost",size:"icon",onClick:Xe,children:e.jsx(Bs,{className:"w-5 h-5"})})]}),children:[e.jsxs(hs,{maxWidth:"full",className:"space-y-6",children:[e.jsxs(S.div,{variants:L,initial:"initial",animate:"animate",className:"flex items-center gap-4 p-4 glass rounded-2xl",children:[e.jsxs(Ss,{className:"w-16 h-16",children:[e.jsx(Ps,{src:(g==null?void 0:g.imageUrl)||(x==null?void 0:x.avatar_url)||void 0}),e.jsx(Fs,{className:"bg-gradient-to-br from-primary to-accent text-white text-xl",children:((Ce=g==null?void 0:g.displayName)==null?void 0:Ce[0])||((Se=s.email)==null?void 0:Se[0].toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"font-bold truncate",children:(g==null?void 0:g.displayName)||((Pe=s.email)==null?void 0:Pe.split("@")[0])}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.email}),g&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${g.product==="premium"?"bg-[#1DB954]/20 text-[#1DB954]":"bg-muted text-muted-foreground"}`,children:g.product==="premium"?"ðŸ‘‘ Premium":"Free"}),g.followers&&g.followers>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[g.followers," followers"]})]})]})]}),e.jsxs(S.div,{variants:L,initial:"initial",animate:"animate",transition:{delay:.05},className:"p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"font-medium",children:"Credits"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Free tier"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full w-1/4 bg-gradient-to-r from-primary to-accent rounded-full"})}),e.jsx("span",{className:"text-sm font-medium",children:"25/100"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Credits reset monthly. Used for track analysis."})]}),ce&&C&&e.jsxs(S.div,{variants:L,initial:"initial",animate:"animate",transition:{delay:.1},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qs,{className:"w-5 h-5"}),e.jsx("h3",{className:"font-bold",children:"Your Music DNA"})]}),e.jsxs("div",{className:`p-6 rounded-2xl bg-gradient-to-br ${_t[C.moodProfile]} text-white`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-4xl",children:kt[C.moodProfile]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold capitalize",children:C.moodProfile}),e.jsx("p",{className:"text-white/80 text-sm",children:"Your listening mood profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Energy"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${C.averageEnergy*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(C.averageEnergy*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Danceability"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${C.averageDanceability*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(C.averageDanceability*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Happiness"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${C.averageValence*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(C.averageValence*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Avg Tempo"}),e.jsxs("p",{className:"text-lg font-bold",children:[Math.round(C.averageTempo)," BPM"]})]})]})]}),C.topGenres.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Top Genres"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:C.topGenres.slice(0,8).map((t,u)=>e.jsx("span",{className:"px-3 py-1 rounded-full bg-primary/10 text-primary text-sm",style:{opacity:1-u*.08},children:t.genre},t.genre))})]})]}),e.jsxs(S.div,{variants:L,initial:"initial",animate:"animate",transition:{delay:.12},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-accent"}),e.jsx("h3",{className:"font-bold",children:"Chord Taste DNA"}),(v==null?void 0:v.totalTracksAnalyzed)&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",v.totalTracksAnalyzed," tracks analyzed)"]})]}),oe&&e.jsxs("div",{className:"p-8 glass rounded-2xl text-center",children:[e.jsx(Q,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Analyzing your musical taste..."})]}),!oe&&!v&&e.jsxs("div",{className:"p-8 glass rounded-2xl text-center",children:[e.jsx(G,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start listening to tracks to build your taste profile"})]}),!oe&&v&&e.jsxs(e.Fragment,{children:[v.favoriteProgressions.length>0?e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Favorite Progressions"}),v.favoriteProgressions.map((t,u)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-1",children:t.progression.map((_,z)=>e.jsx(ms,{chord:_,size:"sm"},z))}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[t.count," ",t.count===1?"song":"songs"]})]},u))]}):e.jsx("div",{className:"p-4 glass rounded-2xl text-center text-sm text-muted-foreground",children:"No chord progressions detected yet"}),v.preferredModes.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Mode Preference"}),e.jsx("div",{className:"flex gap-2",children:v.preferredModes.map(t=>e.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-muted/50 text-center",children:[e.jsxs("span",{className:"text-lg font-bold",children:[t.percentage,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:t.mode}),e.jsxs("p",{className:"text-xs text-muted-foreground/60",children:[t.count," tracks"]})]},t.mode))})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Energy Preference"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Low"}),e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-accent rounded-full transition-all",style:{width:`${v.energyPreference*100}%`}})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"High"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:[Math.round(v.energyPreference*100),"% energy â€¢ ",v.averageTempo," BPM avg"]})]}),v.cadencePreference&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Cadence Style"}),e.jsx("span",{className:"inline-block px-3 py-1 rounded-full bg-primary/10 text-primary text-sm capitalize",children:v.cadencePreference})]})]})]}),e.jsxs(S.div,{variants:L,initial:"initial",animate:"animate",transition:{delay:.15},className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Ms,{className:"w-5 h-5"}),"Connected Services"]}),(()=>{const t=k.find(z=>z.provider==="spotify"),u=ge.isPending,_=ye.isPending;return e.jsxs("div",{className:"w-full p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#1DB954]/20 flex items-center justify-center",children:e.jsx(Te,{className:"w-5 h-5 text-[#1DB954]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"Spotify"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t?`Connected ${Re(new Date(t.connected_at))} ago`:"Sync your listening history"})]})]}),t?e.jsx(A,{variant:"outline",size:"sm",onClick:es,disabled:_,className:"text-destructive hover:text-destructive",children:_?e.jsx(Q,{className:"w-4 h-4 animate-spin"}):"Disconnect"}):e.jsx(A,{size:"sm",onClick:Je,disabled:u,className:"bg-[#1DB954] hover:bg-[#1ed760] text-white gap-2",children:u?e.jsx(Q,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"w-4 h-4"}),"Connect"]})})]}),t&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[#1DB954]",children:[e.jsx(xe,{className:"w-3 h-3"}),e.jsx("span",{children:"Syncing your recently played tracks"})]})]})})(),e.jsx("button",{className:"w-full p-4 glass rounded-2xl flex items-center justify-between hover:bg-muted/30 transition-colors",onClick:()=>{},children:(()=>{const t=k.find(u=>u.provider==="youtube");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#FF0000]/20 flex items-center justify-center",children:e.jsx(G,{className:"w-5 h-5 text-[#FF0000]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"YouTube Music"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t?`Connected ${Re(new Date(t.connected_at))} ago`:"Coming soon"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsx(xe,{className:"w-4 h-4 text-[#FF0000]"}),e.jsx(Ie,{className:"w-5 h-5 text-muted-foreground"})]})]})})()}),e.jsxs("div",{className:"w-full p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#D51007]/20 flex items-center justify-center",children:e.jsx(Ee,{className:"w-5 h-5 text-[#D51007]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"Last.fm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:ee?e.jsxs(e.Fragment,{children:["@",je," â€¢ ",I==null?void 0:I.totalScrobbles.toLocaleString()," scrobbles"]}):"Connect to see your listening history"})]})]}),ee?e.jsx(A,{variant:"outline",size:"sm",onClick:ss,disabled:le.isPending,className:"text-destructive hover:text-destructive",children:le.isPending?e.jsx(Q,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-4 h-4 mr-1"}),"Disconnect"]})}):e.jsxs(Ue,{open:b,onOpenChange:w,children:[e.jsx(Cs,{asChild:!0,children:e.jsx(A,{size:"sm",className:"bg-[#D51007] hover:bg-[#D51007]/90",children:"Connect"})}),e.jsxs(Be,{children:[e.jsx(Ke,{children:e.jsx(Oe,{children:"Connect Last.fm"})}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your Last.fm username to sync your listening history and scrobbles."}),e.jsx(he,{placeholder:"Your Last.fm username",value:y,onChange:t=>D(t.target.value),onKeyDown:t=>t.key==="Enter"&&we()}),e.jsxs(A,{onClick:we,disabled:J.isPending,className:"w-full bg-[#D51007] hover:bg-[#D51007]/90",children:[J.isPending?e.jsx(Q,{className:"w-4 h-4 animate-spin mr-2"}):null,J.isPending?"Connecting...":"Connect Last.fm"]})]})]})]})]}),ee&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[#D51007]",children:[e.jsx(xe,{className:"w-3 h-3"}),e.jsx("span",{children:"Syncing your scrobble history"})]})]}),k.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Preferred Provider"}),e.jsx("button",{onClick:()=>c(!p),className:"text-xs text-primary hover:underline",children:"Change"})]}),p?e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>_e("none"),className:`w-full p-2 rounded-lg text-left text-sm transition-colors ${!(x!=null&&x.preferred_provider)||x.preferred_provider==="none"?"bg-primary/20 text-primary":"hover:bg-muted/30"}`,children:"No preference"}),k.map(t=>e.jsxs("button",{onClick:()=>_e(t.provider),className:`w-full p-2 rounded-lg flex items-center gap-2 text-sm transition-colors ${(x==null?void 0:x.preferred_provider)===t.provider?"bg-primary/20 text-primary":"hover:bg-muted/30"}`,children:[e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center text-xs",style:{backgroundColor:`${U[t.provider].color}20`},children:e.jsx("span",{children:U[t.provider].icon})}),U[t.provider].name]},t.id))]}):e.jsx("div",{className:"flex items-center gap-2",children:x!=null&&x.preferred_provider&&x.preferred_provider!=="none"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:`${U[x.preferred_provider].color}20`},children:e.jsx("span",{children:U[x.preferred_provider].icon})}),e.jsx("span",{className:"text-sm font-medium",children:U[x.preferred_provider].name})]}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"No preference set"})})]})]}),ce&&e.jsxs(S.div,{variants:L,initial:"initial",animate:"animate",transition:{delay:.17},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Is,{className:"w-5 h-5"}),"Your Music"]}),e.jsxs("select",{value:P,onChange:t=>R(t.target.value),className:"text-xs bg-muted/50 border-none rounded-lg px-2 py-1",children:[e.jsx("option",{value:"short_term",children:"Last 4 weeks"}),e.jsx("option",{value:"medium_term",children:"Last 6 months"}),e.jsx("option",{value:"long_term",children:"All time"})]})]}),e.jsxs(He,{defaultValue:be,value:be,className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-3",children:[e.jsx(B,{value:"tracks",disabled:!i.length,children:"Top Tracks"}),e.jsx(B,{value:"artists",disabled:!f.length,children:"Top Artists"}),e.jsx(B,{value:"recent",disabled:!((Fe=j==null?void 0:j.tracks)!=null&&Fe.length),children:"Recent"})]}),i.length>0&&e.jsx(E,{value:"tracks",className:"mt-4",children:e.jsx(me,{cols:{sm:1,md:2,lg:3},gap:"sm",children:i.map((t,u)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",onClick:()=>de(t),children:[e.jsx("span",{className:"w-6 text-center text-muted-foreground text-sm",children:u+1}),e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden bg-muted",children:t.cover_url?e.jsx("img",{src:t.cover_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(G,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:t.artist})]})]},t.id))})}),f.length>0&&e.jsx(E,{value:"artists",className:"mt-4",children:e.jsx(me,{cols:{sm:1,md:2,lg:3},gap:"sm",children:f.map((t,u)=>{var _,z,Ae;return e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",children:[e.jsx("span",{className:"w-6 text-center text-muted-foreground text-sm",children:u+1}),e.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-muted",children:(z=(_=t.images)==null?void 0:_[0])!=null&&z.url?e.jsx("img",{src:t.images[0].url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ue,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:(Ae=t.genres)==null?void 0:Ae.slice(0,2).join(", ")})]})]},t.id)})})}),(Le=j==null?void 0:j.tracks)!=null&&Le.length?e.jsx(E,{value:"recent",className:"mt-4",children:e.jsx(me,{cols:{sm:1,md:2,lg:3},gap:"sm",children:j.tracks.filter(t=>t.spotifyId||t.spotify_id||t.youtubeId||t.youtube_id).map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/30 transition-colors cursor-pointer group",onClick:()=>de(t),children:[e.jsx("div",{className:"w-12 h-12 rounded-xl overflow-hidden bg-muted",children:t.cover_url?e.jsx("img",{src:t.cover_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(G,{className:"w-5 h-5 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:t.artist}),t.played_at&&e.jsx("p",{className:"text-[11px] text-muted-foreground/80",children:ze(t.played_at)})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:u=>{u.stopPropagation(),de(t)},className:"h-8 w-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center hover:bg-primary/90","aria-label":"Play",children:e.jsx(ds,{className:"w-4 h-4"})}),e.jsx(us,{track:{spotifyId:t.spotifyId||t.spotify_id,youtubeId:t.youtubeId||t.youtube_id},canonicalTrackId:t.id,trackTitle:t.title,trackArtist:t.artist,size:"sm"})]})]},t.id))})}):e.jsx(E,{value:"recent",className:"mt-4",children:e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No recent plays. Start listening now!"})})]})]}),ce&&fe.length>0&&e.jsxs(S.div,{variants:L,initial:"initial",animate:"animate",transition:{delay:.19},className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-accent"}),"Recommended For You"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3",children:fe.slice(0,10).map(t=>e.jsxs("div",{className:"p-2 glass rounded-xl hover:bg-muted/30 transition-colors group cursor-pointer",children:[e.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-muted mb-2",children:t.cover_url?e.jsx("img",{src:t.cover_url,alt:"",className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Es,{className:"w-8 h-8 text-muted-foreground"})})}),e.jsx("p",{className:"font-medium text-xs truncate",children:t.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:t.artist})]},t.id))})]}),ee&&I&&e.jsxs(S.div,{variants:L,initial:"initial",animate:"animate",transition:{delay:.21},className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-[#D51007]"}),"Last.fm Stats"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:I.totalScrobbles.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Scrobbles"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:I.weeklyArtistCount}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Artists This Week"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:I.topArtists.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Top Artists"})]})]}),I.topArtists.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Top Artists (3 months)"}),e.jsx("div",{className:"space-y-2",children:I.topArtists.slice(0,5).map((t,u)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 text-muted-foreground text-sm",children:u+1}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-muted",children:t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ue,{className:"w-3 h-3 text-muted-foreground"})})}),e.jsx("span",{className:"flex-1 text-sm truncate",children:t.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[t.playcount," plays"]})]},t.name))})]})]}),F.length>0&&e.jsxs(S.div,{variants:L,initial:"initial",animate:"animate",transition:{delay:.2},className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Rs,{className:"w-5 h-5"}),"Play History"]}),l&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[l.totalPlays," total plays"]})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[e.jsx("button",{onClick:()=>d("all"),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors ${o==="all"?"bg-primary text-primary-foreground":"bg-muted/50 text-muted-foreground hover:bg-muted"}`,children:"All"}),Object.entries(U).map(([t,u])=>k.some(z=>z.provider===t)?e.jsxs("button",{onClick:()=>d(t),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap flex items-center gap-1 transition-colors ${o===t?"text-white":"bg-muted/50 text-muted-foreground hover:bg-muted"}`,style:o===t?{backgroundColor:u.color}:{},children:[e.jsx("span",{children:u.icon}),u.name]},t):null)]}),e.jsx("div",{className:"space-y-2",children:F.map(t=>{var _;if(!t.track_id)return null;const u=t.track_id.includes("seed-")?"Sample Track":((_=t.track_id.split(":").pop())==null?void 0:_.slice(0,12))||"Unknown Track";return e.jsxs(S.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-3 glass rounded-xl flex gap-3 hover:bg-muted/30 transition-colors cursor-pointer",onClick:()=>bs(n,t.track_id),children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-muted/50 flex-shrink-0",children:e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(G,{className:"w-6 h-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:u}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(xt,{provider:t.provider,size:"sm"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:ze(t.played_at)})]})]}),e.jsx(Ie,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"})]},t.id)})})]}),e.jsxs(S.div,{variants:L,initial:"initial",animate:"animate",transition:{delay:.25},className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"p-4 glass rounded-2xl flex flex-col items-center gap-2 hover:bg-muted/30 transition-colors",children:[e.jsx(zs,{className:"w-6 h-6 text-accent"}),e.jsx("span",{className:"text-sm font-medium",children:"Liked"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Ge," songs"]})]}),e.jsxs("button",{className:"p-4 glass rounded-2xl flex flex-col items-center gap-2 hover:bg-muted/30 transition-colors",children:[e.jsx($s,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Saved"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Ze," songs"]})]})]}),ve&&e.jsx(S.div,{variants:L,initial:"initial",animate:"animate",transition:{delay:.3},className:"mt-6",children:e.jsxs(A,{variant:"outline",className:"w-full justify-center gap-2",onClick:()=>n("/admin"),children:[e.jsx(qe,{className:"w-4 h-4"}),"Admin Dashboard"]})})]}),e.jsx(wt,{open:K,onOpenChange:O,currentTheme:Ye,userId:(s==null?void 0:s.id)||""})]}):e.jsx(De,{title:"Profile",children:e.jsx(xs,{icon:ue,title:"Sign in to see your profile",description:"Track your harmonic taste DNA and saved songs",actionLabel:"Sign in",onAction:()=>n("/auth")})})}export{ga as default};
