import{c as Z,t as It,v as ke,w as Te,r as a,j as t,A as kt,ai as se,x as Q,z as w,F as Tt,G as At,y as z,I as Ae,H as Ot,aj as Oe,ak as Ft,R as Lt,K as Gt,M as Kt,J as $t,i as b,a as Ut,u as Bt,s as I,B as k,m as fe}from"./index-74tJdIi1.js";import{T as Se}from"./textarea-DsOICp8D.js";import{A as zt}from"./avatar-CLHHsXTy.js";import{B as Vt}from"./badge-HWc3E2pF.js";import{u as Ht}from"./index-DNHIvv9p.js";import{h as qt,u as Xt,F as Yt,R as Wt}from"./Combination-BTvJzeG1.js";import{c as Fe,R as Jt,I as Zt}from"./index-DpZG6a_9.js";import{u as Ee}from"./index-BlN0hpi4.js";import{C as Qt}from"./chevron-right-CpX3-W9j.js";import{C as en}from"./check-Bry45M5E.js";import{M as he}from"./search-CkA48mVj.js";import{S as tn}from"./send-CF-qH3vY.js";import{S as nn}from"./sparkles-CJFnw2Ka.js";import{A as De}from"./index-GGwqyY1u.js";import{f as rn}from"./formatDistanceToNow-3UBXKcFR.js";import{H as on}from"./heart-DtkJQQu7.js";import{T as an}from"./trash-2-ulMrMSSf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=Z("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=Z("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=Z("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=Z("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=Z("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var xe=["Enter"," "],un=["ArrowDown","PageUp","Home"],Le=["ArrowUp","PageDown","End"],pn=[...un,...Le],mn={ltr:[...xe,"ArrowRight"],rtl:[...xe,"ArrowLeft"]},fn={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ee="Menu",[W,hn,xn]=It(ee),[G,Ge]=ke(ee,[xn,Te,Fe]),ie=Te(),Ke=Fe(),[gn,K]=G(ee),[vn,te]=G(ee),$e=e=>{const{__scopeMenu:r,open:n=!1,children:o,dir:s,onOpenChange:i,modal:u=!0}=e,p=ie(r),[h,x]=a.useState(null),m=a.useRef(!1),c=Ae(i),f=Ht(s);return a.useEffect(()=>{const M=()=>{m.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>m.current=!1;return document.addEventListener("keydown",M,{capture:!0}),()=>{document.removeEventListener("keydown",M,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),t.jsx(Lt,{...p,children:t.jsx(gn,{scope:r,open:n,onOpenChange:c,content:h,onContentChange:x,children:t.jsx(vn,{scope:r,onClose:a.useCallback(()=>c(!1),[c]),isUsingKeyboardRef:m,dir:f,modal:u,children:o})})})};$e.displayName=ee;var wn="MenuAnchor",ve=a.forwardRef((e,r)=>{const{__scopeMenu:n,...o}=e,s=ie(n);return t.jsx(kt,{...s,...o,ref:r})});ve.displayName=wn;var we="MenuPortal",[Mn,Ue]=G(we,{forceMount:void 0}),Be=e=>{const{__scopeMenu:r,forceMount:n,children:o,container:s}=e,i=K(we,r);return t.jsx(Mn,{scope:r,forceMount:n,children:t.jsx(se,{present:n||i.open,children:t.jsx(Gt,{asChild:!0,container:s,children:o})})})};Be.displayName=we;var N="MenuContent",[yn,Me]=G(N),ze=a.forwardRef((e,r)=>{const n=Ue(N,e.__scopeMenu),{forceMount:o=n.forceMount,...s}=e,i=K(N,e.__scopeMenu),u=te(N,e.__scopeMenu);return t.jsx(W.Provider,{scope:e.__scopeMenu,children:t.jsx(se,{present:o||i.open,children:t.jsx(W.Slot,{scope:e.__scopeMenu,children:u.modal?t.jsx(_n,{...s,ref:r}):t.jsx(Cn,{...s,ref:r})})})})}),_n=a.forwardRef((e,r)=>{const n=K(N,e.__scopeMenu),o=a.useRef(null),s=Q(r,o);return a.useEffect(()=>{const i=o.current;if(i)return qt(i)},[]),t.jsx(ye,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:w(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Cn=a.forwardRef((e,r)=>{const n=K(N,e.__scopeMenu);return t.jsx(ye,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),bn=Kt("MenuContent.ScrollLock"),ye=a.forwardRef((e,r)=>{const{__scopeMenu:n,loop:o=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:u,disableOutsidePointerEvents:p,onEntryFocus:h,onEscapeKeyDown:x,onPointerDownOutside:m,onFocusOutside:c,onInteractOutside:f,onDismiss:M,disableOutsideScroll:g,...j}=e,T=K(N,n),E=te(N,n),A=ie(n),D=Ke(n),V=hn(n),[le,L]=a.useState(null),$=a.useRef(null),R=Q(r,$,T.onContentChange),O=a.useRef(0),U=a.useRef(""),ue=a.useRef(0),H=a.useRef(null),ne=a.useRef("right"),q=a.useRef(0),re=g?Wt:a.Fragment,d=g?{as:bn,allowPinchZoom:!0}:void 0,v=l=>{var B,je;const _=U.current+l,S=V().filter(P=>!P.disabled),F=document.activeElement,pe=(B=S.find(P=>P.ref.current===F))==null?void 0:B.textValue,me=S.map(P=>P.textValue),Ne=On(me,_,pe),X=(je=S.find(P=>P.textValue===Ne))==null?void 0:je.ref.current;(function P(Re){U.current=Re,window.clearTimeout(O.current),Re!==""&&(O.current=window.setTimeout(()=>P(""),1e3))})(_),X&&setTimeout(()=>X.focus())};a.useEffect(()=>()=>window.clearTimeout(O.current),[]),Xt();const y=a.useCallback(l=>{var S,F;return ne.current===((S=H.current)==null?void 0:S.side)&&Ln(l,(F=H.current)==null?void 0:F.area)},[]);return t.jsx(yn,{scope:n,searchRef:U,onItemEnter:a.useCallback(l=>{y(l)&&l.preventDefault()},[y]),onItemLeave:a.useCallback(l=>{var _;y(l)||((_=$.current)==null||_.focus(),L(null))},[y]),onTriggerLeave:a.useCallback(l=>{y(l)&&l.preventDefault()},[y]),pointerGraceTimerRef:ue,onPointerGraceIntentChange:a.useCallback(l=>{H.current=l},[]),children:t.jsx(re,{...d,children:t.jsx(Yt,{asChild:!0,trapped:s,onMountAutoFocus:w(i,l=>{var _;l.preventDefault(),(_=$.current)==null||_.focus({preventScroll:!0})}),onUnmountAutoFocus:u,children:t.jsx(Tt,{asChild:!0,disableOutsidePointerEvents:p,onEscapeKeyDown:x,onPointerDownOutside:m,onFocusOutside:c,onInteractOutside:f,onDismiss:M,children:t.jsx(Jt,{asChild:!0,...D,dir:E.dir,orientation:"vertical",loop:o,currentTabStopId:le,onCurrentTabStopIdChange:L,onEntryFocus:w(h,l=>{E.isUsingKeyboardRef.current||l.preventDefault()}),preventScrollOnEntryFocus:!0,children:t.jsx(At,{role:"menu","aria-orientation":"vertical","data-state":st(T.open),"data-radix-menu-content":"",dir:E.dir,...A,...j,ref:R,style:{outline:"none",...j.style},onKeyDown:w(j.onKeyDown,l=>{const S=l.target.closest("[data-radix-menu-content]")===l.currentTarget,F=l.ctrlKey||l.altKey||l.metaKey,pe=l.key.length===1;S&&(l.key==="Tab"&&l.preventDefault(),!F&&pe&&v(l.key));const me=$.current;if(l.target!==me||!pn.includes(l.key))return;l.preventDefault();const X=V().filter(B=>!B.disabled).map(B=>B.ref.current);Le.includes(l.key)&&X.reverse(),Tn(X)}),onBlur:w(e.onBlur,l=>{l.currentTarget.contains(l.target)||(window.clearTimeout(O.current),U.current="")}),onPointerMove:w(e.onPointerMove,J(l=>{const _=l.target,S=q.current!==l.clientX;if(l.currentTarget.contains(_)&&S){const F=l.clientX>q.current?"right":"left";ne.current=F,q.current=l.clientX}}))})})})})})})});ze.displayName=N;var Nn="MenuGroup",_e=a.forwardRef((e,r)=>{const{__scopeMenu:n,...o}=e;return t.jsx(z.div,{role:"group",...o,ref:r})});_e.displayName=Nn;var jn="MenuLabel",Ve=a.forwardRef((e,r)=>{const{__scopeMenu:n,...o}=e;return t.jsx(z.div,{...o,ref:r})});Ve.displayName=jn;var oe="MenuItem",Ie="menu.itemSelect",ce=a.forwardRef((e,r)=>{const{disabled:n=!1,onSelect:o,...s}=e,i=a.useRef(null),u=te(oe,e.__scopeMenu),p=Me(oe,e.__scopeMenu),h=Q(r,i),x=a.useRef(!1),m=()=>{const c=i.current;if(!n&&c){const f=new CustomEvent(Ie,{bubbles:!0,cancelable:!0});c.addEventListener(Ie,M=>o==null?void 0:o(M),{once:!0}),Ft(c,f),f.defaultPrevented?x.current=!1:u.onClose()}};return t.jsx(He,{...s,ref:h,disabled:n,onClick:w(e.onClick,m),onPointerDown:c=>{var f;(f=e.onPointerDown)==null||f.call(e,c),x.current=!0},onPointerUp:w(e.onPointerUp,c=>{var f;x.current||(f=c.currentTarget)==null||f.click()}),onKeyDown:w(e.onKeyDown,c=>{const f=p.searchRef.current!=="";n||f&&c.key===" "||xe.includes(c.key)&&(c.currentTarget.click(),c.preventDefault())})})});ce.displayName=oe;var He=a.forwardRef((e,r)=>{const{__scopeMenu:n,disabled:o=!1,textValue:s,...i}=e,u=Me(oe,n),p=Ke(n),h=a.useRef(null),x=Q(r,h),[m,c]=a.useState(!1),[f,M]=a.useState("");return a.useEffect(()=>{const g=h.current;g&&M((g.textContent??"").trim())},[i.children]),t.jsx(W.ItemSlot,{scope:n,disabled:o,textValue:s??f,children:t.jsx(Zt,{asChild:!0,...p,focusable:!o,children:t.jsx(z.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":o||void 0,"data-disabled":o?"":void 0,...i,ref:x,onPointerMove:w(e.onPointerMove,J(g=>{o?u.onItemLeave(g):(u.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:w(e.onPointerLeave,J(g=>u.onItemLeave(g))),onFocus:w(e.onFocus,()=>c(!0)),onBlur:w(e.onBlur,()=>c(!1))})})})}),Rn="MenuCheckboxItem",qe=a.forwardRef((e,r)=>{const{checked:n=!1,onCheckedChange:o,...s}=e;return t.jsx(Ze,{scope:e.__scopeMenu,checked:n,children:t.jsx(ce,{role:"menuitemcheckbox","aria-checked":ae(n)?"mixed":n,...s,ref:r,"data-state":be(n),onSelect:w(s.onSelect,()=>o==null?void 0:o(ae(n)?!0:!n),{checkForDefaultPrevented:!1})})})});qe.displayName=Rn;var Xe="MenuRadioGroup",[Sn,En]=G(Xe,{value:void 0,onValueChange:()=>{}}),Ye=a.forwardRef((e,r)=>{const{value:n,onValueChange:o,...s}=e,i=Ae(o);return t.jsx(Sn,{scope:e.__scopeMenu,value:n,onValueChange:i,children:t.jsx(_e,{...s,ref:r})})});Ye.displayName=Xe;var We="MenuRadioItem",Je=a.forwardRef((e,r)=>{const{value:n,...o}=e,s=En(We,e.__scopeMenu),i=n===s.value;return t.jsx(Ze,{scope:e.__scopeMenu,checked:i,children:t.jsx(ce,{role:"menuitemradio","aria-checked":i,...o,ref:r,"data-state":be(i),onSelect:w(o.onSelect,()=>{var u;return(u=s.onValueChange)==null?void 0:u.call(s,n)},{checkForDefaultPrevented:!1})})})});Je.displayName=We;var Ce="MenuItemIndicator",[Ze,Dn]=G(Ce,{checked:!1}),Qe=a.forwardRef((e,r)=>{const{__scopeMenu:n,forceMount:o,...s}=e,i=Dn(Ce,n);return t.jsx(se,{present:o||ae(i.checked)||i.checked===!0,children:t.jsx(z.span,{...s,ref:r,"data-state":be(i.checked)})})});Qe.displayName=Ce;var Pn="MenuSeparator",et=a.forwardRef((e,r)=>{const{__scopeMenu:n,...o}=e;return t.jsx(z.div,{role:"separator","aria-orientation":"horizontal",...o,ref:r})});et.displayName=Pn;var In="MenuArrow",tt=a.forwardRef((e,r)=>{const{__scopeMenu:n,...o}=e,s=ie(n);return t.jsx(Ot,{...s,...o,ref:r})});tt.displayName=In;var kn="MenuSub",[Vr,nt]=G(kn),Y="MenuSubTrigger",rt=a.forwardRef((e,r)=>{const n=K(Y,e.__scopeMenu),o=te(Y,e.__scopeMenu),s=nt(Y,e.__scopeMenu),i=Me(Y,e.__scopeMenu),u=a.useRef(null),{pointerGraceTimerRef:p,onPointerGraceIntentChange:h}=i,x={__scopeMenu:e.__scopeMenu},m=a.useCallback(()=>{u.current&&window.clearTimeout(u.current),u.current=null},[]);return a.useEffect(()=>m,[m]),a.useEffect(()=>{const c=p.current;return()=>{window.clearTimeout(c),h(null)}},[p,h]),t.jsx(ve,{asChild:!0,...x,children:t.jsx(He,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":st(n.open),...e,ref:Oe(r,s.onTriggerChange),onClick:c=>{var f;(f=e.onClick)==null||f.call(e,c),!(e.disabled||c.defaultPrevented)&&(c.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:w(e.onPointerMove,J(c=>{i.onItemEnter(c),!c.defaultPrevented&&!e.disabled&&!n.open&&!u.current&&(i.onPointerGraceIntentChange(null),u.current=window.setTimeout(()=>{n.onOpenChange(!0),m()},100))})),onPointerLeave:w(e.onPointerLeave,J(c=>{var M,g;m();const f=(M=n.content)==null?void 0:M.getBoundingClientRect();if(f){const j=(g=n.content)==null?void 0:g.dataset.side,T=j==="right",E=T?-5:5,A=f[T?"left":"right"],D=f[T?"right":"left"];i.onPointerGraceIntentChange({area:[{x:c.clientX+E,y:c.clientY},{x:A,y:f.top},{x:D,y:f.top},{x:D,y:f.bottom},{x:A,y:f.bottom}],side:j}),window.clearTimeout(p.current),p.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(c),c.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:w(e.onKeyDown,c=>{var M;const f=i.searchRef.current!=="";e.disabled||f&&c.key===" "||mn[o.dir].includes(c.key)&&(n.onOpenChange(!0),(M=n.content)==null||M.focus(),c.preventDefault())})})})});rt.displayName=Y;var ot="MenuSubContent",at=a.forwardRef((e,r)=>{const n=Ue(N,e.__scopeMenu),{forceMount:o=n.forceMount,...s}=e,i=K(N,e.__scopeMenu),u=te(N,e.__scopeMenu),p=nt(ot,e.__scopeMenu),h=a.useRef(null),x=Q(r,h);return t.jsx(W.Provider,{scope:e.__scopeMenu,children:t.jsx(se,{present:o||i.open,children:t.jsx(W.Slot,{scope:e.__scopeMenu,children:t.jsx(ye,{id:p.contentId,"aria-labelledby":p.triggerId,...s,ref:x,align:"start",side:u.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{var c;u.isUsingKeyboardRef.current&&((c=h.current)==null||c.focus()),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:w(e.onFocusOutside,m=>{m.target!==p.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:w(e.onEscapeKeyDown,m=>{u.onClose(),m.preventDefault()}),onKeyDown:w(e.onKeyDown,m=>{var M;const c=m.currentTarget.contains(m.target),f=fn[u.dir].includes(m.key);c&&f&&(i.onOpenChange(!1),(M=p.trigger)==null||M.focus(),m.preventDefault())})})})})})});at.displayName=ot;function st(e){return e?"open":"closed"}function ae(e){return e==="indeterminate"}function be(e){return ae(e)?"indeterminate":e?"checked":"unchecked"}function Tn(e){const r=document.activeElement;for(const n of e)if(n===r||(n.focus(),document.activeElement!==r))return}function An(e,r){return e.map((n,o)=>e[(r+o)%e.length])}function On(e,r,n){const s=r.length>1&&Array.from(r).every(x=>x===r[0])?r[0]:r,i=n?e.indexOf(n):-1;let u=An(e,Math.max(i,0));s.length===1&&(u=u.filter(x=>x!==n));const h=u.find(x=>x.toLowerCase().startsWith(s.toLowerCase()));return h!==n?h:void 0}function Fn(e,r){const{x:n,y:o}=e;let s=!1;for(let i=0,u=r.length-1;i<r.length;u=i++){const p=r[i],h=r[u],x=p.x,m=p.y,c=h.x,f=h.y;m>o!=f>o&&n<(c-x)*(o-m)/(f-m)+x&&(s=!s)}return s}function Ln(e,r){if(!r)return!1;const n={x:e.clientX,y:e.clientY};return Fn(n,r)}function J(e){return r=>r.pointerType==="mouse"?e(r):void 0}var Gn=$e,Kn=ve,$n=Be,Un=ze,Bn=_e,zn=Ve,Vn=ce,Hn=qe,qn=Ye,Xn=Je,Yn=Qe,Wn=et,Jn=tt,Zn=rt,Qn=at,de="DropdownMenu",[er,Hr]=ke(de,[Ge]),C=Ge(),[tr,it]=er(de),ct=e=>{const{__scopeDropdownMenu:r,children:n,dir:o,open:s,defaultOpen:i,onOpenChange:u,modal:p=!0}=e,h=C(r),x=a.useRef(null),[m,c]=$t({prop:s,defaultProp:i??!1,onChange:u,caller:de});return t.jsx(tr,{scope:r,triggerId:Ee(),triggerRef:x,contentId:Ee(),open:m,onOpenChange:c,onOpenToggle:a.useCallback(()=>c(f=>!f),[c]),modal:p,children:t.jsx(Gn,{...h,open:m,onOpenChange:c,dir:o,modal:p,children:n})})};ct.displayName=de;var dt="DropdownMenuTrigger",lt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,disabled:o=!1,...s}=e,i=it(dt,n),u=C(n);return t.jsx(Kn,{asChild:!0,...u,children:t.jsx(z.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":o?"":void 0,disabled:o,...s,ref:Oe(r,i.triggerRef),onPointerDown:w(e.onPointerDown,p=>{!o&&p.button===0&&p.ctrlKey===!1&&(i.onOpenToggle(),i.open||p.preventDefault())}),onKeyDown:w(e.onKeyDown,p=>{o||(["Enter"," "].includes(p.key)&&i.onOpenToggle(),p.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(p.key)&&p.preventDefault())})})})});lt.displayName=dt;var nr="DropdownMenuPortal",ut=e=>{const{__scopeDropdownMenu:r,...n}=e,o=C(r);return t.jsx($n,{...o,...n})};ut.displayName=nr;var pt="DropdownMenuContent",mt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=it(pt,n),i=C(n),u=a.useRef(!1);return t.jsx(Un,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...o,ref:r,onCloseAutoFocus:w(e.onCloseAutoFocus,p=>{var h;u.current||(h=s.triggerRef.current)==null||h.focus(),u.current=!1,p.preventDefault()}),onInteractOutside:w(e.onInteractOutside,p=>{const h=p.detail.originalEvent,x=h.button===0&&h.ctrlKey===!0,m=h.button===2||x;(!s.modal||m)&&(u.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mt.displayName=pt;var rr="DropdownMenuGroup",or=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(Bn,{...s,...o,ref:r})});or.displayName=rr;var ar="DropdownMenuLabel",ft=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(zn,{...s,...o,ref:r})});ft.displayName=ar;var sr="DropdownMenuItem",ht=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(Vn,{...s,...o,ref:r})});ht.displayName=sr;var ir="DropdownMenuCheckboxItem",xt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(Hn,{...s,...o,ref:r})});xt.displayName=ir;var cr="DropdownMenuRadioGroup",dr=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(qn,{...s,...o,ref:r})});dr.displayName=cr;var lr="DropdownMenuRadioItem",gt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(Xn,{...s,...o,ref:r})});gt.displayName=lr;var ur="DropdownMenuItemIndicator",vt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(Yn,{...s,...o,ref:r})});vt.displayName=ur;var pr="DropdownMenuSeparator",wt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(Wn,{...s,...o,ref:r})});wt.displayName=pr;var mr="DropdownMenuArrow",fr=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(Jn,{...s,...o,ref:r})});fr.displayName=mr;var hr="DropdownMenuSubTrigger",Mt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(Zn,{...s,...o,ref:r})});Mt.displayName=hr;var xr="DropdownMenuSubContent",yt=a.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...o}=e,s=C(n);return t.jsx(Qn,{...s,...o,ref:r,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});yt.displayName=xr;var gr=ct,vr=lt,wr=ut,_t=mt,Ct=ft,bt=ht,Nt=xt,jt=gt,Rt=vt,St=wt,Et=Mt,Dt=yt;const Mr=gr,yr=vr,_r=a.forwardRef(({className:e,inset:r,children:n,...o},s)=>t.jsxs(Et,{ref:s,className:b("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",r&&"pl-8",e),...o,children:[n,t.jsx(Qt,{className:"ml-auto h-4 w-4"})]}));_r.displayName=Et.displayName;const Cr=a.forwardRef(({className:e,...r},n)=>t.jsx(Dt,{ref:n,className:b("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));Cr.displayName=Dt.displayName;const Pt=a.forwardRef(({className:e,sideOffset:r=4,...n},o)=>t.jsx(wr,{children:t.jsx(_t,{ref:o,sideOffset:r,className:b("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Pt.displayName=_t.displayName;const ge=a.forwardRef(({className:e,inset:r,...n},o)=>t.jsx(bt,{ref:o,className:b("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",r&&"pl-8",e),...n}));ge.displayName=bt.displayName;const br=a.forwardRef(({className:e,children:r,checked:n,...o},s)=>t.jsxs(Nt,{ref:s,className:b("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:n,...o,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(Rt,{children:t.jsx(en,{className:"h-4 w-4"})})}),r]}));br.displayName=Nt.displayName;const Nr=a.forwardRef(({className:e,children:r,...n},o)=>t.jsxs(jt,{ref:o,className:b("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...n,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(Rt,{children:t.jsx(sn,{className:"h-2 w-2 fill-current"})})}),r]}));Nr.displayName=jt.displayName;const jr=a.forwardRef(({className:e,inset:r,...n},o)=>t.jsx(Ct,{ref:o,className:b("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",e),...n}));jr.displayName=Ct.displayName;const Rr=a.forwardRef(({className:e,...r},n)=>t.jsx(St,{ref:n,className:b("-mx-1 my-1 h-px bg-muted",e),...r}));Rr.displayName=St.displayName;function qr({trackId:e,className:r=""}){const{user:n,guestMode:o}=Ut(),s=Bt(),i=typeof window<"u"&&window.location.hostname.endsWith("github.io"),[u,p]=a.useState([]),[h,x]=a.useState(""),[m,c]=a.useState(!1),[f,M]=a.useState(!0),[g,j]=a.useState(null),[T,E]=a.useState(null),[A,D]=a.useState(""),[V,le]=a.useState({}),[L,$]=a.useState({});a.useEffect(()=>{if(i){M(!1);return}e&&(R(),U())},[e,i]);const R=async()=>{if(i){p([]),M(!1);return}M(!0);try{const{data:d,error:v}=await I.rpc("get_track_comments",{p_track_id:e,p_limit:50,p_offset:0});if(v)throw v;p(d||[])}catch(d){console.error("Error loading comments:",d)}finally{M(!1)}},O=async d=>{try{const{data:v,error:y}=await I.rpc("get_comment_replies",{p_comment_id:d});if(y)throw y;le(l=>({...l,[d]:v||[]})),$(l=>({...l,[d]:!0}))}catch(v){console.error("Error loading replies:",v)}},U=()=>{const d=I.channel(`track-comments:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"track_comments",filter:`track_id=eq.${e}`},()=>{R()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"track_comments",filter:`track_id=eq.${e}`},()=>{R()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"track_comments",filter:`track_id=eq.${e}`},()=>{R()}).subscribe();return()=>{I.removeChannel(d)}},ue=async d=>{if(d.preventDefault(),!(!h.trim()||!n||m)){c(!0);try{const{error:v}=await I.from("track_comments").insert({track_id:e,user_id:n.id,comment:h.trim(),reply_to:(g==null?void 0:g.id)||null});if(v)throw v;x(""),j(null),g?await O(g.id):await R()}catch(v){console.error("Error posting comment:",v)}finally{c(!1)}}},H=async(d,v)=>{if(n)try{v?await I.from("track_comment_likes").delete().eq("comment_id",d).eq("user_id",n.id):await I.from("track_comment_likes").insert({comment_id:d,user_id:n.id}),await R(),Object.keys(L).forEach(y=>{L[y]&&O(y)})}catch(y){console.error("Error toggling like:",y)}},ne=async d=>{if(A.trim())try{const{error:v}=await I.from("track_comments").update({comment:A.trim(),edited_at:new Date().toISOString()}).eq("id",d);if(v)throw v;E(null),D(""),await R()}catch(v){console.error("Error editing comment:",v)}},q=async d=>{if(confirm("Delete this comment?"))try{const{error:v}=await I.from("track_comments").delete().eq("id",d);if(v)throw v;await R()}catch(v){console.error("Error deleting comment:",v)}},re=(d,v=!1)=>{var y,l;return t.jsxs(fe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:b("space-y-2",v&&"ml-12"),children:[t.jsxs("div",{className:"flex gap-3",children:[t.jsx(zt,{className:"w-10 h-10 flex-shrink-0",children:d.user_avatar_url?t.jsx("img",{src:d.user_avatar_url,alt:""}):t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-sm font-semibold",children:((l=(y=d.user_display_name)==null?void 0:y[0])==null?void 0:l.toUpperCase())||"?"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:"font-medium text-sm",children:d.user_display_name||"Anonymous"}),t.jsx("span",{className:"text-xs text-muted-foreground",children:rn(new Date(d.created_at),{addSuffix:!0})}),d.edited_at&&t.jsx("span",{className:"text-xs text-muted-foreground",children:"(edited)"})]}),T===d.id?t.jsxs("div",{className:"space-y-2",children:[t.jsx(Se,{value:A,onChange:_=>D(_.target.value),className:"min-h-[60px]",maxLength:2e3}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(k,{size:"sm",onClick:()=>ne(d.id),children:"Save"}),t.jsx(k,{size:"sm",variant:"ghost",onClick:()=>{E(null),D("")},children:"Cancel"})]})]}):t.jsx("p",{className:"text-sm break-words whitespace-pre-wrap",children:d.comment}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsxs(k,{variant:"ghost",size:"sm",className:b("h-8 gap-1.5 text-xs",d.user_liked&&"text-red-500 hover:text-red-600"),onClick:()=>H(d.id,d.user_liked),children:[t.jsx(on,{className:b("w-4 h-4",d.user_liked&&"fill-current")}),d.likes_count>0&&d.likes_count]}),!v&&t.jsxs(k,{variant:"ghost",size:"sm",className:"h-8 gap-1.5 text-xs",onClick:()=>j(d),children:[t.jsx(Pe,{className:"w-4 h-4"}),"Reply"]}),(n==null?void 0:n.id)===d.user_id&&t.jsxs(Mr,{children:[t.jsx(yr,{asChild:!0,children:t.jsx(k,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:t.jsx(cn,{className:"w-4 h-4"})})}),t.jsxs(Pt,{align:"end",children:[t.jsxs(ge,{onClick:()=>{E(d.id),D(d.comment)},children:[t.jsx(dn,{className:"w-4 h-4 mr-2"}),"Edit"]}),t.jsxs(ge,{className:"text-red-600",onClick:()=>q(d.id),children:[t.jsx(an,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),!v&&!L[d.id]&&t.jsx(k,{variant:"ghost",size:"sm",className:"h-8 text-xs mt-2",onClick:()=>O(d.id),children:"View replies"})]})]}),t.jsx(De,{children:L[d.id]&&V[d.id]&&t.jsx(fe.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"space-y-3 mt-3",children:V[d.id].map(_=>re(_,!0))})})]},d.id)};return t.jsxs("div",{className:b("space-y-6",r),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(he,{className:"w-5 h-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"Comments"}),t.jsx(Vt,{variant:"secondary",children:u.length})]}),n?t.jsxs("form",{onSubmit:ue,className:"space-y-3",children:[g&&t.jsxs("div",{className:"p-3 bg-muted rounded-lg flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.jsx(Pe,{className:"w-3 h-3 inline mr-1"}),"Replying to ",g.user_display_name]}),t.jsx(k,{type:"button",variant:"ghost",size:"sm",onClick:()=>j(null),children:"Cancel"})]}),t.jsx(Se,{placeholder:"Share your thoughts about this track...",value:h,onChange:d=>x(d.target.value),className:"min-h-[100px] resize-none",maxLength:2e3}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-xs text-muted-foreground",children:[h.length,"/2000"]}),t.jsxs(k,{type:"submit",disabled:!h.trim()||m,children:[t.jsx(tn,{className:"w-4 h-4 mr-2"}),m?"Posting...":g?"Reply":"Post Comment"]})]})]}):t.jsxs(fe.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"relative overflow-hidden rounded-xl border-2 border-dashed border-border/50 bg-gradient-to-br from-background via-background to-muted/20 p-8 text-center",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#00F5FF]/5 via-[#FF00FF]/5 to-[#00F5FF]/5 animate-pulse"}),t.jsxs("div",{className:"relative z-10",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-[#00F5FF] to-[#FF00FF] mb-4",children:t.jsx(he,{className:"w-8 h-8 text-white"})}),t.jsxs("h4",{className:"text-lg font-semibold mb-2 flex items-center justify-center gap-2",children:["Join the Conversation",t.jsx(nn,{className:"w-4 h-4 text-[#FF00FF]"})]}),t.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-md mx-auto",children:"Sign up to share your thoughts, reply to others, and connect with music lovers who get it"}),t.jsxs(k,{size:"lg",onClick:()=>s("/auth"),className:"bg-gradient-to-r from-[#00F5FF] to-[#FF00FF] hover:opacity-90 transition-opacity shadow-lg shadow-[#00F5FF]/20",children:[t.jsx(ln,{className:"w-5 h-5 mr-2"}),"Sign Up to Comment"]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-4",children:["Already have an account?"," ",t.jsx("button",{onClick:()=>s("/auth"),className:"text-[#00F5FF] hover:underline font-medium",children:"Sign in"})]})]})]}),t.jsx("div",{className:"space-y-6",children:f?t.jsx("div",{className:"text-center py-8",children:t.jsx("div",{className:"inline-block w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"})}):u.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(he,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground opacity-50"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"No comments yet. Be the first to share your thoughts!"})]}):t.jsx(De,{children:u.map(d=>re(d))})})]})}export{Mr as D,cn as E,dn as P,qr as T,ln as U,yr as a,Pt as b,ge as c,Rr as d};
